var ba=Object.defineProperty;var va=(t,a,e)=>a in t?ba(t,a,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[a]=e;var J=(t,a,e)=>(va(t,typeof a!="symbol"?a+"":a,e),e);import{c as ct,p as ca}from"./vendor.979894d9.js";const ma=function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const f of s.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&r(f)}).observe(document,{childList:!0,subtree:!0});function e(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerpolicy&&(s.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?s.credentials="include":o.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(o){if(o.ep)return;o.ep=!0;const s=e(o);fetch(o.href,s)}};ma();function Ut(t){var a=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;t=t.replace(a,function(r,o,s,f){return o+o+s+s+f+f});var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null}function aa(t){var a=Ut(t).r,e=Ut(t).g,r=Ut(t).b,o=["244 67 54","255 235 238","255 205 210","239 154 154","229 115 115","239 83 80","229 57 53","211 47 47","198 40 40","183 28 28","255 138 128","255 82 82","255 23 68","213 0 0","233 30 99","252 228 236","248 187 208","244 143 177","240 98 146","236 64 122","216 27 96","194 24 91","173 20 87","136 14 79","255 128 171","255 64 129","245 0 87","197 17 98","156 39 176","243 229 245","225 190 231","206 147 216","186 104 200","171 71 188","142 36 170","123 31 162","106 27 154","74 20 140","234 128 252","224 64 251","213 0 249","170 0 255","103 58 183","237 231 246","209 196 233","179 157 219","149 117 205","126 87 194","94 53 177","81 45 168","69 39 160","49 27 146","179 136 255","124 77 255","101 31 255","98 0 234","63 81 181","232 234 246","197 202 233","159 168 218","121 134 203","92 107 192","57 73 171","48 63 159","40 53 147","26 35 126","140 158 255","83 109 254","61 90 254","48 79 254","33 150 243","227 242 253","187 222 251","144 202 249","100 181 246","66 165 245","30 136 229","25 118 210","21 101 192","13 71 161","130 177 255","68 138 255","41 121 255","41 98 255","3 169 244","225 245 254","179 229 252","129 212 250","79 195 247","41 182 246","3 155 229","2 136 209","2 119 189","1 87 155","128 216 255","64 196 255","0 176 255","0 145 234","0 188 212","224 247 250","178 235 242","128 222 234","77 208 225","38 198 218","0 172 193","0 151 167","0 131 143","0 96 100","132 255 255","24 255 255","0 229 255","0 184 212","0 150 136","224 242 241","178 223 219","128 203 196","77 182 172","38 166 154","0 137 123","0 121 107","0 105 92","0 77 64","167 255 235","100 255 218","29 233 182","0 191 165","76 175 80","232 245 233","200 230 201","165 214 167","129 199 132","102 187 106","67 160 71","56 142 60","46 125 50","27 94 32","185 246 202","105 240 174","0 230 118","0 200 83","139 195 74","241 248 233","220 237 200","197 225 165","174 213 129","156 204 101","124 179 66","104 159 56","85 139 47","51 105 30","204 255 144","178 255 89","118 255 3","100 221 23","205 220 57","249 251 231","240 244 195","230 238 156","220 231 117","212 225 87","192 202 51","175 180 43","158 157 36","130 119 23","244 255 129","238 255 65","198 255 0","174 234 0","255 235 59","255 253 231","255 249 196","255 245 157","255 241 118","255 238 88","253 216 53","251 192 45","249 168 37","245 127 23","255 255 141","255 255 0","255 234 0","255 214 0","255 193 7","255 248 225","255 236 179","255 224 130","255 213 79","255 202 40","255 179 0","255 160 0","255 143 0","255 111 0","255 229 127","255 215 64","255 196 0","255 171 0","255 152 0","255 243 224","255 224 178","255 204 128","255 183 77","255 167 38","251 140 0","245 124 0","239 108 0","230 81 0","255 209 128","255 171 64","255 145 0","255 109 0","255 87 34","251 233 231","255 204 188","255 171 145","255 138 101","255 112 67","244 81 30","230 74 25","216 67 21","191 54 12","255 158 128","255 110 64","255 61 0","221 44 0","121 85 72","239 235 233","215 204 200","188 170 164","161 136 127","141 110 99","109 76 65","93 64 55","78 52 46","62 39 35","158 158 158","250 250 250","245 245 245","238 238 238","224 224 224","189 189 189","117 117 117","97 97 97","66 66 66","33 33 33","96 125 139","236 239 241","207 216 220","176 190 197","144 164 174","120 144 156","84 110 122","69 90 100","55 71 79","38 50 56","0 0 0","255 255 255"],s=["#f44336","#ffebee","#ffcdd2","#ef9a9a","#e57373","#ef5350","#e53935","#d32f2f","#c62828","#b71c1c","#ff8a80","#ff5252","#ff1744","#d50000","#e91e63","#fce4ec","#f8bbd0","#f48fb1","#f06292","#ec407a","#d81b60","#c2185b","#ad1457","#880e4f","#ff80ab","#ff4081","#f50057","#c51162","#9c27b0","#f3e5f5","#e1bee7","#ce93d8","#ba68c8","#ab47bc","#8e24aa","#7b1fa2","#6a1b9a","#4a148c","#ea80fc","#e040fb","#d500f9","#aa00ff","#673ab7","#ede7f6","#d1c4e9","#b39ddb","#9575cd","#7e57c2","#5e35b1","#512da8","#4527a0","#311b92","#b388ff","#7c4dff","#651fff","#6200ea","#3f51b5","#e8eaf6","#c5cae9","#9fa8da","#7986cb","#5c6bc0","#3949ab","#303f9f","#283593","#1a237e","#8c9eff","#536dfe","#3d5afe","#304ffe","#2196f3","#e3f2fd","#bbdefb","#90caf9","#64b5f6","#42a5f5","#1e88e5","#1976d2","#1565c0","#0d47a1","#82b1ff","#448aff","#2979ff","#2962ff","#03a9f4","#e1f5fe","#b3e5fc","#81d4fa","#4fc3f7","#29b6f6","#039be5","#0288d1","#0277bd","#01579b","#80d8ff","#40c4ff","#00b0ff","#0091ea","#00bcd4","#e0f7fa","#b2ebf2","#80deea","#4dd0e1","#26c6da","#00acc1","#0097a7","#00838f","#006064","#84ffff","#18ffff","#00e5ff","#00b8d4","#009688","#e0f2f1","#b2dfdb","#80cbc4","#4db6ac","#26a69a","#00897b","#00796b","#00695c","#004d40","#a7ffeb","#64ffda","#1de9b6","#00bfa5","#4caf50","#e8f5e9","#c8e6c9","#a5d6a7","#81c784","#66bb6a","#43a047","#388e3c","#2e7d32","#1b5e20","#b9f6ca","#69f0ae","#00e676","#00c853","#8bc34a","#f1f8e9","#dcedc8","#c5e1a5","#aed581","#9ccc65","#7cb342","#689f38","#558b2f","#33691e","#ccff90","#b2ff59","#76ff03","#64dd17","#cddc39","#f9fbe7","#f0f4c3","#e6ee9c","#dce775","#d4e157","#c0ca33","#afb42b","#9e9d24","#827717","#f4ff81","#eeff41","#c6ff00","#aeea00","#ffeb3b","#fffde7","#fff9c4","#fff59d","#fff176","#ffee58","#fdd835","#fbc02d","#f9a825","#f57f17","#ffff8d","#ffff00","#ffea00","#ffd600","#ffc107","#fff8e1","#ffecb3","#ffe082","#ffd54f","#ffca28","#ffb300","#ffa000","#ff8f00","#ff6f00","#ffe57f","#ffd740","#ffc400","#ffab00","#ff9800","#fff3e0","#ffe0b2","#ffcc80","#ffb74d","#ffa726","#fb8c00","#f57c00","#ef6c00","#e65100","#ffd180","#ffab40","#ff9100","#ff6d00","#ff5722","#fbe9e7","#ffccbc","#ffab91","#ff8a65","#ff7043","#f4511e","#e64a19","#d84315","#bf360c","#ff9e80","#ff6e40","#ff3d00","#dd2c00","#795548","#efebe9","#d7ccc8","#bcaaa4","#a1887f","#8d6e63","#6d4c41","#5d4037","#4e342e","#3e2723","#9e9e9e","#fafafa","#f5f5f5","#eeeeee","#e0e0e0","#bdbdbd","#757575","#616161","#424242","#212121","#607d8b","#eceff1","#cfd8dc","#b0bec5","#90a4ae","#78909c","#546e7a","#455a64","#37474f","#263238","#000000","#ffffff"],f=["rgb(244,67,54)","rgb(255,235,238)","rgb(255,205,210)","rgb(239,154,154)","rgb(229,115,115)","rgb(239,83,80)","rgb(229,57,53)","rgb(211,47,47)","rgb(198,40,40)","rgb(183,28,28)","rgb(255,138,128)","rgb(255,82,82)","rgb(255,23,68)","rgb(213,0,0)","rgb(233,30,99)","rgb(252,228,236)","rgb(248,187,208)","rgb(244,143,177)","rgb(240,98,146)","rgb(236,64,122)","rgb(216,27,96)","rgb(194,24,91)","rgb(173,20,87)","rgb(136,14,79)","rgb(255,128,171)","rgb(255,64,129)","rgb(245,0,87)","rgb(197,17,98)","rgb(156,39,176)","rgb(243,229,245)","rgb(225,190,231)","rgb(206,147,216)","rgb(186,104,200)","rgb(171,71,188)","rgb(142,36,170)","rgb(123,31,162)","rgb(106,27,154)","rgb(74,20,140)","rgb(234,128,252)","rgb(224,64,251)","rgb(213,0,249)","rgb(170,0,255)","rgb(103,58,183)","rgb(237,231,246)","rgb(209,196,233)","rgb(179,157,219)","rgb(149,117,205)","rgb(126,87,194)","rgb(94,53,177)","rgb(81,45,168)","rgb(69,39,160)","rgb(49,27,146)","rgb(179,136,255)","rgb(124,77,255)","rgb(101,31,255)","rgb(98,0,234)","rgb(63,81,181)","rgb(232,234,246)","rgb(197,202,233)","rgb(159,168,218)","rgb(121,134,203)","rgb(92,107,192)","rgb(57,73,171)","rgb(48,63,159)","rgb(40,53,147)","rgb(26,35,126)","rgb(140,158,255)","rgb(83,109,254)","rgb(61,90,254)","rgb(48,79,254)","rgb(33,150,243)","rgb(227,242,253)","rgb(187,222,251)","rgb(144,202,249)","rgb(100,181,246)","rgb(66,165,245)","rgb(30,136,229)","rgb(25,118,210)","rgb(21,101,192)","rgb(13,71,161)","rgb(130,177,255)","rgb(68,138,255)","rgb(41,121,255)","rgb(41,98,255)","rgb(3,169,244)","rgb(225,245,254)","rgb(179,229,252)","rgb(129,212,250)","rgb(79,195,247)","rgb(41,182,246)","rgb(3,155,229)","rgb(2,136,209)","rgb(2,119,189)","rgb(1,87,155)","rgb(128,216,255)","rgb(64,196,255)","rgb(0,176,255)","rgb(0,145,234)","rgb(0,188,212)","rgb(224,247,250)","rgb(178,235,242)","rgb(128,222,234)","rgb(77,208,225)","rgb(38,198,218)","rgb(0,172,193)","rgb(0,151,167)","rgb(0,131,143)","rgb(0,96,100)","rgb(132,255,255)","rgb(24,255,255)","rgb(0,229,255)","rgb(0,184,212)","rgb(0,150,136)","rgb(224,242,241)","rgb(178,223,219)","rgb(128,203,196)","rgb(77,182,172)","rgb(38,166,154)","rgb(0,137,123)","rgb(0,121,107)","rgb(0,105,92)","rgb(0,77,64)","rgb(167,255,235)","rgb(100,255,218)","rgb(29,233,182)","rgb(0,191,165)","rgb(76,175,80)","rgb(232,245,233)","rgb(200,230,201)","rgb(165,214,167)","rgb(129,199,132)","rgb(102,187,106)","rgb(67,160,71)","rgb(56,142,60)","rgb(46,125,50)","rgb(27,94,32)","rgb(185,246,202)","rgb(105,240,174)","rgb(0,230,118)","rgb(0,200,83)","rgb(139,195,74)","rgb(241,248,233)","rgb(220,237,200)","rgb(197,225,165)","rgb(174,213,129)","rgb(156,204,101)","rgb(124,179,66)","rgb(104,159,56)","rgb(85,139,47)","rgb(51,105,30)","rgb(204,255,144)","rgb(178,255,89)","rgb(118,255,3)","rgb(100,221,23)","rgb(205,220,57)","rgb(249,251,231)","rgb(240,244,195)","rgb(230,238,156)","rgb(220,231,117)","rgb(212,225,87)","rgb(192,202,51)","rgb(175,180,43)","rgb(158,157,36)","rgb(130,119,23)","rgb(244,255,129)","rgb(238,255,65)","rgb(198,255,0)","rgb(174,234,0)","rgb(255,235,59)","rgb(255,253,231)","rgb(255,249,196)","rgb(255,245,157)","rgb(255,241,118)","rgb(255,238,88)","rgb(253,216,53)","rgb(251,192,45)","rgb(249,168,37)","rgb(245,127,23)","rgb(255,255,141)","rgb(255,255,0)","rgb(255,234,0)","rgb(255,214,0)","rgb(255,193,7)","rgb(255,248,225)","rgb(255,236,179)","rgb(255,224,130)","rgb(255,213,79)","rgb(255,202,40)","rgb(255,179,0)","rgb(255,160,0)","rgb(255,143,0)","rgb(255,111,0)","rgb(255,229,127)","rgb(255,215,64)","rgb(255,196,0)","rgb(255,171,0)","rgb(255,152,0)","rgb(255,243,224)","rgb(255,224,178)","rgb(255,204,128)","rgb(255,183,77)","rgb(255,167,38)","rgb(251,140,0)","rgb(245,124,0)","rgb(239,108,0)","rgb(230,81,0)","rgb(255,209,128)","rgb(255,171,64)","rgb(255,145,0)","rgb(255,109,0)","rgb(255,87,34)","rgb(251,233,231)","rgb(255,204,188)","rgb(255,171,145)","rgb(255,138,101)","rgb(255,112,67)","rgb(244,81,30)","rgb(230,74,25)","rgb(216,67,21)","rgb(191,54,12)","rgb(255,158,128)","rgb(255,110,64)","rgb(255,61,0)","rgb(221,44,0)","rgb(121,85,72)","rgb(239,235,233)","rgb(215,204,200)","rgb(188,170,164)","rgb(161,136,127)","rgb(141,110,99)","rgb(109,76,65)","rgb(93,64,55)","rgb(78,52,46)","rgb(62,39,35)","rgb(158,158,158)","rgb(250,250,250)","rgb(245,245,245)","rgb(238,238,238)","rgb(224,224,224)","rgb(189,189,189)","rgb(117,117,117)","rgb(97,97,97)","rgb(66,66,66)","rgb(33,33,33)","rgb(96,125,139)","rgb(236,239,241)","rgb(207,216,220)","rgb(176,190,197)","rgb(144,164,174)","rgb(120,144,156)","rgb(84,110,122)","rgb(69,90,100)","rgb(55,71,79)","rgb(38,50,56)","rgb(0,0,0)","rgb(255,255,255)"],g=[],d="#F44336,#E91E63,#673AB7,#3F51B5,#FFEB3B,#FF5722".toLowerCase().split(",");for(let y=0;y<o.length;y++){var l=/^(.*)\s(.*)\s(.*)$/.exec(o[y]),n=Number(l[1]),i=Number(l[2]),m=Number(l[3]);g[y]=Math.abs(n-a)+Math.abs(i-e)+Math.abs(m-r),d.indexOf(s[y].toLowerCase())<0&&(g[y]=255*3)}let v=Math.min.apply(Math,g),c=g.indexOf(v),x=s[c],w=f[c];return x.replace("#",""),(x+"ff").replace("#",""),w.replace("rgb(","").replace(")",""),(w.replace("rgb(","rgba(").replace(")","")+",1)").replace("rgba(","").replace(")",""),s[c]}function ua(t){return parseInt(aa((t||0).toString(16).padStart(6,"0")).substring(1),16)}function Zt(t){return(Math.floor(t.r)*256+Math.floor(t.g))*256+Math.floor(t.b)}function tt(t){return{r:Math.floor(t/256/256)%256,g:Math.floor(t/256)%256,b:Math.floor(t)%256}}class X{constructor(a,e,r){J(this,"bodyParts",8);J(this,"maxWheels",4);J(this,"wheelProb",.5);J(this,"maxLength",10);J(this,"maxRadius",5);J(this,"minRadius",1);J(this,"minAngleWeight",.32);J(this,"maxAngleWeight",6.4);J(this,"score",0);J(this,"data",{lengths:[],angleWeights:[],wheels:[],colors:[]});J(this,"importCar",function(a){var e=new X;try{var r=a;a.split(",").length<3?r=Ma(a):r=a.split(",");for(var o={lengths:[],angleWeights:[],wheels:[],colors:[]},s=0;s<8;s++)o.lengths.push(this.maxLength*parseFloat(r[s*2+1])/3),o.angleWeights.push(parseFloat(r[s*2]));for(var f=parseInt(r[r.length-1]),s=0;s<f;s++)o.wheels.push({index:parseInt(r[16+s*3]),r:this.maxRadius*parseFloat(r[16+s*3+2])/1.5,o:parseInt(r[16+s*3])>-1,axelAngle:parseFloat(r[16+s*3+1])});for(var s=0;s<16;s++)o.colors.push(parseInt(r[40+s]));e=new X(o)}catch{return!1}return e.materialize(),e});this.maxWheels;var o=this.wheelProb;if(r&&(o=r),a)this.data=a;else{this.data={lengths:[],angleWeights:[],wheels:[],colors:[]};for(var s=0;s<this.bodyParts;s++)this.data.lengths.push(this.maxLength*(Math.random()/4*3+.25)),this.data.angleWeights.push(.5+Math.random());for(var s=0;s<this.bodyParts*2;s++)this.data.colors.push((Math.floor(Math.random()*256)*256+Math.floor(Math.random()*256))*256+Math.floor(Math.random()*256));for(var s=0;s<2;s++)this.data.wheels.push({index:Math.floor(Math.random()*this.bodyParts),r:(this.maxRadius-this.minRadius)*Math.random()+this.minRadius,o:!0,axelAngle:s/this.bodyParts*Math.PI*2});for(var s=0;s<this.wheelMax-2;s++)this.data.wheels.push({index:Math.floor(Math.random()*this.bodyParts),r:(this.maxRadius-this.minRadius)*Math.random()+this.minRadius,o:Math.random()<o,axelAngle:s/this.bodyParts*Math.PI*2})}this.materialize()}fixAngleWeights(){for(var a=0,e=0;e<this.bodyParts;e++)a+=this.data.angleWeights[e];for(var e=0;e<this.bodyParts;e++)this.data.angleWeights[e]=Math.min(Math.max(this.data.angleWeights[e]/a*this.bodyParts,this.minAngleWeight),this.maxAngleWeight)}materialize(){for(var a=0;a<this.data.colors.length;a++)this.data.colors[a]=ua(this.data.colors[a])}totalAngleWeights(){for(var a=0,e=0;e<this.bodyParts;e++)a+=this.data.angleWeights[e];return a}compareWheels(a,e){return 0}wheelsAt(a){for(var e=[],r=0;r<this.data.wheels.length;r++)this.data.wheels[r].index==a&&e.push(this.data.wheels[r]);return e.sort(this.compareWheels),e}sectionSimiliarity(a,e,r){return this.data.lengths[e]/this.maxLength,this.data.angleWeights[e]/this.totalAngleWeights(),this.wheelsAt(e),a.data.lengths[r]/a.maxLength,a.data.angleWeights[r]/a.totalAngleWeights(),a.wheelsAt(r),0}bestMap(a){for(var e=0;e<this.bodyParts;e++);}getAreaOfPiece(a){a=(a%this.bodyParts+this.bodyParts)%this.bodyParts;for(var e=0,r=0;r<this.bodyParts;r++)e+=this.data.angleWeights[r];var o=Math.PI*2*this.data.angleWeights[(a+1)%this.bodyParts]/e,s=Math.sin(o)*this.data.lengths[a]*this.data.lengths[(a+1)%this.bodyParts]/2;return s}exportCar(){for(var a=[],e=0,r=0,o=0;o<this.bodyParts;o++)r+=this.data.angleWeights[o];for(var o=0;o<this.bodyParts;o++)a.push(this.data.angleWeights[o]),a.push(this.data.lengths[o]/this.maxLength*3),e+=Math.PI*2*this.data.angleWeights[o]/r;for(var s=0,o=0;o<this.data.wheels.length;o++)this.data.wheels[o].o&&(a.push(this.data.wheels[o].index),a.push(this.data.wheels[o].axelAngle),a.push(this.data.wheels[o].r/this.maxRadius*1.5),s++);for(var o=0;o<this.bodyParts-s;o++)a.push("NaN"),a.push(.1),a.push(.1);for(var o=0;o<this.bodyParts*2;o++)a.push(this.data.colors[o]);a.push(s);for(var o=0;o<a.length;o++);return a.join(",")}breed(a,e,r){var o=Math.max(1,this.score)/(Math.max(1,this.score)+Math.max(1,a.score)),s=1;this.maxWheels;var f=this.wheelProb,f=this.wheelProb;r&&(f=r);var g=.001,d=.025;this.fixAngleWeights(),a.fixAngleWeights(),this.data.wheels.sort(this.compareWheels),a.data.wheels.sort(this.compareWheels);var l=new X;l.score=this.score*o+a.score*(1-o);for(var n=0;n<this.bodyParts;n++)if(Math.random()>d){var i=(Math.random()-.5)/10+.5;i=i*(1-s)+o*s,l.data.lengths[n]=Math.min(Math.max((this.data.lengths[n]*i+a.data.lengths[n]*(1-i))*(1-g)+g*Math.random()*this.maxLength,0),this.maxLength),l.data.angleWeights[n]=Math.max((this.data.angleWeights[n]/this.totalAngleWeights()*i+a.data.angleWeights[n]/a.totalAngleWeights()*(1-i))*(1-g)+g*(Math.random()*(this.maxAngleWeight-this.minAngleWeight)+this.minAngleWeight),0)}for(var n=0;n<this.bodyParts*2;n++)if(Math.random()>d){var i=(Math.random()-.5)/10+.5;i=i*(1-s)+o*s;var m=tt(this.data.colors[n]),v=tt(a.data.colors[n]),c=tt(0);c.r=Math.min(Math.max((m.r*i+v.r*(1-i))*(1-g)+g*Math.random()*256,0),255),c.g=Math.min(Math.max((m.g*i+v.g*(1-i))*(1-g)+g*Math.random()*256,0),255),c.b=Math.min(Math.max((m.b*i+v.b*(1-i))*(1-g)+g*Math.random()*256,0),255),l.data.colors[n]=Zt(c)}l.data.wheels=[];for(var n=0;n<Math.min(Math.max(this.data.wheels.length,a.data.wheels.length),this.maxWheels);n++){var x=n<this.data.wheels.length,w=n<a.data.wheels.length,M=x?this.data.wheels[n]:a.data.wheels[n],P=x&&w?a.data.wheels[n]:M,i=(Math.random()-.5)/10+.5;i=i*(1-s)+o*s,M.o&&M.r,P.o&&P.r;var y=Math.min(Math.max((M.r*i+P.r*(1-i))*(1-g)+g*Math.random()*this.maxRadius,this.minRadius),this.maxRadius),i=(Math.random()-.5)/10+.5;i=i*(1-s)+o*s;var A=((M.o?1:0)*i+(P.o?1:0)*(1-i))*(1-g)+g*Math.random()>.5,k={x:Math.cos(M.index*Math.PI*2/this.bodyParts),y:Math.sin(M.index*Math.PI*2/this.bodyParts)},E={x:Math.cos(P.index*Math.PI*2/this.bodyParts),y:Math.sin(P.index*Math.PI*2/this.bodyParts)},i=(Math.random()-.5)/10+.5;i=i*(1-s)+o*s;var R={x:k.x*i+E.x*(1-i),y:k.y*i+E.y*(1-i)},B=Math.floor(Math.atan2(R.y,R.x)/Math.PI/2*this.bodyParts+.05),L=Math.floor(Math.random()*this.bodyParts),k={x:Math.cos(L*Math.PI*2/this.bodyParts),y:Math.sin(L*Math.PI*2/this.bodyParts)},E={x:Math.cos(B*Math.PI*2/this.bodyParts),y:Math.sin(B*Math.PI*2/this.bodyParts)};i=g,R={x:k.x*i+E.x*(1-i),y:k.y*i+E.y*(1-i)},B=(Math.floor(Math.atan2(R.y,R.x)/Math.PI/2*this.bodyParts+.05)%this.bodyParts+this.bodyParts)%this.bodyParts,Math.random()<d&&(B=Math.floor(Math.random()*this.bodyParts)),y<=this.minRadius&&(A=!1),Math.random()<d&&(A=Math.random()>.1,y=(this.maxRadius-this.minRadius)*Math.random()+this.minRadius);var rt={index:B,r:y,o:A,axelAngle:B/this.bodyParts*Math.PI*2};l.data.wheels.push(rt)}var H=e-l.data.wheels.length;if(H>0)for(var S=0;S<H;S++){var q=Math.floor(Math.random()*this.bodyParts);l.data.wheels.push({index:q+0,r:(this.maxRadius-this.minRadius)*Math.random()+this.minRadius,o:Math.random()<f,axelAngle:q/this.bodyParts*Math.PI*2})}if(H<0)for(var S=0;S<-H;S++)l.data.wheels.splice(Math.floor(Math.random()*l.data.wheels.length),1);for(var et=0,n=0;n<l.data.wheels.length;n++)l.data.wheels[n].o&&et++;var ot=l.data.wheels.length*f-et;if(ot>0)for(var S=0;S<ot;S++){var st=Math.floor(Math.random()*l.data.wheels.length);l.data.wheels[st].o=Math.random()<.5||l.data.wheels[st].o}if(Math.random()<d)if(l.data.wheels.length<this.maxWheels&&Math.random()<.5){var q=Math.floor(Math.random()*this.bodyParts);l.data.wheels.push({index:q,r:(this.maxRadius-this.minRadius)*Math.random()+this.minRadius,o:Math.random()<.1,axelAngle:q/this.bodyParts*Math.PI*2})}else l.data.wheels.splice(Math.floor(Math.random()*l.data.wheels.length),1);return l.materialize(),l.fixAngleWeights(),l}breed2(a,e,r){var o=Math.max(1,this.score)/(Math.max(1,this.score)+Math.max(1,a.score)),s=2;this.maxWheels;var f=this.wheelProb,f=this.wheelProb;r&&(f=r);var g=.05;this.fixAngleWeights(),a.fixAngleWeights(),this.data.wheels.sort(this.compareWheels),a.data.wheels.sort(this.compareWheels);var d=new X;d.score=this.score*o+a.score*(1-o);for(var l=0;l<this.bodyParts;l++)if(Math.random()>g){var n=(Math.random()-.5)/10+.5;n=n*(1-s)+o*s;var i=i>Math.random()?1:0;d.data.lengths[l]=Math.min(Math.max((this.data.lengths[l]*n+a.data.lengths[l]*(1-n))*(1-i)+i*Math.random()*this.maxLength,0),this.maxLength);var i=i>Math.random()?1:0;d.data.angleWeights[l]=Math.max((this.data.angleWeights[l]/this.totalAngleWeights()*n+a.data.angleWeights[l]/a.totalAngleWeights()*(1-n))*(1-i)+i*Math.random()*1/this.bodyParts,0)}for(var l=0;l<this.bodyParts*2;l++)if(Math.random()>g){var n=(Math.random()-.5)/10+.5;n=n*(1-s)+o*s;var m=tt(this.data.colors[l]),v=tt(a.data.colors[l]),c=tt(0),i=i>Math.random()?1:0;c.r=Math.min(Math.max((m.r*n+v.r*(1-n))*(1-i)+i*Math.random()*256,0),255);var i=i>Math.random()?1:0;c.g=Math.min(Math.max((m.g*n+v.g*(1-n))*(1-i)+i*Math.random()*256,0),255);var i=i>Math.random()?1:0;c.b=Math.min(Math.max((m.b*n+v.b*(1-n))*(1-i)+i*Math.random()*256,0),255),d.data.colors[l]=Zt(c)}d.data.wheels=[];for(var l=0;l<Math.min(Math.max(this.data.wheels.length,a.data.wheels.length),this.maxWheels);l++){var x=l<this.data.wheels.length,w=l<a.data.wheels.length,M=x?this.data.wheels[l]:a.data.wheels[l],P=x&&w?a.data.wheels[l]:M,n=(Math.random()-.5)/10+.5;n=n*(1-s)+o*s,M.o&&M.r,P.o&&P.r;var i=i>Math.random()?1:0,y=Math.min(Math.max((M.r*n+P.r*(1-n))*(1-i)+i*Math.random()*this.maxRadius,this.minRadius),this.maxRadius),n=(Math.random()-.5)/10+.5;n=n*(1-s)+o*s;var i=i>Math.random()?1:0,A=((M.o?1:0)*n+(P.o?1:0)*(1-n))*(1-i)+i*Math.random()>.5,k={x:Math.cos(M.index*Math.PI*2/this.bodyParts),y:Math.sin(M.index*Math.PI*2/this.bodyParts)},E={x:Math.cos(P.index*Math.PI*2/this.bodyParts),y:Math.sin(P.index*Math.PI*2/this.bodyParts)},n=(Math.random()-.5)/10+.5;n=n*(1-s)+o*s;var R={x:k.x*n+E.x*(1-n),y:k.y*n+E.y*(1-n)},B=Math.floor(Math.atan2(R.y,R.x)/Math.PI/2*this.bodyParts),L=Math.floor(Math.random()*this.bodyParts),k={x:Math.cos(L*Math.PI*2/this.bodyParts),y:Math.sin(L*Math.PI*2/this.bodyParts)},E={x:Math.cos(B*Math.PI*2/this.bodyParts),y:Math.sin(B*Math.PI*2/this.bodyParts)};n=i,R={x:k.x*n+E.x*(1-n),y:k.y*n+E.y*(1-n)};var i=i>Math.random()?1:0;B=(Math.floor(Math.atan2(R.y,R.x)/Math.PI/2*this.bodyParts)+this.bodyParts+this.bodyParts)%this.bodyParts,Math.random()<g&&(B=Math.floor(Math.random()*this.bodyParts)),y<=this.minRadius&&(A=!1),Math.random()<g&&(A=Math.random()>.1,y=(this.maxRadius-this.minRadius)*Math.random()+this.minRadius);var rt={index:B,r:y,o:A,axelAngle:B/this.bodyParts*Math.PI*2};d.data.wheels.push(rt)}var H=e-d.data.wheels.length;if(H>0)for(var S=0;S<H;S++){var q=Math.floor(Math.random()*this.bodyParts);d.data.wheels.push({index:q+0,r:(this.maxRadius-this.minRadius)*Math.random()+this.minRadius,o:Math.random()<f,axelAngle:q/this.bodyParts*Math.PI*2})}if(H<0)for(var S=0;S<-H;S++)d.data.wheels.splice(Math.floor(Math.random()*d.data.wheels.length),1);for(var et=0,l=0;l<d.data.wheels.length;l++)d.data.wheels[l].o&&et++;var ot=d.data.wheels.length*f-et;if(ot>0)for(var S=0;S<ot;S++){var st=Math.floor(Math.random()*d.data.wheels.length);d.data.wheels[st].o=Math.random()<.5||d.data.wheels[st].o}if(Math.random()<g)if(d.data.wheels.length<this.maxWheels&&Math.random()<.5){var q=Math.floor(Math.random()*this.bodyParts);d.data.wheels.push({index:q,r:(this.maxRadius-this.minRadius)*Math.random()+this.minRadius,o:Math.random()<.1,axelAngle:q/this.bodyParts*Math.PI*2})}else d.data.wheels.splice(Math.floor(Math.random()*d.data.wheels.length),1);return d.materialize(),d.fixAngleWeights(),d}clone(){this.data.wheels.sort(this.compareWheels);for(var a=new X,e=0;e<this.bodyParts;e++)a.data.lengths[e]=this.data.lengths[e]+0,a.data.angleWeights[e]=this.data.angleWeights[e]+0;a.data.wheels=[];for(var e=0;e<this.data.wheels.length;e++){var r=this.data.wheels[e],o={index:r.index+0,r:r.r+0,o:r.o&&!0,axelAngle:r.axelAngle+0};a.data.wheels.push(o)}return a.materialize(),a}}function Ma(t){for(var a=ya(t),e=new JXG.Util.Unzip(JXG.Util.Base64.decodeAsArray(t)).unzip()[0][0],r=[],o=0;o<16;o++)r.push(a.getFloat64(o*8));for(var o=0;o<8;o++){var s=a.getInt32(o*8*2.5+128);Math.abs(s)<10||(s=NaN),r.push(s),r.push(a.getFloat64(o*8*2.5+16*8+.5*8)),Math.abs(r[r.length-1])<Math.pow(2,-100)&&(r[r.length-1]=0),r.push(a.getFloat64(o*8*2.5+16*8+1.5*8)),Math.abs(r[r.length-1])<Math.pow(2,-100)&&(r[r.length-1]=0)}for(var f=(a.getUint8(44*8+3)%8+7)%8+1,o=0;o<16;o++){var g=o*4+288;g<e.length-1&&r.push(a.getUint32(g))}return r.push(f),r}function ya(t){for(var a=new JXG.Util.Unzip(JXG.Util.Base64.decodeAsArray(t)).unzip()[0][0],e=new ArrayBuffer(a.length),r=new DataView(e),o=0;o<a.length;o++)r.setUint8(o,a.charCodeAt(o),!1);return r}var bt={};function N(t,a,e){this.x=t,this.y=a,this.z=e}N.prototype.dot2=function(t,a){return this.x*t+this.y*a};N.prototype.dot3=function(t,a,e){return this.x*t+this.y*a+this.z*e};var pa=[new N(1,1,0),new N(-1,1,0),new N(1,-1,0),new N(-1,-1,0),new N(1,0,1),new N(-1,0,1),new N(1,0,-1),new N(-1,0,-1),new N(0,1,1),new N(0,-1,1),new N(0,1,-1),new N(0,-1,-1)],Qt=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],u=new Array(512),_=new Array(512);bt.seed=function(t){t>0&&t<1&&(t*=65536),t=Math.floor(t),t<256&&(t|=t<<8);for(var a=0;a<256;a++){var e;a&1?e=Qt[a]^t&255:e=Qt[a]^t>>8&255,u[a]=u[a+256]=e,_[a]=_[a+256]=pa[e%12]}};bt.seed(0);var xa=.5*(Math.sqrt(3)-1),wt=(3-Math.sqrt(3))/6,Pa=1/3,D=1/6;bt.simplex2=function(t,a){var e,r,o,s=(t+a)*xa,f=Math.floor(t+s),g=Math.floor(a+s),d=(f+g)*wt,l=t-f+d,n=a-g+d,i,m;l>n?(i=1,m=0):(i=0,m=1);var v=l-i+wt,c=n-m+wt,x=l-1+2*wt,w=n-1+2*wt;f&=255,g&=255;var M=_[f+u[g]],P=_[f+i+u[g+m]],y=_[f+1+u[g+1]],A=.5-l*l-n*n;A<0?e=0:(A*=A,e=A*A*M.dot2(l,n));var R=.5-v*v-c*c;R<0?r=0:(R*=R,r=R*R*P.dot2(v,c));var B=.5-x*x-w*w;return B<0?o=0:(B*=B,o=B*B*y.dot2(x,w)),70*(e+r+o)};bt.simplex3=function(t,a,e){var r,o,s,f,g=(t+a+e)*Pa,d=Math.floor(t+g),l=Math.floor(a+g),n=Math.floor(e+g),i=(d+l+n)*D,m=t-d+i,v=a-l+i,c=e-n+i,x,w,M,P,y,A;m>=v?v>=c?(x=1,w=0,M=0,P=1,y=1,A=0):m>=c?(x=1,w=0,M=0,P=1,y=0,A=1):(x=0,w=0,M=1,P=1,y=0,A=1):v<c?(x=0,w=0,M=1,P=0,y=1,A=1):m<c?(x=0,w=1,M=0,P=0,y=1,A=1):(x=0,w=1,M=0,P=1,y=1,A=0);var R=m-x+D,B=v-w+D,L=c-M+D,k=m-P+2*D,E=v-y+2*D,rt=c-A+2*D,H=m-1+3*D,S=v-1+3*D,q=c-1+3*D;d&=255,l&=255,n&=255;var et=_[d+u[l+u[n]]],ot=_[d+x+u[l+w+u[n+M]]],st=_[d+P+u[l+y+u[n+A]]],fa=_[d+1+u[l+1+u[n+1]]],yt=.6-m*m-v*v-c*c;yt<0?r=0:(yt*=yt,r=yt*yt*et.dot3(m,v,c));var pt=.6-R*R-B*B-L*L;pt<0?o=0:(pt*=pt,o=pt*pt*ot.dot3(R,B,L));var xt=.6-k*k-E*E-rt*rt;xt<0?s=0:(xt*=xt,s=xt*xt*st.dot3(k,E,rt));var Pt=.6-H*H-S*S-q*q;return Pt<0?f=0:(Pt*=Pt,f=Pt*Pt*fa.dot3(H,S,q)),32*(r+o+s+f)};function Tt(t){return t*t*t*(t*(t*6-15)+10)}function Z(t,a,e){return(1-e)*t+e*a}bt.perlin2=function(t,a){var e=Math.floor(t),r=Math.floor(a);t=t-e,a=a-r,e=e&255,r=r&255;var o=_[e+u[r]].dot2(t,a),s=_[e+u[r+1]].dot2(t,a-1),f=_[e+1+u[r]].dot2(t-1,a),g=_[e+1+u[r+1]].dot2(t-1,a-1),d=Tt(t);return Z(Z(o,f,d),Z(s,g,d),Tt(a))};bt.perlin3=function(t,a,e){var r=Math.floor(t),o=Math.floor(a),s=Math.floor(e);t=t-r,a=a-o,e=e-s,r=r&255,o=o&255,s=s&255;var f=_[r+u[o+u[s]]].dot3(t,a,e),g=_[r+u[o+u[s+1]]].dot3(t,a,e-1),d=_[r+u[o+1+u[s]]].dot3(t,a-1,e),l=_[r+u[o+1+u[s+1]]].dot3(t,a-1,e-1),n=_[r+1+u[o+u[s]]].dot3(t-1,a,e),i=_[r+1+u[o+u[s+1]]].dot3(t-1,a,e-1),m=_[r+1+u[o+1+u[s]]].dot3(t-1,a-1,e),v=_[r+1+u[o+1+u[s+1]]].dot3(t-1,a-1,e-1),c=Tt(t),x=Tt(a),w=Tt(e);return Z(Z(Z(f,n,c),Z(g,i,c),w),Z(Z(d,m,c),Z(l,v,c),w),x)};const wa=bt;wa.seed(3);var F=document.getElementById("c"),h=F.getContext("2d");F.width=window.innerWidth;F.height=window.innerHeight;var Y={x:0,y:0},zt=!1,Aa=!1,Nt=2,Ht=4,ra=65535,Ba=65535^Nt^Ht,ea=65535^Ht^Nt;let $={WHITE:"#DDDDDB",WHITER:"#EDEDEB",BLACK:"#2F3436",HUES:["#FF9157","#FDCF51","#7EB0EA"]},Wa=$.HUES.map(t=>{let a=ct(t).rgb(!1),e=ct($.WHITE).rgb(!1);return ct.rgb(Math.min(a[0]/e[0],1)*255,Math.min(a[1]/e[1],1)*255,Math.min(a[2]/e[2],1)*255).hex()});console.log(Wa);var mt={};mt.filterCategoryBits=Ht;mt.filterMaskBits=ea;mt.density=.5;mt.friction=10;mt.restitution=.1;var ut={};ut.filterCategoryBits=Nt;ut.filterMaskBits=ra;ut.density=2;ut.friction=10;ut.restitution=.05;var Mt={};Mt.filterCategoryBits=Nt;Mt.filterMaskBits=ra;Mt.density=-2;Mt.friction=10;Mt.restitution=.05;var ft={};ft.filterCategoryBits=Ht;ft.filterMaskBits=ea;ft.density=15;ft.friction=10;ft.restitution=.05;var Jt={};Jt.filterMaskBits=Ba;Jt.density=2;Jt.restitution=.05;var oa=10,Ra=1.5,At=1,Q=ca,T=Q.Vec2,C=new Q.World({gravity:T(0,-oa)}),sa=6*Math.PI,Ct=C.createBody(),Wt=-200,Bt=25,Ta={density:0,friction:2},$t=0,Et=0,Ca=400,_t=0,at=0;function Sa(t){at<t-3&&(_t=0,at=t+0,I.score=t+0,Et=$t+0)}function _a(t){if(t<Bt)return 0;var a=1;return t<Bt+100&&(a=Math.max(t-Bt,0)/100),-Math.sin(Math.max(t-Bt,0)/20+Math.pow(Math.max(t-Bt,0)/20,1.75)/20)*10*a}var St=[];function Oa(){St.filter(function(t){return t.m_body.m_xf.p.x+t.m_shape.m_centroid.x<Y.x-Math.max(F.width/b/2,100)}).forEach(function(t){St.splice(St.indexOf(t),1),Ct.destroyFixture(t)})}function Fa(){for(;Ct.m_fixtureList;)Ct.destroyFixture(Ct.m_fixtureList);St=[]}function Dt(){for(;Wt<Y.x+Math.max(F.width/b/2,100);){var t=.5,a=Wt,e=Wt+2;Wt=e;var r=_a,o=T(a,r(a)),s=T(e,r(e)),f=Math.atan2(s.y-o.y,s.x-o.x);let l=T(s.y-o.y,o.x-s.x);l.normalize();var g=Q.Box(Math.sqrt(Math.pow(s.x-o.x,2)+Math.pow(s.y-o.y,2))/2,t,T(o.x/2+s.x/2,o.y/2+s.y/2).add(l.mul(t/2)),f),d=Ct.createFixture(g,Ta);St.push(d),d.render={special:"ground",fill:$.BLACK,stroke:$.BLACK,layer:0}}}Dt();var p=[],lt=[],K=[],jt=6,Ia=16,G=new X;function ta(){for(var t=[],a=0;a<p.length;a++)t.push(p[p.length-a-1].car);for(var a=0;a<lt.length;a++)t.push(lt[lt.length-a-1].car);for(var a=0;a<K.length;a++)t.push(K[K.length-a-1].car);var e=1;return t[Math.floor(Math.pow(Math.random(),e)*t.length)].breed(t[Math.floor(Math.pow(Math.random(),e)*t.length)])}function La(){return p.length<1?"":(p.sort(function(t,a){return t.score-a.score}),p[p.length-1].car.exportCar())}function ka(){if(p.length<1)return 0;for(var t=p[0].score,a=0;a<p.length;a++)t=Math.min(t,p[a].score);return t}function Ea(t,a,e){p.push({score:a,ticks:e,car:t}),p.sort(function(r,o){return r.score-o.score}),p.length>jt&&p.splice(0,p.length-jt)}function ia(){p.sort(function(o,s){return o.score-s.score}),p.length>0&&document.querySelectorAll("#score-best")[0].setAttribute("value",p[p.length-1].car.exportCar());for(var t="",a=0;a<p.length;a++){var e=p[p.length-a-1],r="<tr title='Copy car to clipboard' data-clipboard-target='#score"+a+"'>";r+="<td>",r+=e.score.toFixed(2),r+="</td>",r+="<td>",r+=(e.ticks*1/75).toFixed(2),r+="</td>",r+="</tr>",t+=r}for(var a=0;a<p.length;a++){var e=p[p.length-a-1];t+='<input class="hidden-score-export" id="score'+a+'" value="'+e.car.exportCar()+'">'}document.querySelectorAll(".score-table tbody")[0].innerHTML!=t&&(document.querySelectorAll(".score-table tbody")[0].innerHTML=t)}function na(t){at=Math.max(I.getPosition().x,at);var a=at+0,e=Et+0;t?(p=[],lt=[],K=[],G=new X,kt(G)):(a>0&&(K.push({score:a,ticks:Et,car:G.clone()}),Ea(G.clone(),a,e)),K.length>=Ia&&(K.sort(function(r,o){return r.score-o.score}),K.splice(0,K.length-4),lt=K,K=[]),lt.length===0?(p.length>0?G=ta():G=new X,kt(G)):(G=ta(),kt(G))),ia()}function Ga(t){p=[],lt=[],K=[],G=new X().importCar(t),kt(G)}var Yt,Rt,dt=T(0,10),I=C.createDynamicBody({position:dt.clone()}),ha=mt;ha.friction=1;var Kt=!1,vt=[],O=[],Ot=[],Gt=[],gt=[],qt=[],z=[],it=[],V=[],j=[],Vt=[],U=[],Ft=[],It=[],nt=[],ht=[],Xt=dt.clone();function qa(){for(var t=0;t<O.length;t++)C.destroyBody(O[t]);for(var t=0;t<gt.length;t++)C.destroyBody(gt[t].m_body);for(var t=0;t<z.length;t++)z[t]&&C.destroyBody(z[t]);for(var t=0;t<ht.length;t++)ht[t]&&C.destroyBody(ht[t]);for(var t=0;t<j.length;t++)j[t]&&C.destroyBody(j[t]);for(var t=0;t<nt.length;t++)nt[t]&&C.destroyBody(nt[t]);C.destroyBody(I),I=C.createBody({position:dt.clone()}),vt=[],O=[],Ot=[],Gt=[],gt=[],qt=[],z=[],it=[],V=[],Ft=[],ht=[],j=[],U=[],It=[],nt=[],Xt=dt.clone()}var W=1;let Lt=$.HUES;function kt(t){_t=0,G=t,qa(),I=C.createDynamicBody({position:dt.clone()}),O=[],Ot=[],Gt=[],gt=[],qt=[],z=[],it=[],V=[],Ft=[],ht=[],j=[],U=[],It=[],nt=[],Xt=dt.clone();var a=dt.y+0,e=Math.abs(t.data.angleWeights[0]/t.totalAngleWeights()*Math.PI*2%(Math.PI*2));(e+Math.PI)%(Math.PI*2)-Math.PI<0&&(e=Math.PI-1-((e+Math.PI)%(Math.PI*2)-Math.PI));for(var r=0;r<t.bodyParts;r++){Gt.push(t.getAreaOfPiece(r));var o=e+t.data.angleWeights[(r+1)%t.data.angleWeights.length]/t.totalAngleWeights()*Math.PI*2,s=Q.Polygon([T(0,0),T(Math.cos(e+0)*t.data.lengths[r]*W,Math.sin(e+0)*t.data.lengths[r]*W),T(Math.cos(o+0)*t.data.lengths[(r+1)%t.data.lengths.length]*W,Math.sin(o+0)*t.data.lengths[(r+1)%t.data.lengths.length]*W)]),f=ut;(((o-e+0)/Math.PI*180+360)%360+360)%360>180&&(f=Mt,console.log("neg"));var g=I.createFixture(s,f);a=Math.min(a,g.getAABB(0).lowerBound.y),tt(parseInt(aa((t.data.colors[r]||0).toString(16).padStart(6,"0")).substring(1),16));let k=t.data.colors[r]||0;var d=Lt[k%Lt.length];g.render={fill:d,stroke:d,layer:6},O.push(g),Ot.push(r),qt.push(s);for(var l=t.wheelsAt(r),n=[],i=[],m=0;m<l.length;m++){var v=l[m];if(v.o){tt(t.data.colors[(t.data.wheels.indexOf(v)+8)%t.data.colors.length]);var c=T(Math.cos(e)*t.data.lengths[r]*W,Math.sin(e)*t.data.lengths[r]*W).add(Xt).sub(T(Math.cos(v.axelAngle)*t.maxRadius*W/3,Math.sin(v.axelAngle)*t.maxRadius*W/3)),x=T(Math.cos(v.axelAngle)*.2*W*t.maxRadius/3,Math.sin(v.axelAngle)*.2*W*t.maxRadius/3).add(c),w=C.createDynamicBody(x),M=w.createFixture(Q.Box(.2*W*t.maxRadius/1.5,.05*W*t.maxRadius/1.5,T(0,0),v.axelAngle),ft),P=g.getBody().createFixture(Q.Box(.2*W*t.maxRadius/1.5,.1*W*t.maxRadius/1.5,T(Math.cos(e)*t.data.lengths[r]*W,Math.sin(e)*t.data.lengths[r]*W),v.axelAngle),ft),y=C.createDynamicBody(c),A=y.createFixture(Q.Circle(v.r*W*.89),ha);A.render={fill:$.BLACK,layer:7};let E=t.data.colors[(t.data.wheels.indexOf(v)+8)%t.data.colors.length]||0;var d=Lt[E%Lt.length];P.render={fill:d,stroke:d,layer:9},M.render={fill:d,stroke:d,layer:8};var R=C.createJoint(Q.PrismaticJoint({enableMotor:!0,lowerTranslation:-t.maxRadius*W/3,upperTranslation:t.maxRadius*W/3*.075,enableLimit:!0},g.getBody(),w,y.getWorldCenter(),T(-Math.cos(v.axelAngle)/1,-Math.sin(v.axelAngle)/1))),B=C.createJoint(Q.RevoluteJoint({motorSpeed:-sa,maxMotorTorque:42/2,enableMotor:!0},M.getBody(),y,y.getWorldCenter()));V.push(B),n.push(B),z.push(y),it.push(A),U.push(R),i.push(R),j.push(w),Vt.push(M),a=Math.min(a,A.getAABB(0).lowerBound.y),g.getBody().resetMassData()}}Ft.push([n]),It.push([i]),e=o}a=a-.5,I.resetMassData(),I.setPosition(T(I.getPosition().x,I.getPosition().y-a));for(var r=0;r<Vt.length;r++){var L=Vt[r].m_body;L.setPosition(T(L.getPosition().x,L.getPosition().y-a))}for(var r=0;r<it.length;r++){var L=it[r].m_body;L.setPosition(T(L.getPosition().x,L.getPosition().y-a))}at=0,Y.x=0,_t=0,Et=0,$t=0,Wt=-200,Fa(),Dt(),ia()}na(!0);C.on("post-solve",function(t,a){for(var e=t;e;){for(var r=0;r<O.length;r++){var o=O[r],s=50*O[r].m_body.m_mass/2;if(e.getFixtureA()==o&&gt.indexOf(e.getFixtureB())<0&&it.indexOf(e.getFixtureB())<0||e.getFixtureB()==o&&gt.indexOf(e.getFixtureA())<0&&it.indexOf(e.getFixtureA())<0){for(var f=!1,g=0;g<e.v_points.length;g++)e.v_points[g].normalImpulse>s&&(f=!0);f&&vt.push(o)}}e=e.m_next}});function Na(t){if(O.indexOf(t)>=0){O.indexOf(t);var a=qt.splice(O.indexOf(t),1)[0];Gt.splice(O.indexOf(t),1)[0];var e=Ot.splice(O.indexOf(t),1)[0],r=Ft.splice(O.indexOf(t),1)[0],o=It.splice(O.indexOf(t),1)[0];O.splice(O.indexOf(t),1);var s=I.m_fixtureList;if(s.m_shape,!s.m_shape||!s.getBody())return;O.indexOf(s);var f=s.getBody(),g=f.getWorldCenter();if(r[1])for(var d=0;d<r[1].length;d++)nt.push(j.splice(j.indexOf(o[1][d].m_bodyB),1)[0]),ht.push(z.splice(z.indexOf(r[1][d].m_bodyB),1)[0]),C.destroyJoint(r[1][d]),C.destroyJoint(o[1][d]);var l=Ot.indexOf((e+G.bodyParts-1)%G.bodyParts);if(l>=0&&Aa){Ft[l][1]=r[0],It[l][1]=o[0];for(var d=0;d<o[0].length;d++)o[0][d].m_bodyA=O[l].m_body}else for(var d=0;d<r[0].length;d++)ht.push(z.splice(z.indexOf(r[0][d].m_bodyB),1)[0]),C.destroyJoint(r[0][d]),nt.push(z.splice(j.indexOf(o[0][d].m_bodyB),1)[0]),C.destroyJoint(o[0][d]);var n=t.render;I.destroyFixture(t),t=null;var i=C.createBody({type:"dynamic",position:f.getPosition(),angle:f.getAngle()});t=i.createFixture(a,Jt),t.render=n,t.render.layer=2,gt.push(t);var m=f.getWorldCenter(),v=i.getWorldCenter(),c=T.add(Yt,T.cross(Rt,T.sub(m,g))),x=T.add(Yt,T.cross(Rt,T.sub(v,g)));f.setAngularVelocity(Rt),f.setLinearVelocity(c),i.setAngularVelocity(Rt),i.setLinearVelocity(x),I.resetMassData()}}window.setInterval(Oa,1e3);function Ha(){Dt();var t=I.m_mass;try{for(var a=0;a<V.length;a++)V[a].m_bodyB&&V[a].m_bodyB.m_mass&&(t+=V[a].m_bodyB.m_mass),U[a].m_bodyB&&(t+=U[a].m_bodyB.m_mass)}catch{}t=t/W/W;for(var e=Ra*oa/V.length*t,r=7.5*t/6,a=0;a<V.length;a++)V[a].m_bodyB&&V[a].setMaxMotorTorque(e*2),U[a].setMotorSpeed(sa),U[a].enableMotor(!0),U[a].m_bodyB&&(U[a].setMaxMotorForce(r+40/40*r*Math.pow(5*U[a].getJointTranslation()/W/(G.maxRadius*W/3),2)),U[a].setMotorSpeed(-20/20*5*U[a].getJointTranslation()/W/(G.maxRadius*W/3)));_t++,$t++;var o=I.getPosition();if(Y.x=o.x,Y.y=-o.y,Sa(o.x),(_t>=Ca||O.length<3)&&na(),vt.length>0){for(var s=0;s<vt.length;s++)Na(vt[s]);vt=[]}Yt=I.getLinearVelocity(),Rt=I.getAngularVelocity()}function la(){for(var t=0;t<At;t++)if(!zt){Kt!==document.getElementById("switch-1").checked&&(At=5),Kt=document.getElementById("switch-1").checked,Kt?at>ka()?At=5:At=100:At=document.getElementById("sim-speed").value,document.querySelectorAll(".score-text")[0].innerText="Score: "+Math.round(Math.max(I.getPosition().x,at)*100)/100,C.step(1/75);var a=new Date().getTime();Ha(),new Date().getTime()-a}window.setTimeout(la,0)}function Ja(){var t=document.getElementById("car-code-area").value,a=new X().importCar(t);a&&(Ga(t),da())}document.getElementById("importCarFromDialog").onclick=Ja;function da(){document.getElementById("car-code-area").value="";var t=document.querySelector(".import-dialog .mdl-textfield");t.MaterialTextfield.checkDirty(),zt=!1,document.querySelector("div.import-dialog").setAttribute("open","false")}document.getElementById("closeImportDialog").onclick=da;function Ua(){document.getElementById("car-code-area").value="";var t=document.querySelector(".import-dialog .mdl-textfield");t.MaterialTextfield.checkDirty(),zt=!0,document.querySelector("div.import-dialog").setAttribute("open","true")}document.getElementById("openImportDialog").onclick=Ua;la();window.addEventListener("resize",function(){F.width=window.innerWidth,F.height=window.innerHeight});var Ka=document.createElement("canvas");Ka.getContext("2d");var b=Math.min(F.width/40,F.height/40);function ga(){var g;b=Math.min(F.width/40,F.height/40),h.setTransform(1,0,0,1,0,0),h.clearRect(0,0,F.width,F.height),h.fillStyle=$.WHITE,h.fillRect(0,0,F.width,F.height),h.translate(-Y.x*b,-Y.y*b),h.globalAlpha=1,h.globalCompositeOperation="multiply",h.fillStyle=h.createPattern(paperTex,"repeat"),h.globalCompositeOperation="source-over",h.globalAlpha=1,h.translate(Y.x*b,Y.y*b),h.translate(F.width/2,F.height/2),h.scale(1,-1),h.translate(-Y.x*b,Y.y*b);var t=[];function a(d,l,n){for(var i=!1,m=0;m<t.length;m++)t[m].index==d&&(i=!0,t[m].pairs.push({f:l,b:n}));i||t.push({index:d,pairs:[{f:l,b:n}]})}for(var e=C.getBodyList();e;e=e.getNext())for(var r=e.getFixtureList();r;r=r.getNext()){var o=0;r.render&&r.render.layer&&(o=r.render.layer),a(o,r,e)}t.sort(function(d,l){return d.index-l.index});for(var s=0;s<t.length;s++)for(var f=0;f<t[s].pairs.length;f++){var r=t[s].pairs[f].f,e=t[s].pairs[f].b;h.strokeStyle=r.render&&r.render.stroke?r.render.stroke:"#000000",h.fillStyle=r.render&&r.render.fill?r.render.fill:"rgba(0,0,0,0)",h.lineWidth=1,h.save(),h.globalCompositeOperation="source-over",h.translate(r.m_body.m_xf.p.x*b,r.m_body.m_xf.p.y*b),h.rotate(Math.atan2(r.m_body.m_xf.q.s,r.m_body.m_xf.q.c)),r.m_shape.getType()=="polygon"&&Ya(r.m_shape,r,((g=r.render)==null?void 0:g.special)==="ground"),r.m_shape.getType()=="circle"&&Va(r.m_shape),h.restore(),h.globalCompositeOperation="source-over",h.globalAlpha=1}window.requestAnimationFrame(ga)}window.requestAnimationFrame(ga);function Va(t,a){h.save();let e=new Path2D;e.arc(t.m_p.x*b,t.m_p.y*b,t.m_radius*b,0,2*Math.PI),h.clip(e),h.beginPath(),h.shadowBlur=0,h.shadowColor="rgba(0,0,0,0)",h.shadowOffsetY=0,h.shadowOffsetX=0,h.strokeStyle=$.BLACK,h.lineWidth=8,h.globalCompositeOperation,h.globalCompositeOperation="source-over",h.strokeStyle=$.BLACK,h.fillStyle=ct($.BLACK).brighten(1),h.arc(t.m_p.x*b,t.m_p.y*b,t.m_radius*b,0,2*Math.PI),h.fill(),h.beginPath(),h.arc(t.m_p.x*b,t.m_p.y*b,t.m_radius*b,0,2*Math.PI),h.stroke(),h.beginPath(),h.strokeStyle=$.BLACK,h.lineWidth=4,h.moveTo(t.m_p.x*b,t.m_p.y*b),h.lineTo(t.m_p.x*b+t.m_radius*b,t.m_p.y*b),h.stroke(),h.globalCompositeOperation="orig",h.restore()}function Ya(t,a,e){var f,g;h.save();let r=new Path2D;r.moveTo(t.m_vertices[0].x*b,t.m_vertices[0].y*b);for(var o=1;o<t.m_vertices.length;o++)r.lineTo(t.m_vertices[o].x*b,t.m_vertices[o].y*b);e||h.clip(r),h.lineJoin="round",h.beginPath();let s=h.globalCompositeOperation;if(e){h.globalCompositeOperation="source-over",h.strokeStyle="#8B9B56",h.fillStyle=ct("#8B9B56").brighten(1),h.moveTo(t.m_vertices[1].x*b,t.m_vertices[1].y*b),h.lineTo(t.m_vertices[2].x*b,t.m_vertices[2].y*b);let d=h.getTransform().transformPoint(new DOMPoint(t.m_vertices[1].x*b,t.m_vertices[1].y*b)),l=h.getTransform().transformPoint(new DOMPoint(t.m_vertices[2].x*b,t.m_vertices[2].y*b)),n=h.getTransform().inverse().transformPoint(new DOMPoint(l.x,F.height));h.lineTo(n.x,n.y);let i=h.getTransform().inverse().transformPoint(new DOMPoint(d.x,F.height));h.lineTo(i.x,i.y),h.save(),h.clip(),h.moveTo(t.m_vertices[1].x*b,t.m_vertices[1].y*b),h.lineTo(t.m_vertices[2].x*b,t.m_vertices[2].y*b),h.lineTo(n.x,n.y),h.lineTo(i.x,i.y),h.fill(),h.beginPath(),h.lineWidth=8,h.moveTo(t.m_vertices[1].x*b,t.m_vertices[1].y*b),h.lineTo(t.m_vertices[2].x*b,t.m_vertices[2].y*b),h.stroke(),h.restore()}else{h.moveTo(t.m_vertices[0].x*b,t.m_vertices[0].y*b);for(var o=1;o<t.m_vertices.length;o++)h.lineTo(t.m_vertices[o].x*b,t.m_vertices[o].y*b)}h.shadowBlur=0,h.shadowColor="rgba(0,0,0,0)",h.shadowOffsetY=0,h.shadowOffsetX=0,h.fillStyle=ct((g=(f=a.render)==null?void 0:f.stroke)!=null?g:h.strokeStyle).brighten(1),h.lineWidth=8,h.closePath(),e||(h.fill(),h.stroke()),h.globalCompositeOperation=s,h.restore()}new Clipboard(".score-table tbody tr");new Clipboard(".copy-best-button",{text:function(t){return La()}});
