function nv(t,e){return e.forEach(function(r){r&&typeof r!="string"&&!Array.isArray(r)&&Object.keys(r).forEach(function(i){if(i!=="default"&&!(i in t)){var o=Object.getOwnPropertyDescriptor(r,i);Object.defineProperty(t,i,o.get?o:{enumerable:!0,get:function(){return r[i]}})}})}),Object.freeze(t)}var av=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},Zo={},eo={exports:{}};var er=function(t,e){(t===null||typeof t=="undefined")&&(t={});var r=Object.assign({},t);for(var i in e)e.hasOwnProperty(i)&&typeof t[i]=="undefined"&&(r[i]=e[i]);if(typeof Object.getOwnPropertySymbols=="function")for(var o=Object.getOwnPropertySymbols(e),a=0;a<o.length;a++){var h=o[a];e.propertyIsEnumerable(h)&&typeof t[i]=="undefined"&&(r[h]=e[h])}return r},wt={},hv=typeof DEBUG=="undefined"?!1:DEBUG,mv=typeof ASSERT=="undefined"?!1:ASSERT;wt.debug=function(){!hv||console.log.apply(console,arguments)};wt.assert=function(t,e,r){if(!!mv&&!t)throw r&&console.log(r),new Error(e)};var Rt={exports:{}},lv=typeof DEBUG=="undefined"?!1:DEBUG,cv=typeof ASSERT=="undefined"?!1:ASSERT,uv=wt,un=Math,Lr=Rt.exports=Object.create(un);Lr.EPSILON=1e-9;Lr.isFinite=function(t){return typeof t=="number"&&isFinite(t)&&!isNaN(t)};Lr.assert=function(t){if(!!cv&&!Lr.isFinite(t))throw lv&&uv.debug(t),new Error("Invalid Number!")};Lr.invSqrt=function(t){return 1/un.sqrt(t)};Lr.nextPowerOfTwo=function(t){return t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,t+1};Lr.isPowerOfTwo=function(t){return t>0&&(t&t-1)==0};Lr.mod=function(t,e,r){return typeof e=="undefined"?(r=1,e=0):typeof r=="undefined"&&(r=e,e=0),r>e?(t=(t-e)%(r-e),t+(t<0?r:e)):(t=(t-r)%(e-r),t+(t<=0?e:r))};Lr.clamp=function(t,e,r){return t<e?e:t>r?r:t};Lr.random=function(t,e){return typeof t=="undefined"?(e=1,t=0):typeof e=="undefined"&&(e=t,t=0),t==e?t:un.random()*(e-t)+t};var _v=typeof DEBUG=="undefined"?!1:DEBUG,H=typeof ASSERT=="undefined"?!1:ASSERT,ut=$,im=wt,Nt=Rt.exports;function $(t,e){if(!(this instanceof $))return new $(t,e);typeof t=="undefined"?(this.x=0,this.y=0):typeof t=="object"?(this.x=t.x,this.y=t.y):(this.x=t,this.y=e),H&&$.assert(this)}$.prototype._serialize=function(){return{x:this.x,y:this.y}};$._deserialize=function(t){var e=Object.create($.prototype);return e.x=t.x,e.y=t.y,e};$.zero=function(){var t=Object.create($.prototype);return t.x=0,t.y=0,t};$.neo=function(t,e){var r=Object.create($.prototype);return r.x=t,r.y=e,r};$.clone=function(t){return H&&$.assert(t),$.neo(t.x,t.y)};$.prototype.toString=function(){return JSON.stringify(this)};$.isValid=function(t){return t&&Nt.isFinite(t.x)&&Nt.isFinite(t.y)};$.assert=function(t){if(!!H&&!$.isValid(t))throw _v&&im.debug(t),new Error("Invalid Vec2!")};$.prototype.clone=function(){return $.clone(this)};$.prototype.setZero=function(){return this.x=0,this.y=0,this};$.prototype.set=function(t,e){return typeof t=="object"?(H&&$.assert(t),this.x=t.x,this.y=t.y):(H&&Nt.assert(t),H&&Nt.assert(e),this.x=t,this.y=e),this};$.prototype.wSet=function(t,e,r,i){return typeof r!="undefined"||typeof i!="undefined"?this.setCombine(t,e,r,i):this.setMul(t,e)};$.prototype.setCombine=function(t,e,r,i){H&&Nt.assert(t),H&&$.assert(e),H&&Nt.assert(r),H&&$.assert(i);var o=t*e.x+r*i.x,a=t*e.y+r*i.y;return this.x=o,this.y=a,this};$.prototype.setMul=function(t,e){H&&Nt.assert(t),H&&$.assert(e);var r=t*e.x,i=t*e.y;return this.x=r,this.y=i,this};$.prototype.add=function(t){return H&&$.assert(t),this.x+=t.x,this.y+=t.y,this};$.prototype.wAdd=function(t,e,r,i){return typeof r!="undefined"||typeof i!="undefined"?this.addCombine(t,e,r,i):this.addMul(t,e)};$.prototype.addCombine=function(t,e,r,i){H&&Nt.assert(t),H&&$.assert(e),H&&Nt.assert(r),H&&$.assert(i);var o=t*e.x+r*i.x,a=t*e.y+r*i.y;return this.x+=o,this.y+=a,this};$.prototype.addMul=function(t,e){H&&Nt.assert(t),H&&$.assert(e);var r=t*e.x,i=t*e.y;return this.x+=r,this.y+=i,this};$.prototype.wSub=function(t,e,r,i){return typeof r!="undefined"||typeof i!="undefined"?this.subCombine(t,e,r,i):this.subMul(t,e)};$.prototype.subCombine=function(t,e,r,i){H&&Nt.assert(t),H&&$.assert(e),H&&Nt.assert(r),H&&$.assert(i);var o=t*e.x+r*i.x,a=t*e.y+r*i.y;return this.x-=o,this.y-=a,this};$.prototype.subMul=function(t,e){H&&Nt.assert(t),H&&$.assert(e);var r=t*e.x,i=t*e.y;return this.x-=r,this.y-=i,this};$.prototype.sub=function(t){return H&&$.assert(t),this.x-=t.x,this.y-=t.y,this};$.prototype.mul=function(t){return H&&Nt.assert(t),this.x*=t,this.y*=t,this};$.prototype.length=function(){return $.lengthOf(this)};$.prototype.lengthSquared=function(){return $.lengthSquared(this)};$.prototype.normalize=function(){var t=this.length();if(t<Nt.EPSILON)return 0;var e=1/t;return this.x*=e,this.y*=e,t};$.lengthOf=function(t){return H&&$.assert(t),Nt.sqrt(t.x*t.x+t.y*t.y)};$.lengthSquared=function(t){return H&&$.assert(t),t.x*t.x+t.y*t.y};$.distance=function(t,e){H&&$.assert(t),H&&$.assert(e);var r=t.x-e.x,i=t.y-e.y;return Nt.sqrt(r*r+i*i)};$.distanceSquared=function(t,e){H&&$.assert(t),H&&$.assert(e);var r=t.x-e.x,i=t.y-e.y;return r*r+i*i};$.areEqual=function(t,e){return H&&$.assert(t),H&&$.assert(e),t==e||typeof e=="object"&&e!==null&&t.x===e.x&&t.y===e.y};$.skew=function(t){return H&&$.assert(t),$.neo(-t.y,t.x)};$.dot=function(t,e){return H&&$.assert(t),H&&$.assert(e),t.x*e.x+t.y*e.y};$.cross=function(t,e){return typeof e=="number"?(H&&$.assert(t),H&&Nt.assert(e),$.neo(e*t.y,-e*t.x)):typeof t=="number"?(H&&Nt.assert(t),H&&$.assert(e),$.neo(-t*e.y,t*e.x)):(H&&$.assert(t),H&&$.assert(e),t.x*e.y-t.y*e.x)};$.addCross=function(t,e,r){if(typeof r=="number")return H&&$.assert(e),H&&Nt.assert(r),$.neo(r*e.y+t.x,-r*e.x+t.y);if(typeof e=="number")return H&&Nt.assert(e),H&&$.assert(r),$.neo(-e*r.y+t.x,e*r.x+t.y);H&&im.assert(!1)};$.add=function(t,e){return H&&$.assert(t),H&&$.assert(e),$.neo(t.x+e.x,t.y+e.y)};$.wAdd=function(t,e,r,i){return typeof r!="undefined"||typeof i!="undefined"?$.combine(t,e,r,i):$.mul(t,e)};$.combine=function(t,e,r,i){return $.zero().setCombine(t,e,r,i)};$.sub=function(t,e){return H&&$.assert(t),H&&$.assert(e),$.neo(t.x-e.x,t.y-e.y)};$.mul=function(t,e){if(typeof t=="object")return H&&$.assert(t),H&&Nt.assert(e),$.neo(t.x*e,t.y*e);if(typeof e=="object")return H&&Nt.assert(t),H&&$.assert(e),$.neo(t*e.x,t*e.y)};$.prototype.neg=function(){return this.x=-this.x,this.y=-this.y,this};$.neg=function(t){return H&&$.assert(t),$.neo(-t.x,-t.y)};$.abs=function(t){return H&&$.assert(t),$.neo(Nt.abs(t.x),Nt.abs(t.y))};$.mid=function(t,e){return H&&$.assert(t),H&&$.assert(e),$.neo((t.x+e.x)*.5,(t.y+e.y)*.5)};$.upper=function(t,e){return H&&$.assert(t),H&&$.assert(e),$.neo(Nt.max(t.x,e.x),Nt.max(t.y,e.y))};$.lower=function(t,e){return H&&$.assert(t),H&&$.assert(e),$.neo(Nt.min(t.x,e.x),Nt.min(t.y,e.y))};$.prototype.clamp=function(t){var e=this.x*this.x+this.y*this.y;if(e>t*t){var r=Nt.invSqrt(e);this.x*=r*t,this.y*=r*t}return this};$.clamp=function(t,e){return t=$.neo(t.x,t.y),t.clamp(e),t};$.scaleFn=function(t,e){return function(r){return $.neo(r.x*t,r.y*e)}};$.translateFn=function(t,e){return function(r){return $.neo(r.x+t,r.y+e)}};var Ae={};(function(t){typeof DEBUG=="undefined"||DEBUG,typeof ASSERT=="undefined"||ASSERT;var e=t;e.maxManifoldPoints=2,e.maxPolygonVertices=12,e.aabbExtension=.1,e.aabbMultiplier=2,e.linearSlop=.005,e.linearSlopSquared=e.linearSlop*e.linearSlop,e.angularSlop=2/180*Math.PI,e.polygonRadius=2*e.linearSlop,e.maxSubSteps=8,e.maxTOIContacts=32,e.maxTOIIterations=20,e.maxDistnceIterations=20,e.velocityThreshold=1,e.maxLinearCorrection=.2,e.maxAngularCorrection=8/180*Math.PI,e.maxTranslation=2,e.maxTranslationSquared=e.maxTranslation*e.maxTranslation,e.maxRotation=.5*Math.PI,e.maxRotationSquared=e.maxRotation*e.maxRotation,e.baumgarte=.2,e.toiBaugarte=.75,e.timeToSleep=.5,e.linearSleepTolerance=.01,e.linearSleepToleranceSqr=Math.pow(e.linearSleepTolerance,2),e.angularSleepTolerance=2/180*Math.PI,e.angularSleepToleranceSqr=Math.pow(e.angularSleepTolerance,2)})(Ae);var vv=typeof DEBUG=="undefined"?!1:DEBUG,pv=typeof ASSERT=="undefined"?!1:ASSERT,fv=wt,De=Rt.exports,lr=ut,ro=ce;function ce(t,e){if(!(this instanceof ce))return new ce(t,e);this.lowerBound=lr.zero(),this.upperBound=lr.zero(),typeof t=="object"&&this.lowerBound.set(t),typeof e=="object"?this.upperBound.set(e):typeof t=="object"&&this.upperBound.set(t)}ce.prototype.isValid=function(){return ce.isValid(this)};ce.isValid=function(t){var e=lr.sub(t.upperBound,t.lowerBound),r=e.x>=0&&e.y>=0&&lr.isValid(t.lowerBound)&&lr.isValid(t.upperBound);return r};ce.assert=function(t){if(!!pv&&!ce.isValid(t))throw vv&&fv.debug(t),new Error("Invalid AABB!")};ce.prototype.getCenter=function(){return lr.neo((this.lowerBound.x+this.upperBound.x)*.5,(this.lowerBound.y+this.upperBound.y)*.5)};ce.prototype.getExtents=function(){return lr.neo((this.upperBound.x-this.lowerBound.x)*.5,(this.upperBound.y-this.lowerBound.y)*.5)};ce.prototype.getPerimeter=function(){return 2*(this.upperBound.x-this.lowerBound.x+this.upperBound.y-this.lowerBound.y)};ce.prototype.combine=function(t,e){e=e||this;var r=t.lowerBound,i=t.upperBound,o=e.lowerBound,a=e.upperBound,h=De.min(r.x,o.x),c=De.min(r.y,o.y),u=De.max(a.x,i.x),_=De.max(a.y,i.y);this.lowerBound.set(h,c),this.upperBound.set(u,_)};ce.prototype.combinePoints=function(t,e){this.lowerBound.set(De.min(t.x,e.x),De.min(t.y,e.y)),this.upperBound.set(De.max(t.x,e.x),De.max(t.y,e.y))};ce.prototype.set=function(t){this.lowerBound.set(t.lowerBound.x,t.lowerBound.y),this.upperBound.set(t.upperBound.x,t.upperBound.y)};ce.prototype.contains=function(t){var e=!0;return e=e&&this.lowerBound.x<=t.lowerBound.x,e=e&&this.lowerBound.y<=t.lowerBound.y,e=e&&t.upperBound.x<=this.upperBound.x,e=e&&t.upperBound.y<=this.upperBound.y,e};ce.prototype.extend=function(t){return ce.extend(this,t),this};ce.extend=function(t,e){t.lowerBound.x-=e,t.lowerBound.y-=e,t.upperBound.x+=e,t.upperBound.y+=e};ce.testOverlap=function(t,e){var r=e.lowerBound.x-t.upperBound.x,i=t.lowerBound.x-e.upperBound.x,o=e.lowerBound.y-t.upperBound.y,a=t.lowerBound.y-e.upperBound.y;return!(r>0||o>0||i>0||a>0)};ce.areEqual=function(t,e){return lr.areEqual(t.lowerBound,e.lowerBound)&&lr.areEqual(t.upperBound,e.upperBound)};ce.diff=function(t,e){var r=De.max(0,De.min(t.upperBound.x,e.upperBound.x)-De.max(e.lowerBound.x,t.lowerBound.x)),i=De.max(0,De.min(t.upperBound.y,e.upperBound.y)-De.max(e.lowerBound.y,t.lowerBound.y)),o=t.upperBound.x-t.lowerBound.x,a=t.upperBound.y-t.lowerBound.y,h=e.upperBound.x-e.lowerBound.x,c=e.upperBound.y-e.lowerBound.y;return o*a+h*c-r*i};ce.prototype.rayCast=function(t,e){for(var r=-1/0,i=1/0,o=e.p1,a=lr.sub(e.p2,e.p1),h=lr.abs(a),c=lr.zero(),u="x";u!==null;u=u==="x"?"y":null)if(h.x<De.EPSILON){if(o[u]<this.lowerBound[u]||this.upperBound[u]<o[u])return!1}else{var _=1/a[u],f=(this.lowerBound[u]-o[u])*_,m=(this.upperBound[u]-o[u])*_,p=-1;if(f>m){var v=f;f=m,m=v,p=1}if(f>r&&(c.setZero(),c[u]=p,r=f),i=De.min(i,m),r>i)return!1}return r<0||e.maxFraction<r?!1:(t.fraction=r,t.normal=c,!0)};ce.prototype.toString=function(){return JSON.stringify(this)};var yv=dv;function dv(t){var e=[],r=t.max||1/0,i=t.create,o=t.allocate,a=t.release,h=t.discard,c=0,u=0,_=0,f=0;this.max=function(m){return typeof m=="number"?(r=m,this):r},this.size=function(){return e.length},this.allocate=function(){var m;return e.length>0?m=e.shift():(c++,typeof i=="function"?m=i():m={}),u++,typeof o=="function"&&o(m),m},this.release=function(m){e.length<r?(_++,typeof a=="function"&&a(m),e.push(m)):(f++,typeof h=="function"&&(m=h(m)))},this.toString=function(){return" +"+c+" >"+u+" <"+_+" -"+f+" ="+e.length+"/"+r}}var Gt=typeof ASSERT=="undefined"?!1:ASSERT,qi=Ae,Jt=wt,io=yv,dr=ut,Re=Rt.exports,ze=ro,sm=ue;function om(t){this.id=t,this.aabb=new ze,this.userData=null,this.parent=null,this.child1=null,this.child2=null,this.height=-1,this.toString=function(){return this.id+": "+this.userData}}om.prototype.isLeaf=function(){return this.child1==null};function ue(){this.m_root=null,this.m_nodes={},this.m_lastProxyId=0,this.m_pool=new io({create:function(){return new om}})}ue.prototype.getUserData=function(t){var e=this.m_nodes[t];return Gt&&Jt.assert(!!e),e.userData};ue.prototype.getFatAABB=function(t){var e=this.m_nodes[t];return Gt&&Jt.assert(!!e),e.aabb};ue.prototype.allocateNode=function(){var t=this.m_pool.allocate();return t.id=++this.m_lastProxyId,t.userData=null,t.parent=null,t.child1=null,t.child2=null,t.height=-1,this.m_nodes[t.id]=t,t};ue.prototype.freeNode=function(t){this.m_pool.release(t),t.height=-1,delete this.m_nodes[t.id]};ue.prototype.createProxy=function(t,e){Gt&&Jt.assert(ze.isValid(t));var r=this.allocateNode();return r.aabb.set(t),ze.extend(r.aabb,qi.aabbExtension),r.userData=e,r.height=0,this.insertLeaf(r),r.id};ue.prototype.destroyProxy=function(t){var e=this.m_nodes[t];Gt&&Jt.assert(!!e),Gt&&Jt.assert(e.isLeaf()),this.removeLeaf(e),this.freeNode(e)};ue.prototype.moveProxy=function(t,e,r){Gt&&Jt.assert(ze.isValid(e)),Gt&&Jt.assert(!r||dr.isValid(r));var i=this.m_nodes[t];return Gt&&Jt.assert(!!i),Gt&&Jt.assert(i.isLeaf()),i.aabb.contains(e)?!1:(this.removeLeaf(i),i.aabb.set(e),e=i.aabb,ze.extend(e,qi.aabbExtension),r.x<0?e.lowerBound.x+=r.x*qi.aabbMultiplier:e.upperBound.x+=r.x*qi.aabbMultiplier,r.y<0?e.lowerBound.y+=r.y*qi.aabbMultiplier:e.upperBound.y+=r.y*qi.aabbMultiplier,this.insertLeaf(i),!0)};ue.prototype.insertLeaf=function(t){if(Gt&&Jt.assert(ze.isValid(t.aabb)),this.m_root==null){this.m_root=t,this.m_root.parent=null;return}for(var e=t.aabb,r=this.m_root;r.isLeaf()==!1;){var i=r.child1,o=r.child2,a=r.aabb.getPerimeter(),h=new ze;h.combine(r.aabb,e);var c=h.getPerimeter(),u=2*c,_=2*(c-a),f;if(i.isLeaf()){var m=new ze;m.combine(e,i.aabb),f=m.getPerimeter()+_}else{var m=new ze;m.combine(e,i.aabb);var p=i.aabb.getPerimeter(),v=m.getPerimeter();f=v-p+_}var g;if(o.isLeaf()){var m=new ze;m.combine(e,o.aabb),g=m.getPerimeter()+_}else{var m=new ze;m.combine(e,o.aabb);var p=o.aabb.getPerimeter(),v=m.getPerimeter();g=v-p+_}if(u<f&&u<g)break;f<g?r=i:r=o}var y=r,w=y.parent,b=this.allocateNode();for(b.parent=w,b.userData=null,b.aabb.combine(e,y.aabb),b.height=y.height+1,w!=null?(w.child1==y?w.child1=b:w.child2=b,b.child1=y,b.child2=t,y.parent=b,t.parent=b):(b.child1=y,b.child2=t,y.parent=b,t.parent=b,this.m_root=b),r=t.parent;r!=null;){r=this.balance(r);var i=r.child1,o=r.child2;Gt&&Jt.assert(i!=null),Gt&&Jt.assert(o!=null),r.height=1+Re.max(i.height,o.height),r.aabb.combine(i.aabb,o.aabb),r=r.parent}};ue.prototype.removeLeaf=function(t){if(t==this.m_root){this.m_root=null;return}var e=t.parent,r=e.parent,i;if(e.child1==t?i=e.child2:i=e.child1,r!=null){r.child1==e?r.child1=i:r.child2=i,i.parent=r,this.freeNode(e);for(var o=r;o!=null;){o=this.balance(o);var a=o.child1,h=o.child2;o.aabb.combine(a.aabb,h.aabb),o.height=1+Re.max(a.height,h.height),o=o.parent}}else this.m_root=i,i.parent=null,this.freeNode(e)};ue.prototype.balance=function(t){Gt&&Jt.assert(t!=null);var e=t;if(e.isLeaf()||e.height<2)return t;var r=e.child1,i=e.child2,o=i.height-r.height;if(o>1){var a=i.child1,h=i.child2;return i.child1=e,i.parent=e.parent,e.parent=i,i.parent!=null?i.parent.child1==t?i.parent.child1=i:i.parent.child2=i:this.m_root=i,a.height>h.height?(i.child2=a,e.child2=h,h.parent=e,e.aabb.combine(r.aabb,h.aabb),i.aabb.combine(e.aabb,a.aabb),e.height=1+Re.max(r.height,h.height),i.height=1+Re.max(e.height,a.height)):(i.child2=h,e.child2=a,a.parent=e,e.aabb.combine(r.aabb,a.aabb),i.aabb.combine(e.aabb,h.aabb),e.height=1+Re.max(r.height,a.height),i.height=1+Re.max(e.height,h.height)),i}if(o<-1){var c=r.child1,u=r.child2;return r.child1=e,r.parent=e.parent,e.parent=r,r.parent!=null?r.parent.child1==e?r.parent.child1=r:r.parent.child2=r:this.m_root=r,c.height>u.height?(r.child2=c,e.child1=u,u.parent=e,e.aabb.combine(i.aabb,u.aabb),r.aabb.combine(e.aabb,c.aabb),e.height=1+Re.max(i.height,u.height),r.height=1+Re.max(e.height,c.height)):(r.child2=u,e.child1=c,c.parent=e,e.aabb.combine(i.aabb,c.aabb),r.aabb.combine(e.aabb,u.aabb),e.height=1+Re.max(i.height,c.height),r.height=1+Re.max(e.height,u.height)),r}return e};ue.prototype.getHeight=function(){return this.m_root==null?0:this.m_root.height};ue.prototype.getAreaRatio=function(){if(this.m_root==null)return 0;for(var t=this.m_root,e=t.aabb.getPerimeter(),r=0,i,o=li.allocate().preorder(this.m_root);i=o.next();)i.height<0||(r+=i.aabb.getPerimeter());return li.release(o),r/e};ue.prototype.computeHeight=function(t){var e;if(typeof t!="undefined"?e=this.m_nodes[t]:e=this.m_root,e.isLeaf())return 0;var r=this.computeHeight(e.child1.id),i=this.computeHeight(e.child2.id);return 1+Re.max(r,i)};ue.prototype.validateStructure=function(t){if(t!=null){t==this.m_root&&Gt&&Jt.assert(t.parent==null);var e=t.child1,r=t.child2;if(t.isLeaf()){Gt&&Jt.assert(e==null),Gt&&Jt.assert(r==null),Gt&&Jt.assert(t.height==0);return}Gt&&Jt.assert(e.parent==t),Gt&&Jt.assert(r.parent==t),this.validateStructure(e),this.validateStructure(r)}};ue.prototype.validateMetrics=function(t){if(t!=null){var e=t.child1,r=t.child2;if(t.isLeaf()){Gt&&Jt.assert(e==null),Gt&&Jt.assert(r==null),Gt&&Jt.assert(t.height==0);return}var i=e.height,o=r.height,a=1+Re.max(i,o);Gt&&Jt.assert(t.height==a);var h=new ze;h.combine(e.aabb,r.aabb),Gt&&Jt.assert(ze.areEqual(h,t.aabb)),this.validateMetrics(e),this.validateMetrics(r)}};ue.prototype.validate=function(){this.validateStructure(this.m_root),this.validateMetrics(this.m_root),Gt&&Jt.assert(this.getHeight()==this.computeHeight())};ue.prototype.getMaxBalance=function(){for(var t=0,e,r=li.allocate().preorder(this.m_root);e=r.next();)if(!(e.height<=1)){Gt&&Jt.assert(e.isLeaf()==!1);var i=Re.abs(e.child2.height-e.child1.height);t=Re.max(t,i)}return li.release(r),t};ue.prototype.rebuildBottomUp=function(){for(var t=[],e=0,r,i=li.allocate().preorder(this.m_root);r=i.next();)r.height<0||(r.isLeaf()?(r.parent=null,t[e]=r,++e):this.freeNode(r));for(li.release(i);e>1;){for(var o=1/0,a=-1,h=-1,c=0;c<e;++c)for(var u=t[c].aabb,_=c+1;_<e;++_){var f=t[_].aabb,m=new ze;m.combine(u,f);var p=m.getPerimeter();p<o&&(a=c,h=_,o=p)}var v=t[a],g=t[h],y=this.allocateNode();y.child1=v,y.child2=g,y.height=1+Re.max(v.height,g.height),y.aabb.combine(v.aabb,g.aabb),y.parent=null,v.parent=y,g.parent=y,t[h]=t[e-1],t[a]=y,--e}this.m_root=t[0],this.validate()};ue.prototype.shiftOrigin=function(t){for(var e,r=li.allocate().preorder(this.m_root);e=r.next();){var i=e.aabb;i.lowerBound.x-=t.x,i.lowerBound.y-=t.y,i.upperBound.x-=t.x,i.upperBound.y-=t.y}li.release(r)};ue.prototype.query=function(t,e){Gt&&Jt.assert(typeof e=="function");var r=Ds.allocate();for(r.push(this.m_root);r.length>0;){var i=r.pop();if(i!=null&&ze.testOverlap(i.aabb,t))if(i.isLeaf()){var o=e(i.id);if(o==!1)return}else r.push(i.child1),r.push(i.child2)}Ds.release(r)};ue.prototype.rayCast=function(t,e){Gt&&Jt.assert(typeof e=="function");var r=t.p1,i=t.p2,o=dr.sub(i,r);Gt&&Jt.assert(o.lengthSquared()>0),o.normalize();var a=dr.cross(1,o),h=dr.abs(a),c=t.maxFraction,u=new ze,_=dr.combine(1-c,r,c,i);u.combinePoints(r,_);var f=Ds.allocate(),m=bh.allocate();for(f.push(this.m_root);f.length>0;){var p=f.pop();if(p!=null&&ze.testOverlap(p.aabb,u)!=!1){var v=p.aabb.getCenter(),g=p.aabb.getExtents(),y=Re.abs(dr.dot(a,dr.sub(r,v)))-dr.dot(h,g);if(!(y>0))if(p.isLeaf()){m.p1=dr.clone(t.p1),m.p2=dr.clone(t.p2),m.maxFraction=c;var w=e(m,p.id);if(w==0)return;w>0&&(c=w,_=dr.combine(1-c,r,c,i),u.combinePoints(r,_))}else f.push(p.child1),f.push(p.child2)}}Ds.release(f),bh.release(m)};var bh=new io({create:function(){return{}},release:function(t){}}),Ds=new io({create:function(){return[]},release:function(t){t.length=0}}),li=new io({create:function(){return new gv},release:function(t){t.close()}});function gv(){var t=[],e=[];return{preorder:function(r){return t.length=0,t.push(r),e.length=0,e.push(0),this},next:function(){for(;t.length>0;){var r=t.length-1,i=t[r];if(e[r]===0)return e[r]=1,i;if(e[r]===1&&(e[r]=2,i.child1))return t.push(i.child1),e.push(1),i.child1;if(e[r]===2&&(e[r]=3,i.child2))return t.push(i.child2),e.push(1),i.child2;t.pop(),e.pop()}},close:function(){t.length=0}}}var _n=typeof ASSERT=="undefined"?!1:ASSERT,vn=wt,xh=Rt.exports,pn=ro,Av=sm,bv=Se;function Se(){this.m_tree=new Av,this.m_proxyCount=0,this.m_moveBuffer=[],this.queryCallback=this.queryCallback.bind(this)}Se.prototype.getUserData=function(t){return this.m_tree.getUserData(t)};Se.prototype.testOverlap=function(t,e){var r=this.m_tree.getFatAABB(t),i=this.m_tree.getFatAABB(e);return pn.testOverlap(r,i)};Se.prototype.getFatAABB=function(t){return this.m_tree.getFatAABB(t)};Se.prototype.getProxyCount=function(){return this.m_proxyCount};Se.prototype.getTreeHeight=function(){return this.m_tree.getHeight()};Se.prototype.getTreeBalance=function(){return this.m_tree.getMaxBalance()};Se.prototype.getTreeQuality=function(){return this.m_tree.getAreaRatio()};Se.prototype.query=function(t,e){this.m_tree.query(t,e)};Se.prototype.rayCast=function(t,e){this.m_tree.rayCast(t,e)};Se.prototype.shiftOrigin=function(t){this.m_tree.shiftOrigin(t)};Se.prototype.createProxy=function(t,e){_n&&vn.assert(pn.isValid(t));var r=this.m_tree.createProxy(t,e);return this.m_proxyCount++,this.bufferMove(r),r};Se.prototype.destroyProxy=function(t){this.unbufferMove(t),this.m_proxyCount--,this.m_tree.destroyProxy(t)};Se.prototype.moveProxy=function(t,e,r){_n&&vn.assert(pn.isValid(e));var i=this.m_tree.moveProxy(t,e,r);i&&this.bufferMove(t)};Se.prototype.touchProxy=function(t){this.bufferMove(t)};Se.prototype.bufferMove=function(t){this.m_moveBuffer.push(t)};Se.prototype.unbufferMove=function(t){for(var e=0;e<this.m_moveBuffer.length;++e)this.m_moveBuffer[e]==t&&(this.m_moveBuffer[e]=null)};Se.prototype.updatePairs=function(t){for(_n&&vn.assert(typeof t=="function"),this.m_callback=t;this.m_moveBuffer.length>0;)if(this.m_queryProxyId=this.m_moveBuffer.pop(),this.m_queryProxyId!==null){var e=this.m_tree.getFatAABB(this.m_queryProxyId);this.m_tree.query(e,this.queryCallback)}};Se.prototype.queryCallback=function(t){if(t==this.m_queryProxyId)return!0;var e=xh.min(t,this.m_queryProxyId),r=xh.max(t,this.m_queryProxyId),i=this.m_tree.getUserData(e),o=this.m_tree.getUserData(r);return this.m_callback(i,o),!0};var fn={exports:{}},xv=typeof DEBUG=="undefined"?!1:DEBUG,Ne=typeof ASSERT=="undefined"?!1:ASSERT,ae=ft,Bv=wt,wr=ut,Ur=Rt.exports;function ft(t){if(!(this instanceof ft))return new ft(t);typeof t=="number"?this.setAngle(t):typeof t=="object"?this.set(t):this.setIdentity()}ft.neo=function(t){var e=Object.create(ft.prototype);return e.setAngle(t),e};ft.clone=function(t){Ne&&ft.assert(t);var e=Object.create(ft.prototype);return e.s=t.s,e.c=t.c,e};ft.identity=function(){var t=Object.create(ft.prototype);return t.s=0,t.c=1,t};ft.isValid=function(t){return t&&Ur.isFinite(t.s)&&Ur.isFinite(t.c)};ft.assert=function(t){if(!!Ne&&!ft.isValid(t))throw xv&&Bv.debug(t),new Error("Invalid Rot!")};ft.prototype.setIdentity=function(){this.s=0,this.c=1};ft.prototype.set=function(t){typeof t=="object"?(Ne&&ft.assert(t),this.s=t.s,this.c=t.c):(Ne&&Ur.assert(t),this.s=Ur.sin(t),this.c=Ur.cos(t))};ft.prototype.setAngle=function(t){Ne&&Ur.assert(t),this.s=Ur.sin(t),this.c=Ur.cos(t)};ft.prototype.getAngle=function(){return Ur.atan2(this.s,this.c)};ft.prototype.getXAxis=function(){return wr.neo(this.c,this.s)};ft.prototype.getYAxis=function(){return wr.neo(-this.s,this.c)};ft.mul=function(t,e){if(Ne&&ft.assert(t),"c"in e&&"s"in e){Ne&&ft.assert(e);var r=ft.identity();return r.s=t.s*e.c+t.c*e.s,r.c=t.c*e.c-t.s*e.s,r}else if("x"in e&&"y"in e)return Ne&&wr.assert(e),wr.neo(t.c*e.x-t.s*e.y,t.s*e.x+t.c*e.y)};ft.mulRot=function(t,e){Ne&&ft.assert(t),Ne&&ft.assert(e);var r=ft.identity();return r.s=t.s*e.c+t.c*e.s,r.c=t.c*e.c-t.s*e.s,r};ft.mulVec2=function(t,e){return Ne&&ft.assert(t),Ne&&wr.assert(e),wr.neo(t.c*e.x-t.s*e.y,t.s*e.x+t.c*e.y)};ft.mulSub=function(t,e,r){var i=t.c*(e.x-r.x)-t.s*(e.y-r.y),o=t.s*(e.x-r.x)+t.c*(e.y-r.y);return wr.neo(i,o)};ft.mulT=function(t,e){if("c"in e&&"s"in e){Ne&&ft.assert(e);var r=ft.identity();return r.s=t.c*e.s-t.s*e.c,r.c=t.c*e.c+t.s*e.s,r}else if("x"in e&&"y"in e)return Ne&&wr.assert(e),wr.neo(t.c*e.x+t.s*e.y,-t.s*e.x+t.c*e.y)};ft.mulTRot=function(t,e){Ne&&ft.assert(e);var r=ft.identity();return r.s=t.c*e.s-t.s*e.c,r.c=t.c*e.c+t.s*e.s,r};ft.mulTVec2=function(t,e){return Ne&&wr.assert(e),wr.neo(t.c*e.x+t.s*e.y,-t.s*e.x+t.c*e.y)};var wv=typeof DEBUG=="undefined"?!1:DEBUG,ke=typeof ASSERT=="undefined"?!1:ASSERT,Ge=nt,Sv=wt,Fe=ut,or=ae;function nt(t,e){if(!(this instanceof nt))return new nt(t,e);this.p=Fe.zero(),this.q=or.identity(),typeof t!="undefined"&&this.p.set(t),typeof e!="undefined"&&this.q.set(e)}nt.clone=function(t){var e=Object.create(nt.prototype);return e.p=Fe.clone(t.p),e.q=or.clone(t.q),e};nt.neo=function(t,e){var r=Object.create(nt.prototype);return r.p=Fe.clone(t),r.q=or.clone(e),r};nt.identity=function(){var t=Object.create(nt.prototype);return t.p=Fe.zero(),t.q=or.identity(),t};nt.prototype.setIdentity=function(){this.p.setZero(),this.q.setIdentity()};nt.prototype.set=function(t,e){typeof e=="undefined"?(this.p.set(t.p),this.q.set(t.q)):(this.p.set(t),this.q.set(e))};nt.isValid=function(t){return t&&Fe.isValid(t.p)&&or.isValid(t.q)};nt.assert=function(t){if(!!ke&&!nt.isValid(t))throw wv&&Sv.debug(t),new Error("Invalid Transform!")};nt.mul=function(t,e){if(ke&&nt.assert(t),Array.isArray(e)){for(var r=[],i=0;i<e.length;i++)r[i]=nt.mul(t,e[i]);return r}else if("x"in e&&"y"in e){ke&&Fe.assert(e);var o=t.q.c*e.x-t.q.s*e.y+t.p.x,a=t.q.s*e.x+t.q.c*e.y+t.p.y;return Fe.neo(o,a)}else if("p"in e&&"q"in e){ke&&nt.assert(e);var h=nt.identity();return h.q=or.mulRot(t.q,e.q),h.p=Fe.add(or.mulVec2(t.q,e.p),t.p),h}};nt.mulAll=function(t,e){ke&&nt.assert(t);for(var r=[],i=0;i<e.length;i++)r[i]=nt.mul(t,e[i]);return r};nt.mulFn=function(t){return ke&&nt.assert(t),function(e){return nt.mul(t,e)}};nt.mulVec2=function(t,e){ke&&nt.assert(t),ke&&Fe.assert(e);var r=t.q.c*e.x-t.q.s*e.y+t.p.x,i=t.q.s*e.x+t.q.c*e.y+t.p.y;return Fe.neo(r,i)};nt.mulXf=function(t,e){ke&&nt.assert(t),ke&&nt.assert(e);var r=nt.identity();return r.q=or.mulRot(t.q,e.q),r.p=Fe.add(or.mulVec2(t.q,e.p),t.p),r};nt.mulT=function(t,e){if(ke&&nt.assert(t),"x"in e&&"y"in e){ke&&Fe.assert(e);var r=e.x-t.p.x,i=e.y-t.p.y,o=t.q.c*r+t.q.s*i,a=-t.q.s*r+t.q.c*i;return Fe.neo(o,a)}else if("p"in e&&"q"in e){ke&&nt.assert(e);var h=nt.identity();return h.q.set(or.mulTRot(t.q,e.q)),h.p.set(or.mulTVec2(t.q,Fe.sub(e.p,t.p))),h}};nt.mulTVec2=function(t,e){ke&&nt.assert(t),ke&&Fe.assert(e);var r=e.x-t.p.x,i=e.y-t.p.y,o=t.q.c*r+t.q.s*i,a=-t.q.s*r+t.q.c*i;return Fe.neo(o,a)};nt.mulTXf=function(t,e){ke&&nt.assert(t),ke&&nt.assert(e);var r=nt.identity();return r.q.set(or.mulTRot(t.q,e.q)),r.p.set(or.mulTVec2(t.q,Fe.sub(e.p,t.p))),r};var Xo=typeof ASSERT=="undefined"?!1:ASSERT,yn=kr,Ko=wt,Jo=Rt.exports,Uo=ut,Cv=ae,nm=Ge;function kr(t,e){Xo&&Ko.assert(typeof t=="undefined"),Xo&&Ko.assert(typeof e=="undefined"),this.localCenter=Uo.zero(),this.c=Uo.zero(),this.a=0,this.alpha0=0,this.c0=Uo.zero(),this.a0=0}kr.prototype.setTransform=function(t){var e=nm.mulVec2(t,this.localCenter);this.c.set(e),this.c0.set(e),this.a=t.q.getAngle(),this.a0=t.q.getAngle()};kr.prototype.setLocalCenter=function(t,e){this.localCenter.set(t);var r=nm.mulVec2(e,this.localCenter);this.c.set(r),this.c0.set(r)};kr.prototype.getTransform=function(t,e){e=typeof e=="undefined"?0:e,t.q.setAngle((1-e)*this.a0+e*this.a),t.p.setCombine(1-e,this.c0,e,this.c),t.p.sub(Cv.mulVec2(t.q,this.localCenter))};kr.prototype.advance=function(t){Xo&&Ko.assert(this.alpha0<1);var e=(t-this.alpha0)/(1-this.alpha0);this.c0.setCombine(e,this.c,1-e,this.c0),this.a0=e*this.a+(1-e)*this.a0,this.alpha0=t};kr.prototype.forward=function(){this.a0=this.a,this.c0.set(this.c)};kr.prototype.normalize=function(){var t=Jo.mod(this.a0,-Jo.PI,+Jo.PI);this.a-=this.a0-t,this.a0=t};kr.prototype.clone=function(){var t=new kr;return t.localCenter.set(this.localCenter),t.alpha0=this.alpha0,t.a0=this.a0,t.a=this.a,t.c0.set(this.c0),t.c.set(this.c),t};kr.prototype.set=function(t){this.localCenter.set(t.localCenter),this.alpha0=t.alpha0,this.a0=t.a0,this.a=t.a,this.c0.set(t.c0),this.c.set(t.c)};var Mv=Iv,Tv=ut;function Iv(){this.v=Tv.zero(),this.w=0}var $v=hm,am=ut,Ev=ae;function hm(){this.c=am.zero(),this.a=0}hm.prototype.getTransform=function(t,e){return t.q.set(this.a),t.p.set(am.sub(this.c,Ev.mulVec2(t.q,e))),t};var wi=Oe;function Oe(){this.m_type,this.m_radius}Oe.prototype._reset=function(){};Oe.prototype._serialize=function(){return{}};Oe.TYPES={};Oe._deserialize=function(t,e,r){var i=Oe.TYPES[t.type];return i&&r(i,t)};Oe.isValid=function(t){return!!t};Oe.prototype.getRadius=function(){return this.m_radius};Oe.prototype.getType=function(){return this.m_type};Oe.prototype._clone=function(){};Oe.prototype.getChildCount=function(){};Oe.prototype.testPoint=function(t,e){};Oe.prototype.rayCast=function(t,e,r,i){};Oe.prototype.computeAABB=function(t,e,r){};Oe.prototype.computeMass=function(t,e){};Oe.prototype.computeDistanceProxy=function(t){};var dn=typeof ASSERT=="undefined"?!1:ASSERT,gn=Tt,An=wt,Pv=er,Vv=Rt.exports,zv=ut,Qo=ro,Lv=wi,kv={userData:null,friction:.2,restitution:0,density:0,isSensor:!1,filterGroupIndex:0,filterCategoryBits:1,filterMaskBits:65535};function mm(t,e){this.aabb=new Qo,this.fixture=t,this.childIndex=e,this.proxyId}function Tt(t,e,r){e.shape?(r=e,e=e.shape):typeof r=="number"&&(r={density:r}),r=Pv(r,kv),this.m_body=t,this.m_friction=r.friction,this.m_restitution=r.restitution,this.m_density=r.density,this.m_isSensor=r.isSensor,this.m_filterGroupIndex=r.filterGroupIndex,this.m_filterCategoryBits=r.filterCategoryBits,this.m_filterMaskBits=r.filterMaskBits,this.m_shape=e,this.m_next=null,this.m_proxies=[],this.m_proxyCount=0;for(var i=this.m_shape.getChildCount(),o=0;o<i;++o)this.m_proxies[o]=new mm(this,o);this.m_userData=r.userData}Tt.prototype._reset=function(){var t=this.getBody(),e=t.m_world.m_broadPhase;this.destroyProxies(e),this.m_shape._reset&&this.m_shape._reset();for(var r=this.m_shape.getChildCount(),i=0;i<r;++i)this.m_proxies[i]=new mm(this,i);this.createProxies(e,t.m_xf),t.resetMassData()};Tt.prototype._serialize=function(){return{friction:this.m_friction,restitution:this.m_restitution,density:this.m_density,isSensor:this.m_isSensor,filterGroupIndex:this.m_filterGroupIndex,filterCategoryBits:this.m_filterCategoryBits,filterMaskBits:this.m_filterMaskBits,shape:this.m_shape}};Tt._deserialize=function(t,e,r){var i=r(Lv,t.shape),o=i&&new Tt(e,i,t);return o};Tt.prototype.getType=function(){return this.m_shape.getType()};Tt.prototype.getShape=function(){return this.m_shape};Tt.prototype.isSensor=function(){return this.m_isSensor};Tt.prototype.setSensor=function(t){t!=this.m_isSensor&&(this.m_body.setAwake(!0),this.m_isSensor=t)};Tt.prototype.getUserData=function(){return this.m_userData};Tt.prototype.setUserData=function(t){this.m_userData=t};Tt.prototype.getBody=function(){return this.m_body};Tt.prototype.getNext=function(){return this.m_next};Tt.prototype.getDensity=function(){return this.m_density};Tt.prototype.setDensity=function(t){dn&&An.assert(Vv.isFinite(t)&&t>=0),this.m_density=t};Tt.prototype.getFriction=function(){return this.m_friction};Tt.prototype.setFriction=function(t){this.m_friction=t};Tt.prototype.getRestitution=function(){return this.m_restitution};Tt.prototype.setRestitution=function(t){this.m_restitution=t};Tt.prototype.testPoint=function(t){return this.m_shape.testPoint(this.m_body.getTransform(),t)};Tt.prototype.rayCast=function(t,e,r){return this.m_shape.rayCast(t,e,this.m_body.getTransform(),r)};Tt.prototype.getMassData=function(t){this.m_shape.computeMass(t,this.m_density)};Tt.prototype.getAABB=function(t){return dn&&An.assert(0<=t&&t<this.m_proxyCount),this.m_proxies[t].aabb};Tt.prototype.createProxies=function(t,e){dn&&An.assert(this.m_proxyCount==0),this.m_proxyCount=this.m_shape.getChildCount();for(var r=0;r<this.m_proxyCount;++r){var i=this.m_proxies[r];this.m_shape.computeAABB(i.aabb,e,r),i.proxyId=t.createProxy(i.aabb,i)}};Tt.prototype.destroyProxies=function(t){for(var e=0;e<this.m_proxyCount;++e){var r=this.m_proxies[e];t.destroyProxy(r.proxyId),r.proxyId=null}this.m_proxyCount=0};Tt.prototype.synchronize=function(t,e,r){for(var i=0;i<this.m_proxyCount;++i){var o=this.m_proxies[i],a=new Qo,h=new Qo;this.m_shape.computeAABB(a,e,o.childIndex),this.m_shape.computeAABB(h,r,o.childIndex),o.aabb.combine(a,h);var c=zv.sub(r.p,e.p);t.moveProxy(o.proxyId,o.aabb,c)}};Tt.prototype.setFilterData=function(t){this.m_filterGroupIndex=t.groupIndex,this.m_filterCategoryBits=t.categoryBits,this.m_filterMaskBits=t.maskBits,this.refilter()};Tt.prototype.getFilterGroupIndex=function(){return this.m_filterGroupIndex};Tt.prototype.setFilterGroupIndex=function(t){return this.m_filterGroupIndex=t};Tt.prototype.getFilterCategoryBits=function(){return this.m_filterCategoryBits};Tt.prototype.setFilterCategoryBits=function(t){this.m_filterCategoryBits=t};Tt.prototype.getFilterMaskBits=function(){return this.m_filterMaskBits};Tt.prototype.setFilterMaskBits=function(t){this.m_filterMaskBits=t};Tt.prototype.refilter=function(){if(this.m_body!=null){for(var t=this.m_body.getContactList();t;){var e=t.contact,r=e.getFixtureA(),i=e.getFixtureB();(r==this||i==this)&&e.flagForFiltering(),t=t.next}var o=this.m_body.getWorld();if(o!=null)for(var a=o.m_broadPhase,h=0;h<this.m_proxyCount;++h)a.touchProxy(this.m_proxies[h].proxyId)}};Tt.prototype.shouldCollide=function(t){if(t.m_filterGroupIndex===this.m_filterGroupIndex&&t.m_filterGroupIndex!==0)return t.m_filterGroupIndex>0;var e=(t.m_filterMaskBits&this.m_filterCategoryBits)!==0,r=(t.m_filterCategoryBits&this.m_filterMaskBits)!==0,i=e&&r;return i};var xe=typeof ASSERT=="undefined"?!1:ASSERT,Ze=G,Be=wt,Fv=er,re=ut,lm=ae,Is=Rt.exports,Rv=yn,so=Ge,qv=Mv,Dv=$v,cm=gn,xi=G.STATIC="static",bn=G.KINEMATIC="kinematic",_r=G.DYNAMIC="dynamic",Nv={type:xi,position:re.zero(),angle:0,linearVelocity:re.zero(),angularVelocity:0,linearDamping:0,angularDamping:0,fixedRotation:!1,bullet:!1,gravityScale:1,allowSleep:!0,awake:!0,active:!0,userData:null};function G(t,e){e=Fv(e,Nv),xe&&Be.assert(re.isValid(e.position)),xe&&Be.assert(re.isValid(e.linearVelocity)),xe&&Be.assert(Is.isFinite(e.angle)),xe&&Be.assert(Is.isFinite(e.angularVelocity)),xe&&Be.assert(Is.isFinite(e.angularDamping)&&e.angularDamping>=0),xe&&Be.assert(Is.isFinite(e.linearDamping)&&e.linearDamping>=0),this.m_world=t,this.m_awakeFlag=e.awake,this.m_autoSleepFlag=e.allowSleep,this.m_bulletFlag=e.bullet,this.m_fixedRotationFlag=e.fixedRotation,this.m_activeFlag=e.active,this.m_islandFlag=!1,this.m_toiFlag=!1,this.m_userData=e.userData,this.m_type=e.type,this.m_type==_r?(this.m_mass=1,this.m_invMass=1):(this.m_mass=0,this.m_invMass=0),this.m_I=0,this.m_invI=0,this.m_xf=so.identity(),this.m_xf.p=re.clone(e.position),this.m_xf.q.setAngle(e.angle),this.m_sweep=new Rv,this.m_sweep.setTransform(this.m_xf),this.c_velocity=new qv,this.c_position=new Dv,this.m_force=re.zero(),this.m_torque=0,this.m_linearVelocity=re.clone(e.linearVelocity),this.m_angularVelocity=e.angularVelocity,this.m_linearDamping=e.linearDamping,this.m_angularDamping=e.angularDamping,this.m_gravityScale=e.gravityScale,this.m_sleepTime=0,this.m_jointList=null,this.m_contactList=null,this.m_fixtureList=null,this.m_prev=null,this.m_next=null,this.m_destroyed=!1}G.prototype._serialize=function(){for(var t=[],e=this.m_fixtureList;e;e=e.m_next)t.push(e);return{type:this.m_type,bullet:this.m_bulletFlag,position:this.m_xf.p,angle:this.m_xf.q.getAngle(),linearVelocity:this.m_linearVelocity,angularVelocity:this.m_angularVelocity,fixtures:t}};G._deserialize=function(t,e,r){var i=new G(e,t);if(t.fixtures)for(var o=t.fixtures.length-1;o>=0;o--){var a=r(cm,t.fixtures[o],i);i._addFixture(a)}return i};G.prototype.isWorldLocked=function(){return!!(this.m_world&&this.m_world.isLocked())};G.prototype.getWorld=function(){return this.m_world};G.prototype.getNext=function(){return this.m_next};G.prototype.setUserData=function(t){this.m_userData=t};G.prototype.getUserData=function(){return this.m_userData};G.prototype.getFixtureList=function(){return this.m_fixtureList};G.prototype.getJointList=function(){return this.m_jointList};G.prototype.getContactList=function(){return this.m_contactList};G.prototype.isStatic=function(){return this.m_type==xi};G.prototype.isDynamic=function(){return this.m_type==_r};G.prototype.isKinematic=function(){return this.m_type==bn};G.prototype.setStatic=function(){return this.setType(xi),this};G.prototype.setDynamic=function(){return this.setType(_r),this};G.prototype.setKinematic=function(){return this.setType(bn),this};G.prototype.getType=function(){return this.m_type};G.prototype.setType=function(t){if(xe&&Be.assert(t===xi||t===bn||t===_r),xe&&Be.assert(this.isWorldLocked()==!1),this.isWorldLocked()!=!0&&this.m_type!=t){this.m_type=t,this.resetMassData(),this.m_type==xi&&(this.m_linearVelocity.setZero(),this.m_angularVelocity=0,this.m_sweep.forward(),this.synchronizeFixtures()),this.setAwake(!0),this.m_force.setZero(),this.m_torque=0;for(var e=this.m_contactList;e;){var r=e;e=e.next,this.m_world.destroyContact(r.contact)}this.m_contactList=null;for(var i=this.m_world.m_broadPhase,o=this.m_fixtureList;o;o=o.m_next)for(var a=o.m_proxyCount,h=0;h<a;++h)i.touchProxy(o.m_proxies[h].proxyId)}};G.prototype.isBullet=function(){return this.m_bulletFlag};G.prototype.setBullet=function(t){this.m_bulletFlag=!!t};G.prototype.isSleepingAllowed=function(){return this.m_autoSleepFlag};G.prototype.setSleepingAllowed=function(t){this.m_autoSleepFlag=!!t,this.m_autoSleepFlag==!1&&this.setAwake(!0)};G.prototype.isAwake=function(){return this.m_awakeFlag};G.prototype.setAwake=function(t){t?this.m_awakeFlag==!1&&(this.m_awakeFlag=!0,this.m_sleepTime=0):(this.m_awakeFlag=!1,this.m_sleepTime=0,this.m_linearVelocity.setZero(),this.m_angularVelocity=0,this.m_force.setZero(),this.m_torque=0)};G.prototype.isActive=function(){return this.m_activeFlag};G.prototype.setActive=function(t){if(xe&&Be.assert(this.isWorldLocked()==!1),t!=this.m_activeFlag)if(this.m_activeFlag=!!t,this.m_activeFlag)for(var e=this.m_world.m_broadPhase,r=this.m_fixtureList;r;r=r.m_next)r.createProxies(e,this.m_xf);else{for(var e=this.m_world.m_broadPhase,r=this.m_fixtureList;r;r=r.m_next)r.destroyProxies(e);for(var i=this.m_contactList;i;){var o=i;i=i.next,this.m_world.destroyContact(o.contact)}this.m_contactList=null}};G.prototype.isFixedRotation=function(){return this.m_fixedRotationFlag};G.prototype.setFixedRotation=function(t){this.m_fixedRotationFlag!=t&&(this.m_fixedRotationFlag=!!t,this.m_angularVelocity=0,this.resetMassData())};G.prototype.getTransform=function(){return this.m_xf};G.prototype.setTransform=function(t,e){if(xe&&Be.assert(this.isWorldLocked()==!1),this.isWorldLocked()!=!0){this.m_xf.set(t,e),this.m_sweep.setTransform(this.m_xf);for(var r=this.m_world.m_broadPhase,i=this.m_fixtureList;i;i=i.m_next)i.synchronize(r,this.m_xf,this.m_xf)}};G.prototype.synchronizeTransform=function(){this.m_sweep.getTransform(this.m_xf,1)};G.prototype.synchronizeFixtures=function(){var t=so.identity();this.m_sweep.getTransform(t,0);for(var e=this.m_world.m_broadPhase,r=this.m_fixtureList;r;r=r.m_next)r.synchronize(e,t,this.m_xf)};G.prototype.advance=function(t){this.m_sweep.advance(t),this.m_sweep.c.set(this.m_sweep.c0),this.m_sweep.a=this.m_sweep.a0,this.m_sweep.getTransform(this.m_xf,1)};G.prototype.getPosition=function(){return this.m_xf.p};G.prototype.setPosition=function(t){this.setTransform(t,this.m_sweep.a)};G.prototype.getAngle=function(){return this.m_sweep.a};G.prototype.setAngle=function(t){this.setTransform(this.m_xf.p,t)};G.prototype.getWorldCenter=function(){return this.m_sweep.c};G.prototype.getLocalCenter=function(){return this.m_sweep.localCenter};G.prototype.getLinearVelocity=function(){return this.m_linearVelocity};G.prototype.getLinearVelocityFromWorldPoint=function(t){var e=re.sub(t,this.m_sweep.c);return re.add(this.m_linearVelocity,re.cross(this.m_angularVelocity,e))};G.prototype.getLinearVelocityFromLocalPoint=function(t){return this.getLinearVelocityFromWorldPoint(this.getWorldPoint(t))};G.prototype.setLinearVelocity=function(t){this.m_type!=xi&&(re.dot(t,t)>0&&this.setAwake(!0),this.m_linearVelocity.set(t))};G.prototype.getAngularVelocity=function(){return this.m_angularVelocity};G.prototype.setAngularVelocity=function(t){this.m_type!=xi&&(t*t>0&&this.setAwake(!0),this.m_angularVelocity=t)};G.prototype.getLinearDamping=function(){return this.m_linearDamping};G.prototype.setLinearDamping=function(t){this.m_linearDamping=t};G.prototype.getAngularDamping=function(){return this.m_angularDamping};G.prototype.setAngularDamping=function(t){this.m_angularDamping=t};G.prototype.getGravityScale=function(){return this.m_gravityScale};G.prototype.setGravityScale=function(t){this.m_gravityScale=t};G.prototype.getMass=function(){return this.m_mass};G.prototype.getInertia=function(){return this.m_I+this.m_mass*re.dot(this.m_sweep.localCenter,this.m_sweep.localCenter)};function Ov(){this.mass=0,this.center=re.zero(),this.I=0}G.prototype.getMassData=function(t){t.mass=this.m_mass,t.I=this.getInertia(),t.center.set(this.m_sweep.localCenter)};G.prototype.resetMassData=function(){if(this.m_mass=0,this.m_invMass=0,this.m_I=0,this.m_invI=0,this.m_sweep.localCenter.setZero(),this.isStatic()||this.isKinematic()){this.m_sweep.c0.set(this.m_xf.p),this.m_sweep.c.set(this.m_xf.p),this.m_sweep.a0=this.m_sweep.a;return}xe&&Be.assert(this.isDynamic());for(var t=re.zero(),e=this.m_fixtureList;e;e=e.m_next)if(e.m_density!=0){var r=new Ov;e.getMassData(r),this.m_mass+=r.mass,t.addMul(r.mass,r.center),this.m_I+=r.I}this.m_mass>0?(this.m_invMass=1/this.m_mass,t.mul(this.m_invMass)):(this.m_mass=1,this.m_invMass=1),this.m_I>0&&this.m_fixedRotationFlag==!1?(this.m_I-=this.m_mass*re.dot(t,t),xe&&Be.assert(this.m_I>0),this.m_invI=1/this.m_I):(this.m_I=0,this.m_invI=0);var i=re.clone(this.m_sweep.c);this.m_sweep.setLocalCenter(t,this.m_xf),this.m_linearVelocity.add(re.cross(this.m_angularVelocity,re.sub(this.m_sweep.c,i)))};G.prototype.setMassData=function(t){if(xe&&Be.assert(this.isWorldLocked()==!1),this.isWorldLocked()!=!0&&this.m_type==_r){this.m_invMass=0,this.m_I=0,this.m_invI=0,this.m_mass=t.mass,this.m_mass<=0&&(this.m_mass=1),this.m_invMass=1/this.m_mass,t.I>0&&this.m_fixedRotationFlag==!1&&(this.m_I=t.I-this.m_mass*re.dot(t.center,t.center),xe&&Be.assert(this.m_I>0),this.m_invI=1/this.m_I);var e=re.clone(this.m_sweep.c);this.m_sweep.setLocalCenter(t.center,this.m_xf),this.m_linearVelocity.add(re.cross(this.m_angularVelocity,re.sub(this.m_sweep.c,e)))}};G.prototype.applyForce=function(t,e,r){this.m_type==_r&&(r&&this.m_awakeFlag==!1&&this.setAwake(!0),this.m_awakeFlag&&(this.m_force.add(t),this.m_torque+=re.cross(re.sub(e,this.m_sweep.c),t)))};G.prototype.applyForceToCenter=function(t,e){this.m_type==_r&&(e&&this.m_awakeFlag==!1&&this.setAwake(!0),this.m_awakeFlag&&this.m_force.add(t))};G.prototype.applyTorque=function(t,e){this.m_type==_r&&(e&&this.m_awakeFlag==!1&&this.setAwake(!0),this.m_awakeFlag&&(this.m_torque+=t))};G.prototype.applyLinearImpulse=function(t,e,r){this.m_type==_r&&(r&&this.m_awakeFlag==!1&&this.setAwake(!0),this.m_awakeFlag&&(this.m_linearVelocity.addMul(this.m_invMass,t),this.m_angularVelocity+=this.m_invI*re.cross(re.sub(e,this.m_sweep.c),t)))};G.prototype.applyAngularImpulse=function(t,e){this.m_type==_r&&(e&&this.m_awakeFlag==!1&&this.setAwake(!0),this.m_awakeFlag&&(this.m_angularVelocity+=this.m_invI*t))};G.prototype.shouldCollide=function(t){if(this.m_type!=_r&&t.m_type!=_r)return!1;for(var e=this.m_jointList;e;e=e.next)if(e.other==t&&e.joint.m_collideConnected==!1)return!1;return!0};G.prototype._addFixture=function(t){if(xe&&Be.assert(this.isWorldLocked()==!1),this.isWorldLocked()==!0)return null;if(this.m_activeFlag){var e=this.m_world.m_broadPhase;t.createProxies(e,this.m_xf)}return t.m_next=this.m_fixtureList,this.m_fixtureList=t,t.m_density>0&&this.resetMassData(),this.m_world.m_newFixture=!0,t};G.prototype.createFixture=function(t,e){if(xe&&Be.assert(this.isWorldLocked()==!1),this.isWorldLocked()==!0)return null;var r=new cm(this,t,e);return this._addFixture(r),r};G.prototype.destroyFixture=function(t){if(xe&&Be.assert(this.isWorldLocked()==!1),this.isWorldLocked()!=!0){xe&&Be.assert(t.m_body==this);var e=!1;if(this.m_fixtureList===t)this.m_fixtureList=t.m_next,e=!0;else for(var r=this.m_fixtureList;r!=null;){if(r.m_next===t){r.m_next=t.m_next,e=!0;break}r=r.m_next}xe&&Be.assert(e);for(var i=this.m_contactList;i;){var o=i.contact;i=i.next;var a=o.getFixtureA(),h=o.getFixtureB();(t==a||t==h)&&this.m_world.destroyContact(o)}if(this.m_activeFlag){var c=this.m_world.m_broadPhase;t.destroyProxies(c)}t.m_body=null,t.m_next=null,this.m_world.publish("remove-fixture",t),this.resetMassData()}};G.prototype.getWorldPoint=function(t){return so.mulVec2(this.m_xf,t)};G.prototype.getWorldVector=function(t){return lm.mulVec2(this.m_xf.q,t)};G.prototype.getLocalPoint=function(t){return so.mulTVec2(this.m_xf,t)};G.prototype.getLocalVector=function(t){return lm.mulTVec2(this.m_xf.q,t)};var Gv=typeof DEBUG=="undefined"?!1:DEBUG,we=typeof ASSERT=="undefined"?!1:ASSERT,Si=Ct,oo=wt,pt=ut;function Ct(t,e,r,i){typeof t=="object"&&t!==null?(this.ex=pt.clone(t),this.ey=pt.clone(e)):typeof t=="number"?(this.ex=pt.neo(t,r),this.ey=pt.neo(e,i)):(this.ex=pt.zero(),this.ey=pt.zero())}Ct.prototype.toString=function(){return JSON.stringify(this)};Ct.isValid=function(t){return t&&pt.isValid(t.ex)&&pt.isValid(t.ey)};Ct.assert=function(t){if(!!we&&!Ct.isValid(t))throw Gv&&oo.debug(t),new Error("Invalid Mat22!")};Ct.prototype.set=function(t,e,r,i){typeof t=="number"&&typeof e=="number"&&typeof r=="number"&&typeof i=="number"?(this.ex.set(t,r),this.ey.set(e,i)):typeof t=="object"&&typeof e=="object"?(this.ex.set(t),this.ey.set(e)):typeof t=="object"?(we&&Ct.assert(t),this.ex.set(t.ex),this.ey.set(t.ey)):we&&oo.assert(!1)};Ct.prototype.setIdentity=function(){this.ex.x=1,this.ey.x=0,this.ex.y=0,this.ey.y=1};Ct.prototype.setZero=function(){this.ex.x=0,this.ey.x=0,this.ex.y=0,this.ey.y=0};Ct.prototype.getInverse=function(){var t=this.ex.x,e=this.ey.x,r=this.ex.y,i=this.ey.y,o=t*i-e*r;o!=0&&(o=1/o);var a=new Ct;return a.ex.x=o*i,a.ey.x=-o*e,a.ex.y=-o*r,a.ey.y=o*t,a};Ct.prototype.solve=function(t){we&&pt.assert(t);var e=this.ex.x,r=this.ey.x,i=this.ex.y,o=this.ey.y,a=e*o-r*i;a!=0&&(a=1/a);var h=pt.zero();return h.x=a*(o*t.x-r*t.y),h.y=a*(e*t.y-i*t.x),h};Ct.mul=function(t,e){if(e&&"x"in e&&"y"in e){we&&pt.assert(e);var r=t.ex.x*e.x+t.ey.x*e.y,i=t.ex.y*e.x+t.ey.y*e.y;return pt.neo(r,i)}else if(e&&"ex"in e&&"ey"in e){we&&Ct.assert(e);var o=t.ex.x*e.ex.x+t.ey.x*e.ex.y,a=t.ex.x*e.ey.x+t.ey.x*e.ey.y,h=t.ex.y*e.ex.x+t.ey.y*e.ex.y,c=t.ex.y*e.ey.x+t.ey.y*e.ey.y;return new Ct(o,a,h,c)}we&&oo.assert(!1)};Ct.mulVec2=function(t,e){we&&pt.assert(e);var r=t.ex.x*e.x+t.ey.x*e.y,i=t.ex.y*e.x+t.ey.y*e.y;return pt.neo(r,i)};Ct.mulMat22=function(t,e){we&&Ct.assert(e);var r=t.ex.x*e.ex.x+t.ey.x*e.ex.y,i=t.ex.x*e.ey.x+t.ey.x*e.ey.y,o=t.ex.y*e.ex.x+t.ey.y*e.ex.y,a=t.ex.y*e.ey.x+t.ey.y*e.ey.y;return new Ct(r,i,o,a)};Ct.mulT=function(t,e){if(e&&"x"in e&&"y"in e)return we&&pt.assert(e),pt.neo(pt.dot(e,t.ex),pt.dot(e,t.ey));if(e&&"ex"in e&&"ey"in e){we&&Ct.assert(e);var r=pt.neo(pt.dot(t.ex,e.ex),pt.dot(t.ey,e.ex)),i=pt.neo(pt.dot(t.ex,e.ey),pt.dot(t.ey,e.ey));return new Ct(r,i)}we&&oo.assert(!1)};Ct.mulTVec2=function(t,e){return we&&Ct.assert(t),we&&pt.assert(e),pt.neo(pt.dot(e,t.ex),pt.dot(e,t.ey))};Ct.mulTMat22=function(t,e){we&&Ct.assert(t),we&&Ct.assert(e);var r=pt.neo(pt.dot(t.ex,e.ex),pt.dot(t.ey,e.ex)),i=pt.neo(pt.dot(t.ex,e.ey),pt.dot(t.ey,e.ey));return new Ct(r,i)};Ct.abs=function(t){return we&&Ct.assert(t),new Ct(pt.abs(t.ex),pt.abs(t.ey))};Ct.add=function(t,e){return we&&Ct.assert(t),we&&Ct.assert(e),new Ct(pt.add(t.ex,e.ex),pt.add(t.ey,e.ey))};var vr={exports:{}};var te=ut,ki=Ge,Bh=Rt.exports,wh=ae;vr.exports=mr;vr.exports.clipSegmentToLine=Yv;vr.exports.clipVertex=_m;vr.exports.getPointStates=Uv;vr.exports.PointState=ts;mr.e_circles=0;mr.e_faceA=1;mr.e_faceB=2;mr.e_vertex=0;mr.e_face=1;function mr(){this.type,this.localNormal=te.zero(),this.localPoint=te.zero(),this.points=[new Sh,new Sh],this.pointCount=0}function Sh(){this.localPoint=te.zero(),this.normalImpulse=0,this.tangentImpulse=0,this.id=new no}function no(){this.cf=new um}Object.defineProperty(no.prototype,"key",{get:function(){return this.cf.indexA+this.cf.indexB*4+this.cf.typeA*16+this.cf.typeB*64},enumerable:!0,configurable:!0});no.prototype.set=function(t){this.cf.set(t.cf)};function um(){this.indexA,this.indexB,this.typeA,this.typeB}um.prototype.set=function(t){this.indexA=t.indexA,this.indexB=t.indexB,this.typeA=t.typeA,this.typeB=t.typeB};function Jv(){this.normal,this.points=[],this.separations=[]}mr.prototype.getWorldManifold=function(t,e,r,i,o){if(this.pointCount!=0){t=t||new Jv;var a=t.normal,h=t.points,c=t.separations;switch(this.type){case mr.e_circles:a=te.neo(1,0);var u=ki.mulVec2(e,this.localPoint),_=ki.mulVec2(i,this.points[0].localPoint),f=te.sub(_,u);te.lengthSquared(f)>Bh.EPSILON*Bh.EPSILON&&(a.set(f),a.normalize());var m=u.clone().addMul(r,a),p=_.clone().addMul(-o,a);h[0]=te.mid(m,p),c[0]=te.dot(te.sub(p,m),a),h.length=1,c.length=1;break;case mr.e_faceA:a=wh.mulVec2(e.q,this.localNormal);for(var y=ki.mulVec2(e,this.localPoint),v=0;v<this.pointCount;++v){var g=ki.mulVec2(i,this.points[v].localPoint),m=te.clone(g).addMul(r-te.dot(te.sub(g,y),a),a),p=te.clone(g).subMul(o,a);h[v]=te.mid(m,p),c[v]=te.dot(te.sub(p,m),a)}h.length=this.pointCount,c.length=this.pointCount;break;case mr.e_faceB:a=wh.mulVec2(i.q,this.localNormal);for(var y=ki.mulVec2(i,this.localPoint),v=0;v<this.pointCount;++v){var g=ki.mulVec2(e,this.points[v].localPoint),p=te.combine(1,g,o-te.dot(te.sub(g,y),a),a),m=te.combine(1,g,-r,a);h[v]=te.mid(m,p),c[v]=te.dot(te.sub(m,p),a)}h.length=this.pointCount,c.length=this.pointCount,a.mul(-1);break}return t.normal=a,t.points=h,t.separations=c,t}};var ts={nullState:0,addState:1,persistState:2,removeState:3};function Uv(t,e,r,i){for(var o=0;o<r.pointCount;++o){var a=r.points[o].id;t[o]=ts.removeState;for(var h=0;h<i.pointCount;++h)if(i.points[h].id.key==a.key){t[o]=ts.persistState;break}}for(var o=0;o<i.pointCount;++o){var a=i.points[o].id;e[o]=ts.addState;for(var h=0;h<r.pointCount;++h)if(r.points[h].id.key==a.key){e[o]=ts.persistState;break}}}function _m(){this.v=te.zero(),this.id=new no}_m.prototype.set=function(t){this.v.set(t.v),this.id.set(t.id)};function Yv(t,e,r,i,o){var a=0,h=te.dot(r,e[0].v)-i,c=te.dot(r,e[1].v)-i;if(h<=0&&t[a++].set(e[0]),c<=0&&t[a++].set(e[1]),h*c<0){var u=h/(h-c);t[a].v.setCombine(1-u,e[0].v,u,e[1].v),t[a].id.cf.indexA=o,t[a].id.cf.indexB=e[0].id.cf.indexB,t[a].id.cf.typeA=mr.e_vertex,t[a].id.cf.typeB=mr.e_face,++a}return a}var Wr={exports:{}},ao={};ao.toString=function(t){t=typeof t=="string"?t:`
`;var e="";for(var r in this)typeof this[r]!="function"&&typeof this[r]!="object"&&(e+=r+": "+this[r]+t);return e};var Wv=typeof DEBUG=="undefined"?!1:DEBUG,hs=typeof ASSERT=="undefined"?!1:ASSERT,Yi=Bt,jv=wt,Yo=Rt.exports;function Bt(t,e,r){if(!(this instanceof Bt))return new Bt(t,e,r);typeof t=="undefined"?(this.x=0,this.y=0,this.z=0):typeof t=="object"?(this.x=t.x,this.y=t.y,this.z=t.z):(this.x=t,this.y=e,this.z=r),hs&&Bt.assert(this)}Bt.prototype._serialize=function(){return{x:this.x,y:this.y,z:this.z}};Bt._deserialize=function(t){var e=Object.create(Bt.prototype);return e.x=t.x,e.y=t.y,e.z=t.z,e};Bt.neo=function(t,e,r){var i=Object.create(Bt.prototype);return i.x=t,i.y=e,i.z=r,i};Bt.clone=function(t){return hs&&Bt.assert(t),Bt.neo(t.x,t.y,t.z)};Bt.prototype.toString=function(){return JSON.stringify(this)};Bt.isValid=function(t){return t&&Yo.isFinite(t.x)&&Yo.isFinite(t.y)&&Yo.isFinite(t.z)};Bt.assert=function(t){if(!!hs&&!Bt.isValid(t))throw Wv&&jv.debug(t),new Error("Invalid Vec3!")};Bt.prototype.setZero=function(){return this.x=0,this.y=0,this.z=0,this};Bt.prototype.set=function(t,e,r){return this.x=t,this.y=e,this.z=r,this};Bt.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this};Bt.prototype.sub=function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this};Bt.prototype.mul=function(t){return this.x*=t,this.y*=t,this.z*=t,this};Bt.areEqual=function(t,e){return hs&&Bt.assert(t),hs&&Bt.assert(e),t==e||typeof t=="object"&&t!==null&&typeof e=="object"&&e!==null&&t.x===e.x&&t.y===e.y&&t.z===e.z};Bt.dot=function(t,e){return t.x*e.x+t.y*e.y+t.z*e.z};Bt.cross=function(t,e){return new Bt(t.y*e.z-t.z*e.y,t.z*e.x-t.x*e.z,t.x*e.y-t.y*e.x)};Bt.add=function(t,e){return new Bt(t.x+e.x,t.y+e.y,t.z+e.z)};Bt.sub=function(t,e){return new Bt(t.x-e.x,t.y-e.y,t.z-e.z)};Bt.mul=function(t,e){return new Bt(e*t.x,e*t.y,e*t.z)};Bt.prototype.neg=function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this};Bt.neg=function(t){return new Bt(-t.x,-t.y,-t.z)};var Hv=typeof DEBUG=="undefined"?!1:DEBUG,br=typeof ASSERT=="undefined"?!1:ASSERT,ho=de,vm=wt,ms=ut,Zt=Yi;function de(t,e,r){typeof t=="object"&&t!==null?(this.ex=Zt.clone(t),this.ey=Zt.clone(e),this.ez=Zt.clone(r)):(this.ex=Zt(),this.ey=Zt(),this.ez=Zt())}de.prototype.toString=function(){return JSON.stringify(this)};de.isValid=function(t){return t&&Zt.isValid(t.ex)&&Zt.isValid(t.ey)&&Zt.isValid(t.ez)};de.assert=function(t){if(!!br&&!de.isValid(t))throw Hv&&vm.debug(t),new Error("Invalid Mat33!")};de.prototype.setZero=function(){return this.ex.setZero(),this.ey.setZero(),this.ez.setZero(),this};de.prototype.solve33=function(t){var e=Zt.dot(this.ex,Zt.cross(this.ey,this.ez));e!=0&&(e=1/e);var r=new Zt;return r.x=e*Zt.dot(t,Zt.cross(this.ey,this.ez)),r.y=e*Zt.dot(this.ex,Zt.cross(t,this.ez)),r.z=e*Zt.dot(this.ex,Zt.cross(this.ey,t)),r};de.prototype.solve22=function(t){var e=this.ex.x,r=this.ey.x,i=this.ex.y,o=this.ey.y,a=e*o-r*i;a!=0&&(a=1/a);var h=ms.zero();return h.x=a*(o*t.x-r*t.y),h.y=a*(e*t.y-i*t.x),h};de.prototype.getInverse22=function(t){var e=this.ex.x,r=this.ey.x,i=this.ex.y,o=this.ey.y,a=e*o-r*i;a!=0&&(a=1/a),t.ex.x=a*o,t.ey.x=-a*r,t.ex.z=0,t.ex.y=-a*i,t.ey.y=a*e,t.ey.z=0,t.ez.x=0,t.ez.y=0,t.ez.z=0};de.prototype.getSymInverse33=function(t){var e=Zt.dot(this.ex,Zt.cross(this.ey,this.ez));e!=0&&(e=1/e);var r=this.ex.x,i=this.ey.x,o=this.ez.x,a=this.ey.y,h=this.ez.y,c=this.ez.z;t.ex.x=e*(a*c-h*h),t.ex.y=e*(o*h-i*c),t.ex.z=e*(i*h-o*a),t.ey.x=t.ex.y,t.ey.y=e*(r*c-o*o),t.ey.z=e*(o*i-r*h),t.ez.x=t.ex.z,t.ez.y=t.ey.z,t.ez.z=e*(r*a-i*i)};de.mul=function(t,e){if(br&&de.assert(t),e&&"z"in e&&"y"in e&&"x"in e){br&&Zt.assert(e);var r=t.ex.x*e.x+t.ey.x*e.y+t.ez.x*e.z,i=t.ex.y*e.x+t.ey.y*e.y+t.ez.y*e.z,o=t.ex.z*e.x+t.ey.z*e.y+t.ez.z*e.z;return new Zt(r,i,o)}else if(e&&"y"in e&&"x"in e){br&&ms.assert(e);var r=t.ex.x*e.x+t.ey.x*e.y,i=t.ex.y*e.x+t.ey.y*e.y;return ms.neo(r,i)}br&&vm.assert(!1)};de.mulVec3=function(t,e){br&&de.assert(t),br&&Zt.assert(e);var r=t.ex.x*e.x+t.ey.x*e.y+t.ez.x*e.z,i=t.ex.y*e.x+t.ey.y*e.y+t.ez.y*e.z,o=t.ex.z*e.x+t.ey.z*e.y+t.ez.z*e.z;return new Zt(r,i,o)};de.mulVec2=function(t,e){br&&de.assert(t),br&&ms.assert(e);var r=t.ex.x*e.x+t.ey.x*e.y,i=t.ex.y*e.x+t.ey.y*e.y;return ms.neo(r,i)};de.add=function(t,e){return br&&de.assert(t),br&&de.assert(e),new de(Zt.add(t.ex,e.ex),Zt.add(t.ey,e.ey),Zt.add(t.ez,e.ez))};var Sr=typeof ASSERT=="undefined"?!1:ASSERT;Wr.exports=tn;Wr.exports.Input=pm;Wr.exports.Output=fm;Wr.exports.Proxy=ci;Wr.exports.Cache=ym;var Zv=Ae,Cr=wt,yi=ao,Di=Rt.exports,K=ut,Ch=ae,Ni=Ge;yi.gjkCalls=0;yi.gjkIters=0;yi.gjkMaxIters=0;function pm(){this.proxyA=new ci,this.proxyB=new ci,this.transformA=null,this.transformB=null,this.useRadii=!1}function fm(){this.pointA=K.zero(),this.pointB=K.zero(),this.distance,this.iterations}function ym(){this.metric=0,this.indexA=[],this.indexB=[],this.count=0}function tn(t,e,r){++yi.gjkCalls;var i=r.proxyA,o=r.proxyB,a=r.transformA,h=r.transformB,c=new Mr;c.readCache(e,i,a,o,h);for(var u=c.m_v,_=Zv.maxDistnceIterations,f=[],m=[],p=0,v=0;v<_;){p=c.m_count;for(var g=0;g<p;++g)f[g]=u[g].indexA,m[g]=u[g].indexB;if(c.solve(),c.m_count==3)break;var y=c.getClosestPoint();y.lengthSquared();var w=c.getSearchDirection();if(w.lengthSquared()<Di.EPSILON*Di.EPSILON)break;var b=u[c.m_count];b.indexA=i.getSupport(Ch.mulTVec2(a.q,K.neg(w))),b.wA=Ni.mulVec2(a,i.getVertex(b.indexA)),b.indexB=o.getSupport(Ch.mulTVec2(h.q,w)),b.wB=Ni.mulVec2(h,o.getVertex(b.indexB)),b.w=K.sub(b.wB,b.wA),++v,++yi.gjkIters;for(var T=!1,g=0;g<p;++g)if(b.indexA==f[g]&&b.indexB==m[g]){T=!0;break}if(T)break;++c.m_count}if(yi.gjkMaxIters=Di.max(yi.gjkMaxIters,v),c.getWitnessPoints(t.pointA,t.pointB),t.distance=K.distance(t.pointA,t.pointB),t.iterations=v,c.writeCache(e),r.useRadii){var M=i.m_radius,I=o.m_radius;if(t.distance>M+I&&t.distance>Di.EPSILON){t.distance-=M+I;var z=K.sub(t.pointB,t.pointA);z.normalize(),t.pointA.addMul(M,z),t.pointB.subMul(I,z)}else{var y=K.mid(t.pointA,t.pointB);t.pointA.set(y),t.pointB.set(y),t.distance=0}}}function ci(){this.m_buffer=[],this.m_vertices=[],this.m_count=0,this.m_radius=0}ci.prototype.getVertexCount=function(){return this.m_count};ci.prototype.getVertex=function(t){return Sr&&Cr.assert(0<=t&&t<this.m_count),this.m_vertices[t]};ci.prototype.getSupport=function(t){for(var e=0,r=K.dot(this.m_vertices[0],t),i=0;i<this.m_count;++i){var o=K.dot(this.m_vertices[i],t);o>r&&(e=i,r=o)}return e};ci.prototype.getSupportVertex=function(t){return this.m_vertices[this.getSupport(t)]};ci.prototype.set=function(t,e){Sr&&Cr.assert(typeof t.computeDistanceProxy=="function"),t.computeDistanceProxy(this,e)};function Ls(){this.indexA,this.indexB,this.wA=K.zero(),this.wB=K.zero(),this.w=K.zero(),this.a}Ls.prototype.set=function(t){this.indexA=t.indexA,this.indexB=t.indexB,this.wA=K.clone(t.wA),this.wB=K.clone(t.wB),this.w=K.clone(t.w),this.a=t.a};function Mr(){this.m_v1=new Ls,this.m_v2=new Ls,this.m_v3=new Ls,this.m_v=[this.m_v1,this.m_v2,this.m_v3],this.m_count}Mr.prototype.print=function(){return this.m_count==3?["+"+this.m_count,this.m_v1.a,this.m_v1.wA.x,this.m_v1.wA.y,this.m_v1.wB.x,this.m_v1.wB.y,this.m_v2.a,this.m_v2.wA.x,this.m_v2.wA.y,this.m_v2.wB.x,this.m_v2.wB.y,this.m_v3.a,this.m_v3.wA.x,this.m_v3.wA.y,this.m_v3.wB.x,this.m_v3.wB.y].toString():this.m_count==2?["+"+this.m_count,this.m_v1.a,this.m_v1.wA.x,this.m_v1.wA.y,this.m_v1.wB.x,this.m_v1.wB.y,this.m_v2.a,this.m_v2.wA.x,this.m_v2.wA.y,this.m_v2.wB.x,this.m_v2.wB.y].toString():this.m_count==1?["+"+this.m_count,this.m_v1.a,this.m_v1.wA.x,this.m_v1.wA.y,this.m_v1.wB.x,this.m_v1.wB.y].toString():"+"+this.m_count};Mr.prototype.readCache=function(t,e,r,i,o){Sr&&Cr.assert(t.count<=3),this.m_count=t.count;for(var a=0;a<this.m_count;++a){var h=this.m_v[a];h.indexA=t.indexA[a],h.indexB=t.indexB[a];var c=e.getVertex(h.indexA),u=i.getVertex(h.indexB);h.wA=Ni.mulVec2(r,c),h.wB=Ni.mulVec2(o,u),h.w=K.sub(h.wB,h.wA),h.a=0}if(this.m_count>1){var _=t.metric,f=this.getMetric();(f<.5*_||2*_<f||f<Di.EPSILON)&&(this.m_count=0)}if(this.m_count==0){var h=this.m_v[0];h.indexA=0,h.indexB=0;var c=e.getVertex(0),u=i.getVertex(0);h.wA=Ni.mulVec2(r,c),h.wB=Ni.mulVec2(o,u),h.w=K.sub(h.wB,h.wA),h.a=1,this.m_count=1}};Mr.prototype.writeCache=function(t){t.metric=this.getMetric(),t.count=this.m_count;for(var e=0;e<this.m_count;++e)t.indexA[e]=this.m_v[e].indexA,t.indexB[e]=this.m_v[e].indexB};Mr.prototype.getSearchDirection=function(){switch(this.m_count){case 1:return K.neg(this.m_v1.w);case 2:{var t=K.sub(this.m_v2.w,this.m_v1.w),e=K.cross(t,K.neg(this.m_v1.w));return e>0?K.cross(1,t):K.cross(t,1)}default:return Sr&&Cr.assert(!1),K.zero()}};Mr.prototype.getClosestPoint=function(){switch(this.m_count){case 0:return Sr&&Cr.assert(!1),K.zero();case 1:return K.clone(this.m_v1.w);case 2:return K.combine(this.m_v1.a,this.m_v1.w,this.m_v2.a,this.m_v2.w);case 3:return K.zero();default:return Sr&&Cr.assert(!1),K.zero()}};Mr.prototype.getWitnessPoints=function(t,e){switch(this.m_count){case 0:Sr&&Cr.assert(!1);break;case 1:t.set(this.m_v1.wA),e.set(this.m_v1.wB);break;case 2:t.setCombine(this.m_v1.a,this.m_v1.wA,this.m_v2.a,this.m_v2.wA),e.setCombine(this.m_v1.a,this.m_v1.wB,this.m_v2.a,this.m_v2.wB);break;case 3:t.setCombine(this.m_v1.a,this.m_v1.wA,this.m_v2.a,this.m_v2.wA),t.addMul(this.m_v3.a,this.m_v3.wA),e.set(t);break;default:Sr&&Cr.assert(!1);break}};Mr.prototype.getMetric=function(){switch(this.m_count){case 0:return Sr&&Cr.assert(!1),0;case 1:return 0;case 2:return K.distance(this.m_v1.w,this.m_v2.w);case 3:return K.cross(K.sub(this.m_v2.w,this.m_v1.w),K.sub(this.m_v3.w,this.m_v1.w));default:return Sr&&Cr.assert(!1),0}};Mr.prototype.solve=function(){switch(this.m_count){case 1:break;case 2:this.solve2();break;case 3:this.solve3();break;default:Sr&&Cr.assert(!1)}};Mr.prototype.solve2=function(){var t=this.m_v1.w,e=this.m_v2.w,r=K.sub(e,t),i=-K.dot(t,r);if(i<=0){this.m_v1.a=1,this.m_count=1;return}var o=K.dot(e,r);if(o<=0){this.m_v2.a=1,this.m_count=1,this.m_v1.set(this.m_v2);return}var a=1/(o+i);this.m_v1.a=o*a,this.m_v2.a=i*a,this.m_count=2};Mr.prototype.solve3=function(){var t=this.m_v1.w,e=this.m_v2.w,r=this.m_v3.w,i=K.sub(e,t),o=K.dot(t,i),a=K.dot(e,i),h=a,c=-o,u=K.sub(r,t),_=K.dot(t,u),f=K.dot(r,u),m=f,p=-_,v=K.sub(r,e),g=K.dot(e,v),y=K.dot(r,v),w=y,b=-g,T=K.cross(i,u),M=T*K.cross(e,r),I=T*K.cross(r,t),z=T*K.cross(t,e);if(c<=0&&p<=0){this.m_v1.a=1,this.m_count=1;return}if(h>0&&c>0&&z<=0){var V=1/(h+c);this.m_v1.a=h*V,this.m_v2.a=c*V,this.m_count=2;return}if(m>0&&p>0&&I<=0){var N=1/(m+p);this.m_v1.a=m*N,this.m_v3.a=p*N,this.m_count=2,this.m_v2.set(this.m_v3);return}if(h<=0&&b<=0){this.m_v2.a=1,this.m_count=1,this.m_v1.set(this.m_v2);return}if(m<=0&&w<=0){this.m_v3.a=1,this.m_count=1,this.m_v1.set(this.m_v3);return}if(w>0&&b>0&&M<=0){var L=1/(w+b);this.m_v2.a=w*L,this.m_v3.a=b*L,this.m_count=2,this.m_v1.set(this.m_v3);return}var J=1/(M+I+z);this.m_v1.a=M*J,this.m_v2.a=I*J,this.m_v3.a=z*J,this.m_count=3};tn.testOverlap=function(t,e,r,i,o,a){var h=new pm;h.proxyA.set(t,e),h.proxyB.set(r,i),h.transformA=o,h.transformB=a,h.useRadii=!0;var c=new ym,u=new fm;return tn(u,c,h),u.distance<10*Di.EPSILON};var Ns=typeof ASSERT=="undefined"?!1:ASSERT,Os=wt,ls=Rt.exports,P=ut,Pr=Ge,Gs=Si,Oi=ae,es=Ae,ss=vr.exports,Xv=Wr.exports,ui=Mt;function Mh(t){this.contact=t,this.prev,this.next,this.other}function Mt(t,e,r,i,o){this.m_nodeA=new Mh(this),this.m_nodeB=new Mh(this),this.m_fixtureA=t,this.m_fixtureB=r,this.m_indexA=e,this.m_indexB=i,this.m_evaluateFcn=o,this.m_manifold=new ss,this.m_prev=null,this.m_next=null,this.m_toi=1,this.m_toiCount=0,this.m_toiFlag=!1,this.m_friction=dm(this.m_fixtureA.m_friction,this.m_fixtureB.m_friction),this.m_restitution=gm(this.m_fixtureA.m_restitution,this.m_fixtureB.m_restitution),this.m_tangentSpeed=0,this.m_enabledFlag=!0,this.m_islandFlag=!1,this.m_touchingFlag=!1,this.m_filterFlag=!1,this.m_bulletHitFlag=!1,this.v_points=[],this.v_normal=P.zero(),this.v_normalMass=new Gs,this.v_K=new Gs,this.v_pointCount,this.v_tangentSpeed,this.v_friction,this.v_restitution,this.v_invMassA,this.v_invMassB,this.v_invIA,this.v_invIB,this.p_localPoints=[],this.p_localNormal=P.zero(),this.p_localPoint=P.zero(),this.p_localCenterA=P.zero(),this.p_localCenterB=P.zero(),this.p_type,this.p_radiusA,this.p_radiusB,this.p_pointCount,this.p_invMassA,this.p_invMassB,this.p_invIA,this.p_invIB}Mt.prototype.initConstraint=function(t){var e=this.m_fixtureA,r=this.m_fixtureB,i=e.getShape(),o=r.getShape(),a=e.getBody(),h=r.getBody(),c=this.getManifold(),u=c.pointCount;Ns&&Os.assert(u>0),this.v_invMassA=a.m_invMass,this.v_invMassB=h.m_invMass,this.v_invIA=a.m_invI,this.v_invIB=h.m_invI,this.v_friction=this.m_friction,this.v_restitution=this.m_restitution,this.v_tangentSpeed=this.m_tangentSpeed,this.v_pointCount=u,this.v_K.setZero(),this.v_normalMass.setZero(),this.p_invMassA=a.m_invMass,this.p_invMassB=h.m_invMass,this.p_invIA=a.m_invI,this.p_invIB=h.m_invI,this.p_localCenterA=P.clone(a.m_sweep.localCenter),this.p_localCenterB=P.clone(h.m_sweep.localCenter),this.p_radiusA=i.m_radius,this.p_radiusB=o.m_radius,this.p_type=c.type,this.p_localNormal=P.clone(c.localNormal),this.p_localPoint=P.clone(c.localPoint),this.p_pointCount=u;for(var _=0;_<u;++_){var f=c.points[_],m=this.v_points[_]=new Kv;t.warmStarting?(m.normalImpulse=t.dtRatio*f.normalImpulse,m.tangentImpulse=t.dtRatio*f.tangentImpulse):(m.normalImpulse=0,m.tangentImpulse=0),m.rA.setZero(),m.rB.setZero(),m.normalMass=0,m.tangentMass=0,m.velocityBias=0,this.p_localPoints[_]=P.clone(f.localPoint)}};Mt.prototype.getManifold=function(){return this.m_manifold};Mt.prototype.getWorldManifold=function(t){var e=this.m_fixtureA.getBody(),r=this.m_fixtureB.getBody(),i=this.m_fixtureA.getShape(),o=this.m_fixtureB.getShape();return this.m_manifold.getWorldManifold(t,e.getTransform(),i.m_radius,r.getTransform(),o.m_radius)};Mt.prototype.setEnabled=function(t){this.m_enabledFlag=!!t};Mt.prototype.isEnabled=function(){return this.m_enabledFlag};Mt.prototype.isTouching=function(){return this.m_touchingFlag};Mt.prototype.getNext=function(){return this.m_next};Mt.prototype.getFixtureA=function(){return this.m_fixtureA};Mt.prototype.getFixtureB=function(){return this.m_fixtureB};Mt.prototype.getChildIndexA=function(){return this.m_indexA};Mt.prototype.getChildIndexB=function(){return this.m_indexB};Mt.prototype.flagForFiltering=function(){this.m_filterFlag=!0};Mt.prototype.setFriction=function(t){this.m_friction=t};Mt.prototype.getFriction=function(){return this.m_friction};Mt.prototype.resetFriction=function(){this.m_friction=dm(this.m_fixtureA.m_friction,this.m_fixtureB.m_friction)};Mt.prototype.setRestitution=function(t){this.m_restitution=t};Mt.prototype.getRestitution=function(){return this.m_restitution};Mt.prototype.resetRestitution=function(){this.m_restitution=gm(this.m_fixtureA.m_restitution,this.m_fixtureB.m_restitution)};Mt.prototype.setTangentSpeed=function(t){this.m_tangentSpeed=t};Mt.prototype.getTangentSpeed=function(){return this.m_tangentSpeed};Mt.prototype.evaluate=function(t,e,r){this.m_evaluateFcn(t,e,this.m_fixtureA,this.m_indexA,r,this.m_fixtureB,this.m_indexB)};Mt.prototype.update=function(t){this.m_enabledFlag=!0;var e=!1,r=this.m_touchingFlag,i=this.m_fixtureA.isSensor(),o=this.m_fixtureB.isSensor(),a=i||o,h=this.m_fixtureA.getBody(),c=this.m_fixtureB.getBody(),u=h.getTransform(),_=c.getTransform();if(a){var f=this.m_fixtureA.getShape(),m=this.m_fixtureB.getShape();e=Xv.testOverlap(f,this.m_indexA,m,this.m_indexB,u,_),this.m_manifold.pointCount=0}else{var p=this.m_manifold;this.m_manifold=new ss,this.evaluate(this.m_manifold,u,_),e=this.m_manifold.pointCount>0;for(var v=0;v<this.m_manifold.pointCount;++v){var g=this.m_manifold.points[v];g.normalImpulse=0,g.tangentImpulse=0;for(var y=0;y<p.pointCount;++y){var w=p.points[y];if(w.id.key==g.id.key){g.normalImpulse=w.normalImpulse,g.tangentImpulse=w.tangentImpulse;break}}}e!=r&&(h.setAwake(!0),c.setAwake(!0))}this.m_touchingFlag=e,r==!1&&e==!0&&t&&t.beginContact(this),r==!0&&e==!1&&t&&t.endContact(this),a==!1&&e&&t&&t.preSolve(this,p)};Mt.prototype.solvePositionConstraint=function(t){return this._solvePositionConstraint(t,!1)};Mt.prototype.solvePositionConstraintTOI=function(t,e,r){return this._solvePositionConstraint(t,!0,e,r)};Mt.prototype._solvePositionConstraint=function(t,e,r,i){var o=this.m_fixtureA,a=this.m_fixtureB,h=o.getBody(),c=a.getBody();h.c_velocity,c.c_velocity;var u=h.c_position,_=c.c_position,f=P.clone(this.p_localCenterA),m=P.clone(this.p_localCenterB),p=0,v=0;(!e||h==r||h==i)&&(p=this.p_invMassA,v=this.p_invIA);var g=0,y=0;(!e||c==r||c==i)&&(g=this.p_invMassB,y=this.p_invIB);for(var w=P.clone(u.c),b=u.a,T=P.clone(_.c),M=_.a,I=0,z=0;z<this.p_pointCount;++z){var V=Pr.identity(),N=Pr.identity();V.q.set(b),N.q.set(M),V.p=P.sub(w,Oi.mulVec2(V.q,f)),N.p=P.sub(T,Oi.mulVec2(N.q,m));var L,J,D;switch(this.p_type){case ss.e_circles:var O=Pr.mulVec2(V,this.p_localPoint),q=Pr.mulVec2(N,this.p_localPoints[0]);L=P.sub(q,O),L.normalize(),J=P.combine(.5,O,.5,q),D=P.dot(P.sub(q,O),L)-this.p_radiusA-this.p_radiusB;break;case ss.e_faceA:L=Oi.mulVec2(V.q,this.p_localNormal);var bt=Pr.mulVec2(V,this.p_localPoint),Q=Pr.mulVec2(N,this.p_localPoints[z]);D=P.dot(P.sub(Q,bt),L)-this.p_radiusA-this.p_radiusB,J=Q;break;case ss.e_faceB:L=Oi.mulVec2(N.q,this.p_localNormal);var bt=Pr.mulVec2(N,this.p_localPoint),Q=Pr.mulVec2(V,this.p_localPoints[z]);D=P.dot(P.sub(Q,bt),L)-this.p_radiusA-this.p_radiusB,J=Q,L.mul(-1);break}var se=P.sub(J,w),Pt=P.sub(J,T);I=ls.min(I,D);var dt=e?es.toiBaugarte:es.baumgarte,ot=es.linearSlop,Vt=es.maxLinearCorrection,at=ls.clamp(dt*(D+ot),-Vt,0),it=P.cross(se,L),xt=P.cross(Pt,L),_e=p+g+v*it*it+y*xt*xt,Je=_e>0?-at/_e:0,Ue=P.mul(Je,L);w.subMul(p,Ue),b-=v*P.cross(se,Ue),T.addMul(g,Ue),M+=y*P.cross(Pt,Ue)}return u.c.set(w),u.a=b,_.c.set(T),_.a=M,I};function Kv(){this.rA=P.zero(),this.rB=P.zero(),this.normalImpulse=0,this.tangentImpulse=0,this.normalMass=0,this.tangentMass=0,this.velocityBias=0}Mt.prototype.initVelocityConstraint=function(t){var e=this.m_fixtureA,r=this.m_fixtureB,i=e.getBody(),o=r.getBody(),a=i.c_velocity,h=o.c_velocity,c=i.c_position,u=o.c_position,_=this.p_radiusA,f=this.p_radiusB,m=this.getManifold(),p=this.v_invMassA,v=this.v_invMassB,g=this.v_invIA,y=this.v_invIB,w=P.clone(this.p_localCenterA),b=P.clone(this.p_localCenterB),T=P.clone(c.c),M=c.a,I=P.clone(a.v),z=a.w,V=P.clone(u.c),N=u.a,L=P.clone(h.v),J=h.w;Ns&&Os.assert(m.pointCount>0);var D=Pr.identity(),O=Pr.identity();D.q.set(M),O.q.set(N),D.p.setCombine(1,T,-1,Oi.mulVec2(D.q,w)),O.p.setCombine(1,V,-1,Oi.mulVec2(O.q,b));var q=m.getWorldManifold(null,D,_,O,f);this.v_normal.set(q.normal);for(var bt=0;bt<this.v_pointCount;++bt){var Q=this.v_points[bt];Q.rA.set(P.sub(q.points[bt],T)),Q.rB.set(P.sub(q.points[bt],V));var se=P.cross(Q.rA,this.v_normal),Pt=P.cross(Q.rB,this.v_normal),dt=p+v+g*se*se+y*Pt*Pt;Q.normalMass=dt>0?1/dt:0;var ot=P.cross(this.v_normal,1),Vt=P.cross(Q.rA,ot),at=P.cross(Q.rB,ot),it=p+v+g*Vt*Vt+y*at*at;Q.tangentMass=it>0?1/it:0,Q.velocityBias=0;var xt=P.dot(this.v_normal,L)+P.dot(this.v_normal,P.cross(J,Q.rB))-P.dot(this.v_normal,I)-P.dot(this.v_normal,P.cross(z,Q.rA));xt<-es.velocityThreshold&&(Q.velocityBias=-this.v_restitution*xt)}if(this.v_pointCount==2&&t.blockSolve){var _e=this.v_points[0],Je=this.v_points[1],Ue=P.cross(_e.rA,this.v_normal),nr=P.cross(_e.rB,this.v_normal),Ir=P.cross(Je.rA,this.v_normal),jr=P.cross(Je.rB,this.v_normal),$e=p+v+g*Ue*Ue+y*nr*nr,Fr=p+v+g*Ir*Ir+y*jr*jr,$r=p+v+g*Ue*Ir+y*nr*jr,Wi=1e3;$e*$e<Wi*($e*Fr-$r*$r)?(this.v_K.ex.set($e,$r),this.v_K.ey.set($r,Fr),this.v_normalMass.set(this.v_K.getInverse())):this.v_pointCount=1}c.c.set(T),c.a=M,a.v.set(I),a.w=z,u.c.set(V),u.a=N,h.v.set(L),h.w=J};Mt.prototype.warmStartConstraint=function(t){var e=this.m_fixtureA,r=this.m_fixtureB,i=e.getBody(),o=r.getBody(),a=i.c_velocity,h=o.c_velocity;i.c_position,o.c_position;for(var c=this.v_invMassA,u=this.v_invIA,_=this.v_invMassB,f=this.v_invIB,m=P.clone(a.v),p=a.w,v=P.clone(h.v),g=h.w,y=this.v_normal,w=P.cross(y,1),b=0;b<this.v_pointCount;++b){var T=this.v_points[b],M=P.combine(T.normalImpulse,y,T.tangentImpulse,w);p-=u*P.cross(T.rA,M),m.subMul(c,M),g+=f*P.cross(T.rB,M),v.addMul(_,M)}a.v.set(m),a.w=p,h.v.set(v),h.w=g};Mt.prototype.storeConstraintImpulses=function(t){for(var e=this.m_manifold,r=0;r<this.v_pointCount;++r)e.points[r].normalImpulse=this.v_points[r].normalImpulse,e.points[r].tangentImpulse=this.v_points[r].tangentImpulse};Mt.prototype.solveVelocityConstraint=function(t){var e=this.m_fixtureA.m_body,r=this.m_fixtureB.m_body,i=e.c_velocity;e.c_position;var o=r.c_velocity;r.c_position;var a=this.v_invMassA,h=this.v_invIA,c=this.v_invMassB,u=this.v_invIB,_=P.clone(i.v),f=i.w,m=P.clone(o.v),p=o.w,v=this.v_normal,g=P.cross(v,1),y=this.v_friction;Ns&&Os.assert(this.v_pointCount==1||this.v_pointCount==2);for(var w=0;w<this.v_pointCount;++w){var b=this.v_points[w],T=P.zero();T.addCombine(1,m,1,P.cross(p,b.rB)),T.subCombine(1,_,1,P.cross(f,b.rA));var M=P.dot(T,g)-this.v_tangentSpeed,I=b.tangentMass*-M,z=y*b.normalImpulse,V=ls.clamp(b.tangentImpulse+I,-z,z);I=V-b.tangentImpulse,b.tangentImpulse=V;var N=P.mul(I,g);_.subMul(a,N),f-=h*P.cross(b.rA,N),m.addMul(c,N),p+=u*P.cross(b.rB,N)}if(this.v_pointCount==1||t.blockSolve==!1)for(var L=0;L<this.v_pointCount;++L){var b=this.v_points[L],T=P.zero();T.addCombine(1,m,1,P.cross(p,b.rB)),T.subCombine(1,_,1,P.cross(f,b.rA));var J=P.dot(T,v),I=-b.normalMass*(J-b.velocityBias),V=ls.max(b.normalImpulse+I,0);I=V-b.normalImpulse,b.normalImpulse=V;var N=P.mul(I,v);_.subMul(a,N),f-=h*P.cross(b.rA,N),m.addMul(c,N),p+=u*P.cross(b.rB,N)}else{var D=this.v_points[0],O=this.v_points[1],q=P.neo(D.normalImpulse,O.normalImpulse);Ns&&Os.assert(q.x>=0&&q.y>=0);var bt=P.zero().add(m).add(P.cross(p,D.rB)).sub(_).sub(P.cross(f,D.rA)),Q=P.zero().add(m).add(P.cross(p,O.rB)).sub(_).sub(P.cross(f,O.rA)),se=P.dot(bt,v),Pt=P.dot(Q,v),dt=P.neo(se-D.velocityBias,Pt-O.velocityBias);for(dt.sub(Gs.mulVec2(this.v_K,q));;){var ot=Gs.mulVec2(this.v_normalMass,dt).neg();if(ot.x>=0&&ot.y>=0){var Vt=P.sub(ot,q),at=P.mul(Vt.x,v),it=P.mul(Vt.y,v);_.subCombine(a,at,a,it),f-=h*(P.cross(D.rA,at)+P.cross(O.rA,it)),m.addCombine(c,at,c,it),p+=u*(P.cross(D.rB,at)+P.cross(O.rB,it)),D.normalImpulse=ot.x,O.normalImpulse=ot.y;break}if(ot.x=-D.normalMass*dt.x,ot.y=0,se=0,Pt=this.v_K.ex.y*ot.x+dt.y,ot.x>=0&&Pt>=0){var Vt=P.sub(ot,q),at=P.mul(Vt.x,v),it=P.mul(Vt.y,v);_.subCombine(a,at,a,it),f-=h*(P.cross(D.rA,at)+P.cross(O.rA,it)),m.addCombine(c,at,c,it),p+=u*(P.cross(D.rB,at)+P.cross(O.rB,it)),D.normalImpulse=ot.x,O.normalImpulse=ot.y;var bt;break}if(ot.x=0,ot.y=-O.normalMass*dt.y,se=this.v_K.ey.x*ot.y+dt.x,Pt=0,ot.y>=0&&se>=0){var Vt=P.sub(ot,q),at=P.mul(Vt.x,v),it=P.mul(Vt.y,v);_.subCombine(a,at,a,it),f-=h*(P.cross(D.rA,at)+P.cross(O.rA,it)),m.addCombine(c,at,c,it),p+=u*(P.cross(D.rB,at)+P.cross(O.rB,it)),D.normalImpulse=ot.x,O.normalImpulse=ot.y;var bt;break}if(ot.x=0,ot.y=0,se=dt.x,Pt=dt.y,se>=0&&Pt>=0){var Vt=P.sub(ot,q),at=P.mul(Vt.x,v),it=P.mul(Vt.y,v);_.subCombine(a,at,a,it),f-=h*(P.cross(D.rA,at)+P.cross(O.rA,it)),m.addCombine(c,at,c,it),p+=u*(P.cross(D.rB,at)+P.cross(O.rB,it)),D.normalImpulse=ot.x,O.normalImpulse=ot.y;break}break}}i.v.set(_),i.w=f,o.v.set(m),o.w=p};function dm(t,e){return ls.sqrt(t*e)}function gm(t,e){return t>e?t:e}var ei=[];Mt.addType=function(t,e,r){ei[t]=ei[t]||{},ei[t][e]=r};Mt.create=function(t,e,r,i){var o=t.getType(),a=r.getType(),h,c;if(c=ei[o]&&ei[o][a])h=new Mt(t,e,r,i,c);else if(c=ei[a]&&ei[a][o])h=new Mt(r,i,t,e,c);else return null;t=h.getFixtureA(),r=h.getFixtureB(),e=h.getChildIndexA(),i=h.getChildIndexB();var u=t.getBody(),_=r.getBody();return h.m_nodeA.contact=h,h.m_nodeA.other=_,h.m_nodeA.prev=null,h.m_nodeA.next=u.m_contactList,u.m_contactList!=null&&(u.m_contactList.prev=h.m_nodeA),u.m_contactList=h.m_nodeA,h.m_nodeB.contact=h,h.m_nodeB.other=u,h.m_nodeB.prev=null,h.m_nodeB.next=_.m_contactList,_.m_contactList!=null&&(_.m_contactList.prev=h.m_nodeB),_.m_contactList=h.m_nodeB,t.isSensor()==!1&&r.isSensor()==!1&&(u.setAwake(!0),_.setAwake(!0)),h};Mt.destroy=function(t,e){var r=t.m_fixtureA,i=t.m_fixtureB,o=r.getBody(),a=i.getBody();t.isTouching()&&e.endContact(t),t.m_nodeA.prev&&(t.m_nodeA.prev.next=t.m_nodeA.next),t.m_nodeA.next&&(t.m_nodeA.next.prev=t.m_nodeA.prev),t.m_nodeA==o.m_contactList&&(o.m_contactList=t.m_nodeA.next),t.m_nodeB.prev&&(t.m_nodeB.prev.next=t.m_nodeB.next),t.m_nodeB.next&&(t.m_nodeB.next.prev=t.m_nodeB.prev),t.m_nodeB==a.m_contactList&&(a.m_contactList=t.m_nodeB.next),t.m_manifold.pointCount>0&&r.isSensor()==!1&&i.isSensor()==!1&&(o.setAwake(!0),a.setAwake(!0));var h=r.getType(),c=i.getType(),u=ei[h][c].destroyFcn;typeof u=="function"&&u(t)};var Wo=typeof ASSERT=="undefined"?!1:ASSERT,Xe=ge,jo=wt;function Th(){this.other=null,this.joint=null,this.prev=null,this.next=null}function ge(t,e,r){e=t.bodyA||e,r=t.bodyB||r,Wo&&jo.assert(e),Wo&&jo.assert(r),Wo&&jo.assert(e!=r),this.m_type="unknown-joint",this.m_bodyA=e,this.m_bodyB=r,this.m_index=0,this.m_collideConnected=!!t.collideConnected,this.m_prev=null,this.m_next=null,this.m_edgeA=new Th,this.m_edgeB=new Th,this.m_islandFlag=!1,this.m_userData=t.userData}ge.TYPES={};ge._deserialize=function(t,e,r){var i=ge.TYPES[t.type];return i&&r(i,t)};ge.prototype.isActive=function(){return this.m_bodyA.isActive()&&this.m_bodyB.isActive()};ge.prototype.getType=function(){return this.m_type};ge.prototype.getBodyA=function(){return this.m_bodyA};ge.prototype.getBodyB=function(){return this.m_bodyB};ge.prototype.getNext=function(){return this.m_next};ge.prototype.getUserData=function(){return this.m_userData};ge.prototype.setUserData=function(t){this.m_userData=t};ge.prototype.getCollideConnected=function(){return this.m_collideConnected};ge.prototype.getAnchorA=function(){};ge.prototype.getAnchorB=function(){};ge.prototype.getReactionForce=function(t){};ge.prototype.getReactionTorque=function(t){};ge.prototype.shiftOrigin=function(t){};ge.prototype.initVelocityConstraints=function(t){};ge.prototype.solveVelocityConstraints=function(t){};ge.prototype.solvePositionConstraints=function(t){};var fs={exports:{}},xn={};xn.now=function(){return Date.now()};xn.diff=function(t){return Date.now()-t};var Bn=typeof ASSERT=="undefined"?!1:ASSERT;fs.exports=ip;fs.exports.Input=rp;fs.exports.Output=sr;var Xi=Ae,wn=wt,Ih=xn,Ve=ao,Ki=Rt.exports,le=ut,Qr=ae,$h=yn,Ie=Ge,ys=Wr.exports,Qv=ys.Input,tp=ys.Output,Js=ys.Proxy,ep=ys.Cache;function rp(){this.proxyA=new Js,this.proxyB=new Js,this.sweepA=new $h,this.sweepB=new $h,this.tMax}sr.e_unknown=0;sr.e_failed=1;sr.e_overlapped=2;sr.e_touching=3;sr.e_separated=4;function sr(){this.state,this.t}Ve.toiTime=0;Ve.toiMaxTime=0;Ve.toiCalls=0;Ve.toiIters=0;Ve.toiMaxIters=0;Ve.toiRootIters=0;Ve.toiMaxRootIters=0;function ip(t,e){var r=Ih.now();++Ve.toiCalls,t.state=sr.e_unknown,t.t=e.tMax;var i=e.proxyA,o=e.proxyB,a=e.sweepA,h=e.sweepB;a.normalize(),h.normalize();var c=e.tMax,u=i.m_radius+o.m_radius,_=Ki.max(Xi.linearSlop,u-3*Xi.linearSlop),f=.25*Xi.linearSlop;Bn&&wn.assert(_>f);var m=0,p=Xi.maxTOIIterations,v=0,g=new ep,y=new Qv;for(y.proxyA=e.proxyA,y.proxyB=e.proxyB,y.useRadii=!1;;){var w=Ie.identity(),b=Ie.identity();a.getTransform(w,m),h.getTransform(b,m),y.transformA=w,y.transformB=b;var T=new tp;if(ys(T,g,y),T.distance<=0){t.state=sr.e_overlapped,t.t=0;break}if(T.distance<_+f){t.state=sr.e_touching,t.t=m;break}var M=new ds;M.initialize(g,i,a,o,h,m);for(var I=!1,z=c,V=0;;){var N=M.findMinSeparation(z);if(M.indexA,M.indexB,N>_+f){t.state=sr.e_separated,t.t=c,I=!0;break}if(N>_-f){m=z;break}var L=M.evaluate(m);if(M.indexA,M.indexB,L<_-f){t.state=sr.e_failed,t.t=m,I=!0;break}if(L<=_+f){t.state=sr.e_touching,t.t=m,I=!0;break}for(var J=0,D=m,O=z;;){var q;J&1?q=D+(_-L)*(O-D)/(N-L):q=.5*(D+O),++J,++Ve.toiRootIters;var bt=M.evaluate(q);if(M.indexA,M.indexB,Ki.abs(bt-_)<f){z=q;break}if(bt>_?(D=q,L=bt):(O=q,N=bt),J==50)break}if(Ve.toiMaxRootIters=Ki.max(Ve.toiMaxRootIters,J),++V,V==Xi.maxPolygonVertices)break}if(++v,++Ve.toiIters,I)break;if(v==p){t.state=sr.e_failed,t.t=m;break}}Ve.toiMaxIters=Ki.max(Ve.toiMaxIters,v);var Q=Ih.diff(r);Ve.toiMaxTime=Ki.max(Ve.toiMaxTime,Q),Ve.toiTime+=Q}var Am=1,bm=2,xm=3;function ds(){this.m_proxyA=new Js,this.m_proxyB=new Js,this.m_sweepA,this.m_sweepB,this.indexA,this.indexB,this.m_type,this.m_localPoint=le.zero(),this.m_axis=le.zero()}ds.prototype.initialize=function(t,e,r,i,o,a){this.m_proxyA=e,this.m_proxyB=i;var h=t.count;Bn&&wn.assert(0<h&&h<3),this.m_sweepA=r,this.m_sweepB=o;var c=Ie.identity(),u=Ie.identity();if(this.m_sweepA.getTransform(c,a),this.m_sweepB.getTransform(u,a),h==1){this.m_type=Am;var _=this.m_proxyA.getVertex(t.indexA[0]),f=this.m_proxyB.getVertex(t.indexB[0]),m=Ie.mulVec2(c,_),p=Ie.mulVec2(u,f);this.m_axis.setCombine(1,p,-1,m);var v=this.m_axis.normalize();return v}else if(t.indexA[0]==t.indexA[1]){this.m_type=xm;var g=i.getVertex(t.indexB[0]),y=i.getVertex(t.indexB[1]);this.m_axis=le.cross(le.sub(y,g),1),this.m_axis.normalize();var w=Qr.mulVec2(u.q,this.m_axis);this.m_localPoint=le.mid(g,y);var p=Ie.mulVec2(u,this.m_localPoint),_=e.getVertex(t.indexA[0]),m=Ie.mulVec2(c,_),v=le.dot(m,w)-le.dot(p,w);return v<0&&(this.m_axis=le.neg(this.m_axis),v=-v),v}else{this.m_type=bm;var b=this.m_proxyA.getVertex(t.indexA[0]),T=this.m_proxyA.getVertex(t.indexA[1]);this.m_axis=le.cross(le.sub(T,b),1),this.m_axis.normalize();var w=Qr.mulVec2(c.q,this.m_axis);this.m_localPoint=le.mid(b,T);var m=Ie.mulVec2(c,this.m_localPoint),f=this.m_proxyB.getVertex(t.indexB[0]),p=Ie.mulVec2(u,f),v=le.dot(p,w)-le.dot(m,w);return v<0&&(this.m_axis=le.neg(this.m_axis),v=-v),v}};ds.prototype.compute=function(t,e){var r=Ie.identity(),i=Ie.identity();switch(this.m_sweepA.getTransform(r,e),this.m_sweepB.getTransform(i,e),this.m_type){case Am:{if(t){var o=Qr.mulTVec2(r.q,this.m_axis),a=Qr.mulTVec2(i.q,le.neg(this.m_axis));this.indexA=this.m_proxyA.getSupport(o),this.indexB=this.m_proxyB.getSupport(a)}var h=this.m_proxyA.getVertex(this.indexA),c=this.m_proxyB.getVertex(this.indexB),u=Ie.mulVec2(r,h),_=Ie.mulVec2(i,c),f=le.dot(_,this.m_axis)-le.dot(u,this.m_axis);return f}case bm:{var m=Qr.mulVec2(r.q,this.m_axis),u=Ie.mulVec2(r,this.m_localPoint);if(t){var a=Qr.mulTVec2(i.q,le.neg(m));this.indexA=-1,this.indexB=this.m_proxyB.getSupport(a)}var c=this.m_proxyB.getVertex(this.indexB),_=Ie.mulVec2(i,c),f=le.dot(_,m)-le.dot(u,m);return f}case xm:{var m=Qr.mulVec2(i.q,this.m_axis),_=Ie.mulVec2(i,this.m_localPoint);if(t){var o=Qr.mulTVec2(r.q,le.neg(m));this.indexB=-1,this.indexA=this.m_proxyA.getSupport(o)}var h=this.m_proxyA.getVertex(this.indexA),u=Ie.mulVec2(r,h),f=le.dot(u,m)-le.dot(_,m);return f}default:return Bn&&wn.assert(!1),t&&(this.indexA=-1,this.indexB=-1),0}};ds.prototype.findMinSeparation=function(t){return this.compute(!0,t)};ds.prototype.evaluate=function(t){return this.compute(!1,t)};var Or=typeof DEBUG=="undefined"?!1:DEBUG,Ji=typeof ASSERT=="undefined"?!1:ASSERT;fn.exports=Tr;fn.exports.TimeStep=Cn;var tr=Ae,Bi=wt,gr=ut,gi=Rt.exports,sp=Ze,op=ui,np=Xe,Sn=fs.exports,ap=Sn.Input,Eh=Sn.Output,mo=Wr.exports;mo.Input;mo.Output;mo.Proxy;mo.Cache;function Cn(t){this.dt=0,this.inv_dt=0,this.velocityIterations=0,this.positionIterations=0,this.warmStarting=!1,this.blockSolve=!0,this.inv_dt0=0,this.dtRatio=1}Cn.prototype.reset=function(t){this.dt>0&&(this.inv_dt0=this.inv_dt),this.dt=t,this.inv_dt=t==0?0:1/t,this.dtRatio=t*this.inv_dt0};function Tr(t){this.m_world=t,this.m_stack=[],this.m_bodies=[],this.m_contacts=[],this.m_joints=[]}Tr.prototype.clear=function(){this.m_stack.length=0,this.m_bodies.length=0,this.m_contacts.length=0,this.m_joints.length=0};Tr.prototype.addBody=function(t){Ji&&Bi.assert(t instanceof sp,"Not a Body!",t),this.m_bodies.push(t)};Tr.prototype.addContact=function(t){Ji&&Bi.assert(t instanceof op,"Not a Contact!",t),this.m_contacts.push(t)};Tr.prototype.addJoint=function(t){Ji&&Bi.assert(t instanceof np,"Not a Joint!",t),this.m_joints.push(t)};Tr.prototype.solveWorld=function(t){for(var e=this.m_world,r=e.m_bodyList;r;r=r.m_next)r.m_islandFlag=!1;for(var i=e.m_contactList;i;i=i.m_next)i.m_islandFlag=!1;for(var o=e.m_jointList;o;o=o.m_next)o.m_islandFlag=!1;for(var a=this.m_stack,h=e.m_bodyList;h;h=h.m_next)if(!h.m_islandFlag&&!(h.isAwake()==!1||h.isActive()==!1)&&!h.isStatic()){for(this.clear(),a.push(h),h.m_islandFlag=!0;a.length>0;){var r=a.pop();if(Ji&&Bi.assert(r.isActive()==!0),this.addBody(r),r.setAwake(!0),!r.isStatic()){for(var c=r.m_contactList;c;c=c.next){var u=c.contact;if(!u.m_islandFlag&&!(u.isEnabled()==!1||u.isTouching()==!1)){var _=u.m_fixtureA.m_isSensor,f=u.m_fixtureB.m_isSensor;if(!(_||f)){this.addContact(u),u.m_islandFlag=!0;var m=c.other;m.m_islandFlag||(a.push(m),m.m_islandFlag=!0)}}}for(var p=r.m_jointList;p;p=p.next)if(p.joint.m_islandFlag!=!0){var m=p.other;m.isActive()!=!1&&(this.addJoint(p.joint),p.joint.m_islandFlag=!0,!m.m_islandFlag&&(a.push(m),m.m_islandFlag=!0))}}}this.solveIsland(t);for(var v=0;v<this.m_bodies.length;++v){var r=this.m_bodies[v];r.isStatic()&&(r.m_islandFlag=!1)}}};Tr.prototype.solveIsland=function(t){for(var e=this.m_world,r=e.m_gravity,i=e.m_allowSleep,o=t.dt,a=0;a<this.m_bodies.length;++a){var h=this.m_bodies[a],c=gr.clone(h.m_sweep.c),u=h.m_sweep.a,_=gr.clone(h.m_linearVelocity),f=h.m_angularVelocity;h.m_sweep.c0.set(h.m_sweep.c),h.m_sweep.a0=h.m_sweep.a,h.isDynamic()&&(_.addMul(o*h.m_gravityScale,r),_.addMul(o*h.m_invMass,h.m_force),f+=o*h.m_invI*h.m_torque,_.mul(1/(1+o*h.m_linearDamping)),f*=1/(1+o*h.m_angularDamping)),h.c_position.c=c,h.c_position.a=u,h.c_velocity.v=_,h.c_velocity.w=f}for(var a=0;a<this.m_contacts.length;++a){var m=this.m_contacts[a];m.initConstraint(t)}Or&&this.printBodies("M: ");for(var a=0;a<this.m_contacts.length;++a){var m=this.m_contacts[a];m.initVelocityConstraint(t)}if(Or&&this.printBodies("R: "),t.warmStarting)for(var a=0;a<this.m_contacts.length;++a){var m=this.m_contacts[a];m.warmStartConstraint(t)}Or&&this.printBodies("Q: ");for(var a=0;a<this.m_joints.length;++a){var p=this.m_joints[a];p.initVelocityConstraints(t)}Or&&this.printBodies("E: ");for(var a=0;a<t.velocityIterations;++a){for(var v=0;v<this.m_joints.length;++v){var p=this.m_joints[v];p.solveVelocityConstraints(t)}for(var v=0;v<this.m_contacts.length;++v){var m=this.m_contacts[v];m.solveVelocityConstraint(t)}}Or&&this.printBodies("D: ");for(var a=0;a<this.m_contacts.length;++a){var m=this.m_contacts[a];m.storeConstraintImpulses(t)}Or&&this.printBodies("C: ");for(var a=0;a<this.m_bodies.length;++a){var h=this.m_bodies[a],c=gr.clone(h.c_position.c),u=h.c_position.a,_=gr.clone(h.c_velocity.v),f=h.c_velocity.w,g=gr.mul(o,_);if(gr.lengthSquared(g)>tr.maxTranslationSquared){var y=tr.maxTranslation/g.length();_.mul(y)}var w=o*f;if(w*w>tr.maxRotationSquared){var y=tr.maxRotation/gi.abs(w);f*=y}c.addMul(o,_),u+=o*f,h.c_position.c.set(c),h.c_position.a=u,h.c_velocity.v.set(_),h.c_velocity.w=f}Or&&this.printBodies("B: ");for(var b=!1,a=0;a<t.positionIterations;++a){for(var T=0,v=0;v<this.m_contacts.length;++v){var m=this.m_contacts[v],M=m.solvePositionConstraint(t);T=gi.min(T,M)}for(var I=T>=-3*tr.linearSlop,z=!0,v=0;v<this.m_joints.length;++v){var p=this.m_joints[v],V=p.solvePositionConstraints(t);z=z&&V}if(I&&z){b=!0;break}}Or&&this.printBodies("L: ");for(var a=0;a<this.m_bodies.length;++a){var h=this.m_bodies[a];h.m_sweep.c.set(h.c_position.c),h.m_sweep.a=h.c_position.a,h.m_linearVelocity.set(h.c_velocity.v),h.m_angularVelocity=h.c_velocity.w,h.synchronizeTransform()}if(this.postSolveIsland(),i){for(var N=1/0,L=tr.linearSleepToleranceSqr,J=tr.angularSleepToleranceSqr,a=0;a<this.m_bodies.length;++a){var h=this.m_bodies[a];h.isStatic()||(h.m_autoSleepFlag==!1||h.m_angularVelocity*h.m_angularVelocity>J||gr.lengthSquared(h.m_linearVelocity)>L?(h.m_sleepTime=0,N=0):(h.m_sleepTime+=o,N=gi.min(N,h.m_sleepTime)))}if(N>=tr.timeToSleep&&b)for(var a=0;a<this.m_bodies.length;++a){var h=this.m_bodies[a];h.setAwake(!1)}}};Tr.prototype.printBodies=function(t){for(var e=0;e<this.m_bodies.length;++e){var r=this.m_bodies[e];Bi.debug(t,r.c_position.a,r.c_position.c.x,r.c_position.c.y,r.c_velocity.w,r.c_velocity.v.x,r.c_velocity.v.y)}};var Fi=new Cn;Tr.prototype.solveWorldTOI=function(t){var e=this.m_world;if(e.m_stepComplete){for(var r=e.m_bodyList;r;r=r.m_next)r.m_islandFlag=!1,r.m_sweep.alpha0=0;for(var i=e.m_contactList;i;i=i.m_next)i.m_toiFlag=!1,i.m_islandFlag=!1,i.m_toiCount=0,i.m_toi=1}for(;;){for(var o=null,a=1,i=e.m_contactList;i;i=i.m_next)if(i.isEnabled()!=!1&&!(i.m_toiCount>tr.maxSubSteps)){var h=1;if(i.m_toiFlag)h=i.m_toi;else{var b=i.getFixtureA(),T=i.getFixtureB();if(b.isSensor()||T.isSensor())continue;var M=b.getBody(),I=T.getBody();Ji&&Bi.assert(M.isDynamic()||I.isDynamic());var c=M.isAwake()&&!M.isStatic(),u=I.isAwake()&&!I.isStatic();if(c==!1&&u==!1)continue;var _=M.isBullet()||!M.isDynamic(),f=I.isBullet()||!I.isDynamic();if(_==!1&&f==!1)continue;var m=M.m_sweep.alpha0;M.m_sweep.alpha0<I.m_sweep.alpha0?(m=I.m_sweep.alpha0,M.m_sweep.advance(m)):I.m_sweep.alpha0<M.m_sweep.alpha0&&(m=M.m_sweep.alpha0,I.m_sweep.advance(m)),Ji&&Bi.assert(m<1);var p=i.getChildIndexA(),v=i.getChildIndexB();M.m_sweep,I.m_sweep;var g=new ap;g.proxyA.set(b.getShape(),p),g.proxyB.set(T.getShape(),v),g.sweepA.set(M.m_sweep),g.sweepB.set(I.m_sweep),g.tMax=1;var y=new Eh;Sn(y,g);var w=y.t;y.state==Eh.e_touching?h=gi.min(m+(1-m)*w,1):h=1,i.m_toi=h,i.m_toiFlag=!0}h<a&&(o=i,a=h)}if(o==null||1-10*gi.EPSILON<a){e.m_stepComplete=!0;break}var b=o.getFixtureA(),T=o.getFixtureB(),M=b.getBody(),I=T.getBody(),z=M.m_sweep.clone(),V=I.m_sweep.clone();if(M.advance(a),I.advance(a),o.update(e),o.m_toiFlag=!1,++o.m_toiCount,o.isEnabled()==!1||o.isTouching()==!1){o.setEnabled(!1),M.m_sweep.set(z),I.m_sweep.set(V),M.synchronizeTransform(),I.synchronizeTransform();continue}M.setAwake(!0),I.setAwake(!0),this.clear(),this.addBody(M),this.addBody(I),this.addContact(o),M.m_islandFlag=!0,I.m_islandFlag=!0,o.m_islandFlag=!0;for(var N=[M,I],L=0;L<N.length;++L){var J=N[L];if(J.isDynamic())for(var D=J.m_contactList;D;D=D.next){var O=D.contact;if(!O.m_islandFlag){var q=D.other;if(!(q.isDynamic()&&!J.isBullet()&&!q.isBullet())){var bt=O.m_fixtureA.m_isSensor,Q=O.m_fixtureB.m_isSensor;if(!(bt||Q)){var se=q.m_sweep.clone();if(q.m_islandFlag==!1&&q.advance(a),O.update(e),O.isEnabled()==!1||O.isTouching()==!1){q.m_sweep.set(se),q.synchronizeTransform();continue}O.m_islandFlag=!0,this.addContact(O),!q.m_islandFlag&&(q.m_islandFlag=!0,q.isStatic()||q.setAwake(!0),this.addBody(q))}}}}}Fi.reset((1-a)*t.dt),Fi.dtRatio=1,Fi.positionIterations=20,Fi.velocityIterations=t.velocityIterations,Fi.warmStarting=!1,this.solveIslandTOI(Fi,M,I);for(var L=0;L<this.m_bodies.length;++L){var J=this.m_bodies[L];if(J.m_islandFlag=!1,!!J.isDynamic()){J.synchronizeFixtures();for(var D=J.m_contactList;D;D=D.next)D.contact.m_toiFlag=!1,D.contact.m_islandFlag=!1}}if(e.findNewContacts(),e.m_subStepping){e.m_stepComplete=!1;break}}if(Or)for(var r=e.m_bodyList;r;r=r.m_next){var i=r.m_sweep.c;r.m_sweep.a,r.m_linearVelocity,r.m_angularVelocity}};Tr.prototype.solveIslandTOI=function(t,e,r){this.m_world;for(var _=0;_<this.m_bodies.length;++_){var i=this.m_bodies[_];i.c_position.c.set(i.m_sweep.c),i.c_position.a=i.m_sweep.a,i.c_velocity.v.set(i.m_linearVelocity),i.c_velocity.w=i.m_angularVelocity}for(var _=0;_<this.m_contacts.length;++_){var o=this.m_contacts[_];o.initConstraint(t)}for(var _=0;_<t.positionIterations;++_){for(var a=0,h=0;h<this.m_contacts.length;++h){var o=this.m_contacts[h],c=o.solvePositionConstraintTOI(t,e,r);a=gi.min(a,c)}var u=a>=-1.5*tr.linearSlop;if(u)break}var _,f;e.m_sweep.c0.set(e.c_position.c),e.m_sweep.a0=e.c_position.a,r.m_sweep.c0.set(r.c_position.c),r.m_sweep.a0=r.c_position.a;for(var _=0;_<this.m_contacts.length;++_){var o=this.m_contacts[_];o.initVelocityConstraint(t)}for(var _=0;_<t.velocityIterations;++_)for(var h=0;h<this.m_contacts.length;++h){var o=this.m_contacts[h];o.solveVelocityConstraint(t)}for(var m=t.dt,_=0;_<this.m_bodies.length;++_){var i=this.m_bodies[_],f=gr.clone(i.c_position.c),p=i.c_position.a,v=gr.clone(i.c_velocity.v),g=i.c_velocity.w,y=gr.mul(m,v);if(gr.dot(y,y)>tr.maxTranslationSquared){var w=tr.maxTranslation/y.length();v.mul(w)}var b=m*g;if(b*b>tr.maxRotationSquared){var w=tr.maxRotation/gi.abs(b);g*=w}f.addMul(m,v),p+=m*g,i.c_position.c=f,i.c_position.a=p,i.c_velocity.v=v,i.c_velocity.w=g,i.m_sweep.c=f,i.m_sweep.a=p,i.m_linearVelocity=v,i.m_angularVelocity=g,i.synchronizeTransform()}this.postSolveIsland()};function hp(){this.normalImpulses=[],this.tangentImpulses=[]}Tr.prototype.postSolveIsland=function(){for(var t=new hp,e=0;e<this.m_contacts.length;++e){for(var r=this.m_contacts[e],i=0;i<r.v_points.length;++i)t.normalImpulses.push(r.v_points[i].normalImpulse),t.tangentImpulses.push(r.v_points[i].tangentImpulse);this.m_world.postSolve(r,t)}};var cr=typeof ASSERT=="undefined"?!1:ASSERT,Bm=Z,mp=er,ur=wt,Yr=ut,lp=bv,wm=fn.exports,Sm=Ze,cp=Xe,Cm=ui,up={gravity:Yr.zero(),allowSleep:!0,warmStarting:!0,continuousPhysics:!0,subStepping:!1,blockSolve:!0,velocityIterations:8,positionIterations:3};function Z(t){if(!(this instanceof Z))return new Z(t);t&&Yr.isValid(t)&&(t={gravity:t}),t=mp(t,up),this.m_solver=new wm(this),this.m_broadPhase=new lp,this.m_contactList=null,this.m_contactCount=0,this.m_bodyList=null,this.m_bodyCount=0,this.m_jointList=null,this.m_jointCount=0,this.m_stepComplete=!0,this.m_allowSleep=t.allowSleep,this.m_gravity=Yr.clone(t.gravity),this.m_clearForces=!0,this.m_newFixture=!1,this.m_locked=!1,this.m_warmStarting=t.warmStarting,this.m_continuousPhysics=t.continuousPhysics,this.m_subStepping=t.subStepping,this.m_blockSolve=t.blockSolve,this.m_velocityIterations=t.velocityIterations,this.m_positionIterations=t.positionIterations,this.m_t=0,this.addPair=this.createContact.bind(this)}Z.prototype._serialize=function(){for(var t=[],e=[],r=this.getBodyList();r;r=r.getNext())t.push(r);for(var i=this.getJointList();i;i=i.getNext())typeof i._serialize=="function"&&e.push(i);return{gravity:this.m_gravity,bodies:t,joints:e}};Z._deserialize=function(t,e,r){if(!t)return new Z;var i=new Z(t.gravity);if(t.bodies)for(var o=t.bodies.length-1;o>=0;o-=1)i._addBody(r(Sm,t.bodies[o],i));if(t.joints)for(var o=t.joints.length-1;o>=0;o--)i.createJoint(r(cp,t.joints[o],i));return i};Z.prototype.getBodyList=function(){return this.m_bodyList};Z.prototype.getJointList=function(){return this.m_jointList};Z.prototype.getContactList=function(){return this.m_contactList};Z.prototype.getBodyCount=function(){return this.m_bodyCount};Z.prototype.getJointCount=function(){return this.m_jointCount};Z.prototype.getContactCount=function(){return this.m_contactCount};Z.prototype.setGravity=function(t){this.m_gravity=t};Z.prototype.getGravity=function(){return this.m_gravity};Z.prototype.isLocked=function(){return this.m_locked};Z.prototype.setAllowSleeping=function(t){if(t!=this.m_allowSleep&&(this.m_allowSleep=t,this.m_allowSleep==!1))for(var e=this.m_bodyList;e;e=e.m_next)e.setAwake(!0)};Z.prototype.getAllowSleeping=function(){return this.m_allowSleep};Z.prototype.setWarmStarting=function(t){this.m_warmStarting=t};Z.prototype.getWarmStarting=function(){return this.m_warmStarting};Z.prototype.setContinuousPhysics=function(t){this.m_continuousPhysics=t};Z.prototype.getContinuousPhysics=function(){return this.m_continuousPhysics};Z.prototype.setSubStepping=function(t){this.m_subStepping=t};Z.prototype.getSubStepping=function(){return this.m_subStepping};Z.prototype.setAutoClearForces=function(t){this.m_clearForces=t};Z.prototype.getAutoClearForces=function(){return this.m_clearForces};Z.prototype.clearForces=function(){for(var t=this.m_bodyList;t;t=t.getNext())t.m_force.setZero(),t.m_torque=0};Z.prototype.queryAABB=function(t,e){cr&&ur.assert(typeof e=="function");var r=this.m_broadPhase;this.m_broadPhase.query(t,function(i){var o=r.getUserData(i);return e(o.fixture)})};Z.prototype.rayCast=function(t,e,r){cr&&ur.assert(typeof r=="function");var i=this.m_broadPhase;this.m_broadPhase.rayCast({maxFraction:1,p1:t,p2:e},function(o,a){var h=i.getUserData(a),c=h.fixture,u=h.childIndex,_={},f=c.rayCast(_,o,u);if(f){var m=_.fraction,p=Yr.add(Yr.mul(1-m,o.p1),Yr.mul(m,o.p2));return r(c,p,_.normal,m)}return o.maxFraction})};Z.prototype.getProxyCount=function(){return this.m_broadPhase.getProxyCount()};Z.prototype.getTreeHeight=function(){return this.m_broadPhase.getTreeHeight()};Z.prototype.getTreeBalance=function(){return this.m_broadPhase.getTreeBalance()};Z.prototype.getTreeQuality=function(){return this.m_broadPhase.getTreeQuality()};Z.prototype.shiftOrigin=function(t){if(cr&&ur.assert(this.m_locked==!1),!this.m_locked){for(var e=this.m_bodyList;e;e=e.m_next)e.m_xf.p.sub(t),e.m_sweep.c0.sub(t),e.m_sweep.c.sub(t);for(var r=this.m_jointList;r;r=r.m_next)r.shiftOrigin(t);this.m_broadPhase.shiftOrigin(t)}};Z.prototype._addBody=function(t){cr&&ur.assert(this.isLocked()===!1),!this.isLocked()&&(t.m_prev=null,t.m_next=this.m_bodyList,this.m_bodyList&&(this.m_bodyList.m_prev=t),this.m_bodyList=t,++this.m_bodyCount)};Z.prototype.createBody=function(t,e){if(cr&&ur.assert(this.isLocked()==!1),this.isLocked())return null;t&&Yr.isValid(t)&&(t={position:t,angle:e});var r=new Sm(this,t);return this._addBody(r),r};Z.prototype.createDynamicBody=function(t,e){return t?Yr.isValid(t)&&(t={position:t,angle:e}):t={},t.type="dynamic",this.createBody(t)};Z.prototype.createKinematicBody=function(t,e){return t?Yr.isValid(t)&&(t={position:t,angle:e}):t={},t.type="kinematic",this.createBody(t)};Z.prototype.destroyBody=function(t){if(cr&&ur.assert(this.m_bodyCount>0),cr&&ur.assert(this.isLocked()==!1),!this.isLocked()){if(t.m_destroyed)return!1;for(var e=t.m_jointList;e;){var r=e;e=e.next,this.publish("remove-joint",r.joint),this.destroyJoint(r.joint),t.m_jointList=e}t.m_jointList=null;for(var i=t.m_contactList;i;){var o=i;i=i.next,this.destroyContact(o.contact),t.m_contactList=i}t.m_contactList=null;for(var a=t.m_fixtureList;a;){var h=a;a=a.m_next,this.publish("remove-fixture",h),h.destroyProxies(this.m_broadPhase),t.m_fixtureList=a}return t.m_fixtureList=null,t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t==this.m_bodyList&&(this.m_bodyList=t.m_next),t.m_destroyed=!0,--this.m_bodyCount,this.publish("remove-body",t),!0}};Z.prototype.createJoint=function(t){if(cr&&ur.assert(!!t.m_bodyA),cr&&ur.assert(!!t.m_bodyB),cr&&ur.assert(this.isLocked()==!1),this.isLocked())return null;if(t.m_prev=null,t.m_next=this.m_jointList,this.m_jointList&&(this.m_jointList.m_prev=t),this.m_jointList=t,++this.m_jointCount,t.m_edgeA.joint=t,t.m_edgeA.other=t.m_bodyB,t.m_edgeA.prev=null,t.m_edgeA.next=t.m_bodyA.m_jointList,t.m_bodyA.m_jointList&&(t.m_bodyA.m_jointList.prev=t.m_edgeA),t.m_bodyA.m_jointList=t.m_edgeA,t.m_edgeB.joint=t,t.m_edgeB.other=t.m_bodyA,t.m_edgeB.prev=null,t.m_edgeB.next=t.m_bodyB.m_jointList,t.m_bodyB.m_jointList&&(t.m_bodyB.m_jointList.prev=t.m_edgeB),t.m_bodyB.m_jointList=t.m_edgeB,t.m_collideConnected==!1)for(var e=t.m_bodyB.getContactList();e;e=e.next)e.other==t.m_bodyA&&e.contact.flagForFiltering();return t};Z.prototype.destroyJoint=function(t){if(cr&&ur.assert(this.isLocked()==!1),!this.isLocked()){t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t==this.m_jointList&&(this.m_jointList=t.m_next);var e=t.m_bodyA,r=t.m_bodyB;if(e.setAwake(!0),r.setAwake(!0),t.m_edgeA.prev&&(t.m_edgeA.prev.next=t.m_edgeA.next),t.m_edgeA.next&&(t.m_edgeA.next.prev=t.m_edgeA.prev),t.m_edgeA==e.m_jointList&&(e.m_jointList=t.m_edgeA.next),t.m_edgeA.prev=null,t.m_edgeA.next=null,t.m_edgeB.prev&&(t.m_edgeB.prev.next=t.m_edgeB.next),t.m_edgeB.next&&(t.m_edgeB.next.prev=t.m_edgeB.prev),t.m_edgeB==r.m_jointList&&(r.m_jointList=t.m_edgeB.next),t.m_edgeB.prev=null,t.m_edgeB.next=null,cr&&ur.assert(this.m_jointCount>0),--this.m_jointCount,t.m_collideConnected==!1)for(var i=r.getContactList();i;)i.other==e&&i.contact.flagForFiltering(),i=i.next;this.publish("remove-joint",t)}};var fi=new wm.TimeStep;Z.prototype.step=function(t,e,r){if(this.publish("pre-step",t),(e|0)!==e&&(e=0),e=e||this.m_velocityIterations,r=r||this.m_positionIterations,this.m_newFixture&&(this.findNewContacts(),this.m_newFixture=!1),this.m_locked=!0,fi.reset(t),fi.velocityIterations=e,fi.positionIterations=r,fi.warmStarting=this.m_warmStarting,fi.blockSolve=this.m_blockSolve,this.updateContacts(),this.m_stepComplete&&t>0){this.m_solver.solveWorld(fi);for(var i=this.m_bodyList;i;i=i.getNext())i.m_islandFlag!=!1&&(i.isStatic()||i.synchronizeFixtures());this.findNewContacts()}this.m_continuousPhysics&&t>0&&this.m_solver.solveWorldTOI(fi),this.m_clearForces&&this.clearForces(),this.m_locked=!1,this.publish("post-step",t)};Z.prototype.findNewContacts=function(){this.m_broadPhase.updatePairs(this.addPair)};Z.prototype.createContact=function(t,e){var r=t.fixture,i=e.fixture,o=t.childIndex,a=e.childIndex,h=r.getBody(),c=i.getBody();if(h!=c){for(var u=c.getContactList();u;){if(u.other==h){var _=u.contact.getFixtureA(),f=u.contact.getFixtureB(),m=u.contact.getChildIndexA(),p=u.contact.getChildIndexB();if(_==r&&f==i&&m==o&&p==a||_==i&&f==r&&m==a&&p==o)return}u=u.next}if(c.shouldCollide(h)!=!1&&i.shouldCollide(r)!=!1){var v=Cm.create(r,o,i,a);v!=null&&(v.m_prev=null,this.m_contactList!=null&&(v.m_next=this.m_contactList,this.m_contactList.m_prev=v),this.m_contactList=v,++this.m_contactCount)}}};Z.prototype.updateContacts=function(){for(var t,e=this.m_contactList;t=e;){e=t.getNext();var r=t.getFixtureA(),i=t.getFixtureB(),o=t.getChildIndexA(),a=t.getChildIndexB(),h=r.getBody(),c=i.getBody();if(t.m_filterFlag){if(c.shouldCollide(h)==!1){this.destroyContact(t);continue}if(i.shouldCollide(r)==!1){this.destroyContact(t);continue}t.m_filterFlag=!1}var u=h.isAwake()&&!h.isStatic(),_=c.isAwake()&&!c.isStatic();if(!(u==!1&&_==!1)){var f=r.m_proxies[o].proxyId,m=i.m_proxies[a].proxyId,p=this.m_broadPhase.testOverlap(f,m);if(p==!1){this.destroyContact(t);continue}t.update(this)}}};Z.prototype.destroyContact=function(t){Cm.destroy(t,this),t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t==this.m_contactList&&(this.m_contactList=t.m_next),--this.m_contactCount};Z.prototype._listeners=null;Z.prototype.on=function(t,e){return typeof t!="string"||typeof e!="function"?this:(this._listeners||(this._listeners={}),this._listeners[t]||(this._listeners[t]=[]),this._listeners[t].push(e),this)};Z.prototype.off=function(t,e){if(typeof t!="string"||typeof e!="function")return this;var r=this._listeners&&this._listeners[t];if(!r||!r.length)return this;var i=r.indexOf(e);return i>=0&&r.splice(i,1),this};Z.prototype.publish=function(t,e,r,i){var o=this._listeners&&this._listeners[t];if(!o||!o.length)return 0;for(var a=0;a<o.length;a++)o[a].call(this,e,r,i);return o.length};Z.prototype.beginContact=function(t){this.publish("begin-contact",t)};Z.prototype.endContact=function(t){this.publish("end-contact",t)};Z.prototype.preSolve=function(t,e){this.publish("pre-solve",t,e)};Z.prototype.postSolve=function(t,e){this.publish("post-solve",t,e)};var Ph=Bm,_p=Ze,vp=Xe,pp=gn,fp=wi,yp=ut,dp=Yi,gp=0;function Mm(t){t=t||{};var e=t.rootClass||Ph,r=t.preSerialize||function(u){return u},i=t.postSerialize||function(u,_){return u},o=t.preDeserialize||function(u){return u},a=t.postDeserialize||function(u,_){return u},h={World:Ph,Body:_p,Joint:vp,Fixture:pp,Shape:fp},c=Object.assign({Vec2:yp,Vec3:dp},h);this.toJson=function(u){var _=[],f=[u],m={};function p(b,T){if(b.__sid=b.__sid||++gp,!m[b.__sid]){f.push(b);var M=_.length+f.length,I={refIndex:M,refType:T};m[b.__sid]=I}return m[b.__sid]}function v(b){b=r(b);var T=b._serialize();return T=i(T,b),T}function g(b,T){if(typeof b!="object"||b===null)return b;if(typeof b._serialize=="function"){if(b!==T){for(var M in h)if(b instanceof h[M])return p(b,M)}b=v(b)}if(Array.isArray(b)){for(var I=[],z=0;z<b.length;z++)I[z]=g(b[z]);b=I}else{var I={};for(var z in b)b.hasOwnProperty(z)&&(I[z]=g(b[z]));b=I}return b}for(;f.length;){var y=f.shift(),w=g(y,y);_.push(w)}return _},this.fromJson=function(u){var _={};function f(v,g,y){g=o(g);var w=v._deserialize(g,y,m);return w=a(w,g),w}function m(v,g,y){if(!g.refIndex)return v&&v._deserialize&&f(v,g,y);v=c[g.refType]||v;var w=g.refIndex;if(!_[w]){var b=u[w],T=f(v,b,y);_[w]=T}return _[w]}var p=e._deserialize(u[0],null,m);return p}}eo.exports=Mm;var Tm=new Mm;eo.exports.toJson=Tm.toJson;eo.exports.fromJson=Tm.fromJson;var Ap=typeof ASSERT=="undefined"?!1:ASSERT,lo=ie,bp=wt,en=Rt.exports,Mn=ae,je=ut,Im=wi;ie._super=Im;ie.prototype=Object.create(ie._super.prototype);ie.TYPE="circle";Im.TYPES[ie.TYPE]=ie;function ie(t,e){if(!(this instanceof ie))return new ie(t,e);ie._super.call(this),this.m_type=ie.TYPE,this.m_p=je.zero(),this.m_radius=1,typeof t=="object"&&je.isValid(t)?(this.m_p.set(t),typeof e=="number"&&(this.m_radius=e)):typeof t=="number"&&(this.m_radius=t)}ie.prototype._serialize=function(){return{type:this.m_type,p:this.m_p,radius:this.m_radius}};ie._deserialize=function(t){return new ie(t.p,t.radius)};ie.prototype.getRadius=function(){return this.m_radius};ie.prototype.getCenter=function(){return this.m_p};ie.prototype.getVertex=function(t){return Ap&&bp.assert(t==0),this.m_p};ie.prototype.getVertexCount=function(t){return 1};ie.prototype._clone=function(){var t=new ie;return t.m_type=this.m_type,t.m_radius=this.m_radius,t.m_p=this.m_p.clone(),t};ie.prototype.getChildCount=function(){return 1};ie.prototype.testPoint=function(t,e){var r=je.add(t.p,Mn.mulVec2(t.q,this.m_p)),i=je.sub(e,r);return je.dot(i,i)<=this.m_radius*this.m_radius};ie.prototype.rayCast=function(t,e,r,i){var o=je.add(r.p,Mn.mulVec2(r.q,this.m_p)),a=je.sub(e.p1,o),h=je.dot(a,a)-this.m_radius*this.m_radius,c=je.sub(e.p2,e.p1),u=je.dot(a,c),_=je.dot(c,c),f=u*u-_*h;if(f<0||_<en.EPSILON)return!1;var m=-(u+en.sqrt(f));return 0<=m&&m<=e.maxFraction*_?(m/=_,t.fraction=m,t.normal=je.add(a,je.mul(m,c)),t.normal.normalize(),!0):!1};ie.prototype.computeAABB=function(t,e,r){var i=je.add(e.p,Mn.mulVec2(e.q,this.m_p));t.lowerBound.set(i.x-this.m_radius,i.y-this.m_radius),t.upperBound.set(i.x+this.m_radius,i.y+this.m_radius)};ie.prototype.computeMass=function(t,e){t.mass=e*en.PI*this.m_radius*this.m_radius,t.center=this.m_p,t.I=t.mass*(.5*this.m_radius*this.m_radius+je.dot(this.m_p,this.m_p))};ie.prototype.computeDistanceProxy=function(t){t.m_vertices.push(this.m_p),t.m_count=1,t.m_radius=this.m_radius};var co=oe,xp=Ae,$m=wi,Vh=Ge,$s=ae,pe=ut;oe._super=$m;oe.prototype=Object.create(oe._super.prototype);oe.TYPE="edge";$m.TYPES[oe.TYPE]=oe;function oe(t,e){if(!(this instanceof oe))return new oe(t,e);oe._super.call(this),this.m_type=oe.TYPE,this.m_radius=xp.polygonRadius,this.m_vertex1=t?pe.clone(t):pe.zero(),this.m_vertex2=e?pe.clone(e):pe.zero(),this.m_vertex0=pe.zero(),this.m_vertex3=pe.zero(),this.m_hasVertex0=!1,this.m_hasVertex3=!1}oe.prototype._serialize=function(){return{type:this.m_type,vertex1:this.m_vertex1,vertex2:this.m_vertex2,vertex0:this.m_vertex0,vertex3:this.m_vertex3,hasVertex0:this.m_hasVertex0,hasVertex3:this.m_hasVertex3}};oe._deserialize=function(t){var e=new oe(t.vertex1,t.vertex2);return e.hasVertex0&&e.setPrev(t.vertex0),e.hasVertex3&&e.setNext(t.vertex3),e};oe.prototype.setNext=function(t){return t?(this.m_vertex3.set(t),this.m_hasVertex3=!0):(this.m_vertex3.setZero(),this.m_hasVertex3=!1),this};oe.prototype.setPrev=function(t){return t?(this.m_vertex0.set(t),this.m_hasVertex0=!0):(this.m_vertex0.setZero(),this.m_hasVertex0=!1),this};oe.prototype._set=function(t,e){return this.m_vertex1.set(t),this.m_vertex2.set(e),this.m_hasVertex0=!1,this.m_hasVertex3=!1,this};oe.prototype._clone=function(){var t=new oe;return t.m_type=this.m_type,t.m_radius=this.m_radius,t.m_vertex1.set(this.m_vertex1),t.m_vertex2.set(this.m_vertex2),t.m_vertex0.set(this.m_vertex0),t.m_vertex3.set(this.m_vertex3),t.m_hasVertex0=this.m_hasVertex0,t.m_hasVertex3=this.m_hasVertex3,t};oe.prototype.getChildCount=function(){return 1};oe.prototype.testPoint=function(t,e){return!1};oe.prototype.rayCast=function(t,e,r,i){var o=$s.mulTVec2(r.q,pe.sub(e.p1,r.p)),a=$s.mulTVec2(r.q,pe.sub(e.p2,r.p)),h=pe.sub(a,o),c=this.m_vertex1,u=this.m_vertex2,_=pe.sub(u,c),f=pe.neo(_.y,-_.x);f.normalize();var m=pe.dot(f,pe.sub(c,o)),p=pe.dot(f,h);if(p==0)return!1;var v=m/p;if(v<0||e.maxFraction<v)return!1;var g=pe.add(o,pe.mul(v,h)),y=pe.sub(u,c),w=pe.dot(y,y);if(w==0)return!1;var b=pe.dot(pe.sub(g,c),y)/w;return b<0||1<b?!1:(t.fraction=v,m>0?t.normal=$s.mulVec2(r.q,f).neg():t.normal=$s.mulVec2(r.q,f),!0)};oe.prototype.computeAABB=function(t,e,r){var i=Vh.mulVec2(e,this.m_vertex1),o=Vh.mulVec2(e,this.m_vertex2);t.combinePoints(i,o),t.extend(this.m_radius)};oe.prototype.computeMass=function(t,e){t.mass=0,t.center.setCombine(.5,this.m_vertex1,.5,this.m_vertex2),t.I=0};oe.prototype.computeDistanceProxy=function(t){t.m_vertices.push(this.m_vertex1),t.m_vertices.push(this.m_vertex2),t.m_count=2,t.m_radius=this.m_radius};var Vr=typeof ASSERT=="undefined"?!1:ASSERT,gs=Xt,zr=wt,Jr=Rt.exports,rn=Ge,os=ae,st=ut,ks=Ae,Em=wi;Xt._super=Em;Xt.prototype=Object.create(Xt._super.prototype);Xt.TYPE="polygon";Em.TYPES[Xt.TYPE]=Xt;function Xt(t){if(!(this instanceof Xt))return new Xt(t);Xt._super.call(this),this.m_type=Xt.TYPE,this.m_radius=ks.polygonRadius,this.m_centroid=st.zero(),this.m_vertices=[],this.m_normals=[],this.m_count=0,t&&t.length&&this._set(t)}Xt.prototype._serialize=function(){return{type:this.m_type,vertices:this.m_vertices}};Xt._deserialize=function(t,e,r){var i=[];if(t.vertices)for(var o=0;o<t.vertices.length;o++)i.push(r(st,t.vertices[o]));var a=new Xt(i);return a};Xt.prototype.getVertex=function(t){return Vr&&zr.assert(0<=t&&t<this.m_count),this.m_vertices[t]};Xt.prototype._clone=function(){var t=new Xt;t.m_type=this.m_type,t.m_radius=this.m_radius,t.m_count=this.m_count,t.m_centroid.set(this.m_centroid);for(var e=0;e<this.m_count;e++)t.m_vertices.push(this.m_vertices[e].clone());for(var e=0;e<this.m_normals.length;e++)t.m_normals.push(this.m_normals[e].clone());return t};Xt.prototype.getChildCount=function(){return 1};function Bp(t,e){Vr&&zr.assert(e>=3);for(var r=st.zero(),i=0,o=st.zero(),a,h=1/3,a=0;a<e;++a){var c=o,u=t[a],_=a+1<e?t[a+1]:t[0],f=st.sub(u,c),m=st.sub(_,c),p=st.cross(f,m),v=.5*p;i+=v,r.addMul(v*h,c),r.addMul(v*h,u),r.addMul(v*h,_)}return Vr&&zr.assert(i>Jr.EPSILON),r.mul(1/i),r}Xt.prototype._reset=function(){this._set(this.m_vertices)};Xt.prototype._set=function(t){if(Vr&&zr.assert(3<=t.length&&t.length<=ks.maxPolygonVertices),t.length<3){this._setAsBox(1,1);return}for(var e=Jr.min(t.length,ks.maxPolygonVertices),r=[],i=0;i<e;++i){for(var o=t[i],a=!0,h=0;h<r.length;++h)if(st.distanceSquared(o,r[h])<.25*ks.linearSlopSquared){a=!1;break}a&&r.push(o)}if(e=r.length,e<3){Vr&&zr.assert(!1),this._setAsBox(1,1);return}for(var c=0,u=r[0].x,i=1;i<e;++i){var _=r[i].x;(_>u||_===u&&r[i].y<r[c].y)&&(c=i,u=_)}for(var f=[],m=0,p=c;;){f[m]=p;for(var v=0,h=1;h<e;++h){if(v===p){v=h;continue}var g=st.sub(r[v],r[f[m]]),o=st.sub(r[h],r[f[m]]),y=st.cross(g,o);y<0&&(v=h),y===0&&o.lengthSquared()>g.lengthSquared()&&(v=h)}if(++m,p=v,v===c)break}if(m<3){Vr&&zr.assert(!1),this._setAsBox(1,1);return}this.m_count=m,this.m_vertices=[];for(var i=0;i<m;++i)this.m_vertices[i]=r[f[i]];for(var i=0;i<m;++i){var w=i,b=i+1<m?i+1:0,T=st.sub(this.m_vertices[b],this.m_vertices[w]);Vr&&zr.assert(T.lengthSquared()>Jr.EPSILON*Jr.EPSILON),this.m_normals[i]=st.cross(T,1),this.m_normals[i].normalize()}this.m_centroid=Bp(this.m_vertices,m)};Xt.prototype._setAsBox=function(t,e,r,i){if(this.m_vertices[0]=st.neo(t,-e),this.m_vertices[1]=st.neo(t,e),this.m_vertices[2]=st.neo(-t,e),this.m_vertices[3]=st.neo(-t,-e),this.m_normals[0]=st.neo(1,0),this.m_normals[1]=st.neo(0,1),this.m_normals[2]=st.neo(-1,0),this.m_normals[3]=st.neo(0,-1),this.m_count=4,st.isValid(r)){i=i||0,this.m_centroid.set(r);var o=rn.identity();o.p.set(r),o.q.set(i);for(var a=0;a<this.m_count;++a)this.m_vertices[a]=rn.mulVec2(o,this.m_vertices[a]),this.m_normals[a]=os.mulVec2(o.q,this.m_normals[a])}};Xt.prototype.testPoint=function(t,e){for(var r=os.mulTVec2(t.q,st.sub(e,t.p)),i=0;i<this.m_count;++i){var o=st.dot(this.m_normals[i],st.sub(r,this.m_vertices[i]));if(o>0)return!1}return!0};Xt.prototype.rayCast=function(t,e,r,i){for(var o=os.mulTVec2(r.q,st.sub(e.p1,r.p)),a=os.mulTVec2(r.q,st.sub(e.p2,r.p)),h=st.sub(a,o),c=0,u=e.maxFraction,_=-1,f=0;f<this.m_count;++f){var m=st.dot(this.m_normals[f],st.sub(this.m_vertices[f],o)),p=st.dot(this.m_normals[f],h);if(p==0){if(m<0)return!1}else p<0&&m<c*p?(c=m/p,_=f):p>0&&m<u*p&&(u=m/p);if(u<c)return!1}return Vr&&zr.assert(0<=c&&c<=e.maxFraction),_>=0?(t.fraction=c,t.normal=os.mulVec2(r.q,this.m_normals[_]),!0):!1};Xt.prototype.computeAABB=function(t,e,r){for(var i=1/0,o=1/0,a=-1/0,h=-1/0,c=0;c<this.m_count;++c){var u=rn.mulVec2(e,this.m_vertices[c]);i=Jr.min(i,u.x),a=Jr.max(a,u.x),o=Jr.min(o,u.y),h=Jr.max(h,u.y)}t.lowerBound.set(i,o),t.upperBound.set(a,h),t.extend(this.m_radius)};Xt.prototype.computeMass=function(t,e){Vr&&zr.assert(this.m_count>=3);for(var r=st.zero(),i=0,o=0,a=st.zero(),h=0;h<this.m_count;++h)a.add(this.m_vertices[h]);a.mul(1/this.m_count);for(var c=1/3,h=0;h<this.m_count;++h){var u=st.sub(this.m_vertices[h],a),_=h+1<this.m_count?st.sub(this.m_vertices[h+1],a):st.sub(this.m_vertices[0],a),f=st.cross(u,_),m=.5*f;i+=m,r.addCombine(m*c,u,m*c,_);var p=u.x,v=u.y,g=_.x,y=_.y,w=p*p+g*p+g*g,b=v*v+y*v+y*y;o+=.25*c*f*(w+b)}t.mass=e*i,Vr&&zr.assert(i>Jr.EPSILON),r.mul(1/i),t.center.setCombine(1,r,1,a),t.I=e*o,t.I+=t.mass*(st.dot(t.center,t.center)-st.dot(r,r))};Xt.prototype.validate=function(){for(var t=0;t<this.m_count;++t)for(var e=t,r=t<this.m_count-1?e+1:0,i=this.m_vertices[e],o=st.sub(this.m_vertices[r],i),a=0;a<this.m_count;++a)if(!(a==e||a==r)){var h=st.sub(this.m_vertices[a],i),c=st.cross(o,h);if(c<0)return!1}return!0};Xt.prototype.computeDistanceProxy=function(t){t.m_vertices=this.m_vertices,t.m_count=this.m_count,t.m_radius=this.m_radius};var xr=typeof ASSERT=="undefined"?!1:ASSERT,Tn=Ut,Br=wt,zh=Ge,Ai=ut,In=Ae,Pm=wi,Vm=co;Ut._super=Pm;Ut.prototype=Object.create(Ut._super.prototype);Ut.TYPE="chain";Pm.TYPES[Ut.TYPE]=Ut;function Ut(t,e){if(!(this instanceof Ut))return new Ut(t,e);Ut._super.call(this),this.m_type=Ut.TYPE,this.m_radius=In.polygonRadius,this.m_vertices=[],this.m_count=0,this.m_prevVertex=null,this.m_nextVertex=null,this.m_hasPrevVertex=!1,this.m_hasNextVertex=!1,this.m_isLoop=e,t&&t.length&&(e?this._createLoop(t):this._createChain(t))}Ut.prototype._serialize=function(){const t={type:this.m_type,vertices:this.m_vertices,isLoop:this.m_isLoop,hasPrevVertex:this.m_hasPrevVertex,hasNextVertex:this.m_hasNextVertex};return this.m_prevVertex&&(t.prevVertex=this.m_prevVertex),this.m_nextVertex&&(t.nextVertex=this.m_nextVertex),t};Ut._deserialize=function(t,e,r){var i=[];if(t.vertices)for(var o=0;o<t.vertices.length;o++)i.push(r(Ai,t.vertices[o]));var a=new Ut(i,t.isLoop);return t.prevVertex&&a.setPrevVertex(t.prevVertex),t.nextVertex&&a.setNextVertex(t.nextVertex),a};Ut.prototype._createLoop=function(t){xr&&Br.assert(this.m_vertices.length==0&&this.m_count==0),xr&&Br.assert(t.length>=3);for(var e=1;e<t.length;++e){var r=t[e-1],i=t[e];xr&&Br.assert(Ai.distanceSquared(r,i)>In.linearSlopSquared)}this.m_vertices=[],this.m_count=t.length+1;for(var e=0;e<t.length;++e)this.m_vertices[e]=Ai.clone(t[e]);return this.m_vertices[t.length]=Ai.clone(t[0]),this.m_prevVertex=this.m_vertices[this.m_count-2],this.m_nextVertex=this.m_vertices[1],this.m_hasPrevVertex=!0,this.m_hasNextVertex=!0,this};Ut.prototype._createChain=function(t){xr&&Br.assert(this.m_vertices.length==0&&this.m_count==0),xr&&Br.assert(t.length>=2);for(var e=1;e<t.length;++e){var r=t[e-1],i=t[e];xr&&Br.assert(Ai.distanceSquared(r,i)>In.linearSlopSquared)}this.m_count=t.length;for(var e=0;e<t.length;++e)this.m_vertices[e]=Ai.clone(t[e]);return this.m_hasPrevVertex=!1,this.m_hasNextVertex=!1,this.m_prevVertex=null,this.m_nextVertex=null,this};Ut.prototype._reset=function(){this.m_isLoop?this._createLoop(this.m_vertices):this._createChain(this.m_vertices)};Ut.prototype.setPrevVertex=function(t){this.m_prevVertex=t,this.m_hasPrevVertex=!0};Ut.prototype.setNextVertex=function(t){this.m_nextVertex=t,this.m_hasNextVertex=!0};Ut.prototype._clone=function(){var t=new Ut;return t.createChain(this.m_vertices),t.m_type=this.m_type,t.m_radius=this.m_radius,t.m_prevVertex=this.m_prevVertex,t.m_nextVertex=this.m_nextVertex,t.m_hasPrevVertex=this.m_hasPrevVertex,t.m_hasNextVertex=this.m_hasNextVertex,t};Ut.prototype.getChildCount=function(){return this.m_count-1};Ut.prototype.getChildEdge=function(t,e){xr&&Br.assert(0<=e&&e<this.m_count-1),t.m_type=Vm.TYPE,t.m_radius=this.m_radius,t.m_vertex1=this.m_vertices[e],t.m_vertex2=this.m_vertices[e+1],e>0?(t.m_vertex0=this.m_vertices[e-1],t.m_hasVertex0=!0):(t.m_vertex0=this.m_prevVertex,t.m_hasVertex0=this.m_hasPrevVertex),e<this.m_count-2?(t.m_vertex3=this.m_vertices[e+2],t.m_hasVertex3=!0):(t.m_vertex3=this.m_nextVertex,t.m_hasVertex3=this.m_hasNextVertex)};Ut.prototype.getVertex=function(t){return xr&&Br.assert(0<=t&&t<=this.m_count),t<this.m_count?this.m_vertices[t]:this.m_vertices[0]};Ut.prototype.testPoint=function(t,e){return!1};Ut.prototype.rayCast=function(t,e,r,i){xr&&Br.assert(0<=i&&i<this.m_count);var o=new Vm(this.getVertex(i),this.getVertex(i+1));return o.rayCast(t,e,r,0)};Ut.prototype.computeAABB=function(t,e,r){xr&&Br.assert(0<=r&&r<this.m_count);var i=zh.mulVec2(e,this.getVertex(r)),o=zh.mulVec2(e,this.getVertex(r+1));t.combinePoints(i,o)};Ut.prototype.computeMass=function(t,e){t.mass=0,t.center=Ai.neo(),t.I=0};Ut.prototype.computeDistanceProxy=function(t,e){xr&&Br.assert(0<=e&&e<this.m_count),t.m_buffer[0]=this.getVertex(e),t.m_buffer[1]=this.getVertex(e+1),t.m_vertices=t.m_buffer,t.m_count=2,t.m_radius=this.m_radius};var wp=mi,Sp=gs;mi._super=Sp;mi.prototype=Object.create(mi._super.prototype);mi.TYPE="polygon";function mi(t,e,r,i){if(!(this instanceof mi))return new mi(t,e,r,i);mi._super.call(this),this._setAsBox(t,e,r,i)}var Lh=typeof ASSERT=="undefined"?!1:ASSERT,kh=wt,Fh=Ge,Cp=ut,Mp=ui,Ho=vr.exports,Us=lo;Mp.addType(Us.TYPE,Us.TYPE,Tp);function Tp(t,e,r,i,o,a,h){Lh&&kh.assert(r.getType()==Us.TYPE),Lh&&kh.assert(a.getType()==Us.TYPE),Ip(t,r.getShape(),e,a.getShape(),o)}function Ip(t,e,r,i,o){t.pointCount=0;var a=Fh.mulVec2(r,e.m_p),h=Fh.mulVec2(o,i.m_p),c=Cp.distanceSquared(h,a),u=e.m_radius,_=i.m_radius,f=u+_;c>f*f||(t.type=Ho.e_circles,t.localPoint.set(e.m_p),t.localNormal.setZero(),t.pointCount=1,t.points[0].localPoint.set(i.m_p),t.points[0].id.cf.indexA=0,t.points[0].id.cf.typeA=Ho.e_vertex,t.points[0].id.cf.indexB=0,t.points[0].id.cf.typeB=Ho.e_vertex)}var cs=typeof ASSERT=="undefined"?!1:ASSERT,us=wt,Rh=Ge,he=ut,zm=ui,Nr=vr.exports,$n=co,Lm=Tn,uo=lo;zm.addType($n.TYPE,uo.TYPE,$p);zm.addType(Lm.TYPE,uo.TYPE,Ep);function $p(t,e,r,i,o,a,h){cs&&us.assert(r.getType()==$n.TYPE),cs&&us.assert(a.getType()==uo.TYPE);var c=r.getShape(),u=a.getShape();km(t,c,e,u,o)}function Ep(t,e,r,i,o,a,h){cs&&us.assert(r.getType()==Lm.TYPE),cs&&us.assert(a.getType()==uo.TYPE);var c=r.getShape(),u=new $n;c.getChildEdge(u,i);var _=u,f=a.getShape();km(t,_,e,f,o)}function km(t,e,r,i,o){t.pointCount=0;var a=Rh.mulTVec2(r,Rh.mulVec2(o,i.m_p)),h=e.m_vertex1,c=e.m_vertex2,u=he.sub(c,h),_=he.dot(u,he.sub(c,a)),f=he.dot(u,he.sub(a,h)),m=e.m_radius+i.m_radius;if(f<=0){var z=he.clone(h),V=he.sub(a,z),N=he.dot(V,V);if(N>m*m)return;if(e.m_hasVertex0){var p=e.m_vertex0,v=h,g=he.sub(v,p),y=he.dot(g,he.sub(v,a));if(y>0)return}t.type=Nr.e_circles,t.localNormal.setZero(),t.localPoint.set(z),t.pointCount=1,t.points[0].localPoint.set(i.m_p),t.points[0].id.cf.indexA=0,t.points[0].id.cf.typeA=Nr.e_vertex,t.points[0].id.cf.indexB=0,t.points[0].id.cf.typeB=Nr.e_vertex;return}if(_<=0){var z=he.clone(c),V=he.sub(a,z),N=he.dot(V,V);if(N>m*m)return;if(e.m_hasVertex3){var w=e.m_vertex3,b=c,T=he.sub(w,b),M=he.dot(T,he.sub(a,b));if(M>0)return}t.type=Nr.e_circles,t.localNormal.setZero(),t.localPoint.set(z),t.pointCount=1,t.points[0].localPoint.set(i.m_p),t.points[0].id.cf.indexA=1,t.points[0].id.cf.typeA=Nr.e_vertex,t.points[0].id.cf.indexB=0,t.points[0].id.cf.typeB=Nr.e_vertex;return}var I=he.dot(u,u);cs&&us.assert(I>0);var z=he.combine(_/I,h,f/I,c),V=he.sub(a,z),N=he.dot(V,V);if(!(N>m*m)){var L=he.neo(-u.y,u.x);he.dot(L,he.sub(a,h))<0&&L.set(-L.x,-L.y),L.normalize(),t.type=Nr.e_faceA,t.localNormal=L,t.localPoint.set(h),t.pointCount=1,t.points[0].localPoint.set(i.m_p),t.points[0].id.cf.indexA=0,t.points[0].id.cf.typeA=Nr.e_face,t.points[0].id.cf.indexB=0,t.points[0].id.cf.typeB=Nr.e_vertex}}var sn=typeof ASSERT=="undefined"?!1:ASSERT,on=wt,bi=Ge,Ys=ae,hr=ut,Pp=Ae,Qe=vr.exports,Vp=ui,Ws=gs,zp=Fm;Vp.addType(Ws.TYPE,Ws.TYPE,Lp);function Lp(t,e,r,i,o,a,h){sn&&on.assert(r.getType()==Ws.TYPE),sn&&on.assert(a.getType()==Ws.TYPE),Fm(t,r.getShape(),e,a.getShape(),o)}function ti(t,e,r,i){for(var o=t.m_count,a=r.m_count,h=t.m_normals,c=t.m_vertices,u=r.m_vertices,_=bi.mulTXf(i,e),f=0,m=-1/0,p=0;p<o;++p){for(var v=Ys.mulVec2(_.q,h[p]),g=bi.mulVec2(_,c[p]),y=1/0,w=0;w<a;++w){var b=hr.dot(v,u[w])-hr.dot(v,g);b<y&&(y=b)}y>m&&(m=y,f=p)}ti._maxSeparation=m,ti._bestIndex=f}function kp(t,e,r,i,o,a){var h=e.m_normals,c=o.m_count,u=o.m_vertices,_=o.m_normals;sn&&on.assert(0<=i&&i<e.m_count);for(var f=Ys.mulT(a.q,Ys.mulVec2(r.q,h[i])),m=0,p=1/0,v=0;v<c;++v){var g=hr.dot(f,_[v]);g<p&&(p=g,m=v)}var y=m,w=y+1<c?y+1:0;t[0].v=bi.mulVec2(a,u[y]),t[0].id.cf.indexA=i,t[0].id.cf.indexB=y,t[0].id.cf.typeA=Qe.e_face,t[0].id.cf.typeB=Qe.e_vertex,t[1].v=bi.mulVec2(a,u[w]),t[1].id.cf.indexA=i,t[1].id.cf.indexB=w,t[1].id.cf.typeA=Qe.e_face,t[1].id.cf.typeB=Qe.e_vertex}function Fm(t,e,r,i,o){t.pointCount=0;var a=e.m_radius+i.m_radius;ti(e,r,i,o);var h=ti._bestIndex,c=ti._maxSeparation;if(!(c>a)){ti(i,o,e,r);var u=ti._bestIndex,_=ti._maxSeparation;if(!(_>a)){var f,m,p,v,g,y,w=.1*Pp.linearSlop;_>c+w?(f=i,m=e,p=o,v=r,g=u,t.type=Qe.e_faceB,y=1):(f=e,m=i,p=r,v=o,g=h,t.type=Qe.e_faceA,y=0);var b=[new Qe.clipVertex,new Qe.clipVertex];kp(b,f,p,g,m,v);var T=f.m_count,M=f.m_vertices,I=g,z=g+1<T?g+1:0,V=M[I],N=M[z],L=hr.sub(N,V);L.normalize();var J=hr.cross(L,1),D=hr.combine(.5,V,.5,N),O=Ys.mulVec2(p.q,L),q=hr.cross(O,1);V=bi.mulVec2(p,V),N=bi.mulVec2(p,N);var bt=hr.dot(q,V),Q=-hr.dot(O,V)+a,se=hr.dot(O,N)+a,Pt=[new Qe.clipVertex,new Qe.clipVertex],dt=[new Qe.clipVertex,new Qe.clipVertex],ot;if(ot=Qe.clipSegmentToLine(Pt,b,hr.neg(O),Q,I),!(ot<2)&&(ot=Qe.clipSegmentToLine(dt,Pt,O,se,z),!(ot<2))){t.localNormal=J,t.localPoint=D;for(var Vt=0,at=0;at<dt.length;++at){var it=hr.dot(q,dt[at].v)-bt;if(it<=a){var xt=t.points[Vt];if(xt.localPoint.set(bi.mulTVec2(v,dt[at].v)),xt.id=dt[at].id,y){var _e=xt.id.cf,Je=_e.indexA,Ue=_e.indexB,nr=_e.typeA,Ir=_e.typeB;_e.indexA=Ue,_e.indexB=Je,_e.typeA=Ir,_e.typeB=nr}++Vt}}t.pointCount=Vt}}}}var qh=typeof ASSERT=="undefined"?!1:ASSERT,Dh=wt,Fp=Rt.exports,Nh=Ge,ir=ut,ar=vr.exports,Rp=ui,Rm=lo,qm=gs;Rp.addType(qm.TYPE,Rm.TYPE,qp);function qp(t,e,r,i,o,a,h){qh&&Dh.assert(r.getType()==qm.TYPE),qh&&Dh.assert(a.getType()==Rm.TYPE),Dp(t,r.getShape(),e,a.getShape(),o)}function Dp(t,e,r,i,o){t.pointCount=0;for(var a=Nh.mulVec2(o,i.m_p),h=Nh.mulTVec2(r,a),c=0,u=-1/0,_=e.m_radius+i.m_radius,f=e.m_count,m=e.m_vertices,p=e.m_normals,v=0;v<f;++v){var g=ir.dot(p[v],ir.sub(h,m[v]));if(g>_)return;g>u&&(u=g,c=v)}var y=c,w=y+1<f?y+1:0,b=m[y],T=m[w];if(u<Fp.EPSILON){t.pointCount=1,t.type=ar.e_faceA,t.localNormal.set(p[c]),t.localPoint.setCombine(.5,b,.5,T),t.points[0].localPoint=i.m_p,t.points[0].id.cf.indexA=0,t.points[0].id.cf.typeA=ar.e_vertex,t.points[0].id.cf.indexB=0,t.points[0].id.cf.typeB=ar.e_vertex;return}var M=ir.dot(ir.sub(h,b),ir.sub(T,b)),I=ir.dot(ir.sub(h,T),ir.sub(b,T));if(M<=0){if(ir.distanceSquared(h,b)>_*_)return;t.pointCount=1,t.type=ar.e_faceA,t.localNormal.setCombine(1,h,-1,b),t.localNormal.normalize(),t.localPoint=b,t.points[0].localPoint.set(i.m_p),t.points[0].id.cf.indexA=0,t.points[0].id.cf.typeA=ar.e_vertex,t.points[0].id.cf.indexB=0,t.points[0].id.cf.typeB=ar.e_vertex}else if(I<=0){if(ir.distanceSquared(h,T)>_*_)return;t.pointCount=1,t.type=ar.e_faceA,t.localNormal.setCombine(1,h,-1,T),t.localNormal.normalize(),t.localPoint.set(T),t.points[0].localPoint.set(i.m_p),t.points[0].id.cf.indexA=0,t.points[0].id.cf.typeA=ar.e_vertex,t.points[0].id.cf.indexB=0,t.points[0].id.cf.typeB=ar.e_vertex}else{var z=ir.mid(b,T),u=ir.dot(h,p[y])-ir.dot(z,p[y]);if(u>_)return;t.pointCount=1,t.type=ar.e_faceA,t.localNormal.set(p[y]),t.localPoint.set(z),t.points[0].localPoint.set(i.m_p),t.points[0].id.cf.indexA=0,t.points[0].id.cf.typeA=ar.e_vertex,t.points[0].id.cf.indexB=0,t.points[0].id.cf.typeB=ar.e_vertex}}var js=typeof ASSERT=="undefined"?!1:ASSERT,Hs=wt,Np=Rt.exports,Es=Ge,et=ut,Op=ae,Ri=Ae,Dm=ui,Te=vr.exports,En=co,Nm=Tn,_o=gs;Dm.addType(En.TYPE,_o.TYPE,Gp);Dm.addType(Nm.TYPE,_o.TYPE,Jp);function Gp(t,e,r,i,o,a,h){js&&Hs.assert(r.getType()==En.TYPE),js&&Hs.assert(a.getType()==_o.TYPE),Gm(t,r.getShape(),e,a.getShape(),o)}function Jp(t,e,r,i,o,a,h){js&&Hs.assert(r.getType()==Nm.TYPE),js&&Hs.assert(a.getType()==_o.TYPE);var c=r.getShape(),u=new En;c.getChildEdge(u,i),Gm(t,u,e,a.getShape(),o)}var Ps=-1,Vs=1,Oh=2;function Om(){this.type,this.index,this.separation}function Up(){this.vertices=[],this.normals=[],this.count=0}function Yp(){this.i1,this.i2,this.v1,this.v2,this.normal=et.zero(),this.sideNormal1=et.zero(),this.sideOffset1,this.sideNormal2=et.zero(),this.sideOffset2}var Er=new Om,Ye=new Om,be=new Up,tt=new Yp;function Gm(t,e,r,i,o){var a=Es.mulTXf(r,o),h=Es.mulVec2(a,i.m_centroid),c=e.m_vertex0,u=e.m_vertex1,_=e.m_vertex2,f=e.m_vertex3,m=e.m_hasVertex0,p=e.m_hasVertex3,v=et.sub(_,u);v.normalize();var g=et.neo(v.y,-v.x),y=et.dot(g,et.sub(h,u)),w=0,b=0,T=!1,M=!1;if(m){var I=et.sub(u,c);I.normalize();var z=et.neo(I.y,-I.x);T=et.cross(I,v)>=0,w=et.dot(z,h)-et.dot(z,c)}if(p){var V=et.sub(f,_);V.normalize();var N=et.neo(V.y,-V.x);M=et.cross(v,V)>0,b=et.dot(N,h)-et.dot(N,_)}var L,J=et.zero(),D=et.zero(),O=et.zero();m&&p?T&&M?(L=w>=0||y>=0||b>=0,L?(J.set(g),D.set(z),O.set(N)):(J.setMul(-1,g),D.setMul(-1,g),O.setMul(-1,g))):T?(L=w>=0||y>=0&&b>=0,L?(J.set(g),D.set(z),O.set(g)):(J.setMul(-1,g),D.setMul(-1,N),O.setMul(-1,g))):M?(L=b>=0||w>=0&&y>=0,L?(J.set(g),D.set(g),O.set(N)):(J.setMul(-1,g),D.setMul(-1,g),O.setMul(-1,z))):(L=w>=0&&y>=0&&b>=0,L?(J.set(g),D.set(g),O.set(g)):(J.setMul(-1,g),D.setMul(-1,N),O.setMul(-1,z))):m?T?(L=w>=0||y>=0,L?(J.set(g),D.set(z),O.setMul(-1,g)):(J.setMul(-1,g),D.set(g),O.setMul(-1,g))):(L=w>=0&&y>=0,L?(J.set(g),D.set(g),O.setMul(-1,g)):(J.setMul(-1,g),D.set(g),O.setMul(-1,z))):p?M?(L=y>=0||b>=0,L?(J.set(g),D.setMul(-1,g),O.set(N)):(J.setMul(-1,g),D.setMul(-1,g),O.set(g))):(L=y>=0&&b>=0,L?(J.set(g),D.setMul(-1,g),O.set(g)):(J.setMul(-1,g),D.setMul(-1,N),O.set(g))):(L=y>=0,L?(J.set(g),D.setMul(-1,g),O.setMul(-1,g)):(J.setMul(-1,g),D.set(g),O.set(g))),be.count=i.m_count;for(var q=0;q<i.m_count;++q)be.vertices[q]=Es.mulVec2(a,i.m_vertices[q]),be.normals[q]=Op.mulVec2(a.q,i.m_normals[q]);var bt=2*Ri.polygonRadius;t.pointCount=0;{Er.type=Vs,Er.index=L?0:1,Er.separation=1/0;for(var q=0;q<be.count;++q){var Q=et.dot(J,et.sub(be.vertices[q],u));Q<Er.separation&&(Er.separation=Q)}}if(Er.type!=Ps&&!(Er.separation>bt)){{Ye.type=Ps,Ye.index=-1,Ye.separation=-1/0;for(var se=et.neo(-J.y,J.x),q=0;q<be.count;++q){var Pt=et.neg(be.normals[q]),dt=et.dot(Pt,et.sub(be.vertices[q],u)),ot=et.dot(Pt,et.sub(be.vertices[q],_)),Q=Np.min(dt,ot);if(Q>bt){Ye.type=Oh,Ye.index=q,Ye.separation=Q;break}if(et.dot(Pt,se)>=0){if(et.dot(et.sub(Pt,O),J)<-Ri.angularSlop)continue}else if(et.dot(et.sub(Pt,D),J)<-Ri.angularSlop)continue;Q>Ye.separation&&(Ye.type=Oh,Ye.index=q,Ye.separation=Q)}}if(!(Ye.type!=Ps&&Ye.separation>bt)){var Vt=.98,at=.001,it;Ye.type==Ps?it=Er:Ye.separation>Vt*Er.separation+at?it=Ye:it=Er;var xt=[new Te.clipVertex,new Te.clipVertex];if(it.type==Vs){t.type=Te.e_faceA;for(var _e=0,Je=et.dot(J,be.normals[0]),q=1;q<be.count;++q){var Ue=et.dot(J,be.normals[q]);Ue<Je&&(Je=Ue,_e=q)}var nr=_e,Ir=nr+1<be.count?nr+1:0;xt[0].v=be.vertices[nr],xt[0].id.cf.indexA=0,xt[0].id.cf.indexB=nr,xt[0].id.cf.typeA=Te.e_face,xt[0].id.cf.typeB=Te.e_vertex,xt[1].v=be.vertices[Ir],xt[1].id.cf.indexA=0,xt[1].id.cf.indexB=Ir,xt[1].id.cf.typeA=Te.e_face,xt[1].id.cf.typeB=Te.e_vertex,L?(tt.i1=0,tt.i2=1,tt.v1=u,tt.v2=_,tt.normal.set(g)):(tt.i1=1,tt.i2=0,tt.v1=_,tt.v2=u,tt.normal.setMul(-1,g))}else t.type=Te.e_faceB,xt[0].v=u,xt[0].id.cf.indexA=0,xt[0].id.cf.indexB=it.index,xt[0].id.cf.typeA=Te.e_vertex,xt[0].id.cf.typeB=Te.e_face,xt[1].v=_,xt[1].id.cf.indexA=0,xt[1].id.cf.indexB=it.index,xt[1].id.cf.typeA=Te.e_vertex,xt[1].id.cf.typeB=Te.e_face,tt.i1=it.index,tt.i2=tt.i1+1<be.count?tt.i1+1:0,tt.v1=be.vertices[tt.i1],tt.v2=be.vertices[tt.i2],tt.normal.set(be.normals[tt.i1]);tt.sideNormal1.set(tt.normal.y,-tt.normal.x),tt.sideNormal2.setMul(-1,tt.sideNormal1),tt.sideOffset1=et.dot(tt.sideNormal1,tt.v1),tt.sideOffset2=et.dot(tt.sideNormal2,tt.v2);var jr=[new Te.clipVertex,new Te.clipVertex],$e=[new Te.clipVertex,new Te.clipVertex],Fr;if(Fr=Te.clipSegmentToLine(jr,xt,tt.sideNormal1,tt.sideOffset1,tt.i1),!(Fr<Ri.maxManifoldPoints)&&(Fr=Te.clipSegmentToLine($e,jr,tt.sideNormal2,tt.sideOffset2,tt.i2),!(Fr<Ri.maxManifoldPoints))){it.type==Vs?(t.localNormal=et.clone(tt.normal),t.localPoint=et.clone(tt.v1)):(t.localNormal=et.clone(i.m_normals[tt.i1]),t.localPoint=et.clone(i.m_vertices[tt.i1]));for(var $r=0,q=0;q<Ri.maxManifoldPoints;++q){var Wi=et.dot(tt.normal,et.sub($e[q].v,tt.v1));if(Wi<=bt){var Rr=t.points[$r];it.type==Vs?(Rr.localPoint=Es.mulT(a,$e[q].v),Rr.id=$e[q].id):(Rr.localPoint=$e[q].v,Rr.id.cf.typeA=$e[q].id.cf.typeB,Rr.id.cf.typeB=$e[q].id.cf.typeA,Rr.id.cf.indexA=$e[q].id.cf.indexB,Rr.id.cf.indexB=$e[q].id.cf.indexA),++$r}}t.pointCount=$r}}}}var Wp=Yt,jp=er,Fs=Ae,Zs=Rt.exports,Lt=ut,ri=ae,Pn=Xe,Gh=Ze;Yt.TYPE="distance-joint";Pn.TYPES[Yt.TYPE]=Yt;Yt._super=Pn;Yt.prototype=Object.create(Yt._super.prototype);var Hp={frequencyHz:0,dampingRatio:0};function Yt(t,e,r,i,o){if(!(this instanceof Yt))return new Yt(t,e,r,i,o);if(r&&i&&"m_type"in i&&"x"in r&&"y"in r){var a=r;r=i,i=a}t=jp(t,Hp),Pn.call(this,t,e,r),e=this.m_bodyA,r=this.m_bodyB,this.m_type=Yt.TYPE,this.m_localAnchorA=Lt.clone(i?e.getLocalPoint(i):t.localAnchorA||Lt.zero()),this.m_localAnchorB=Lt.clone(o?r.getLocalPoint(o):t.localAnchorB||Lt.zero()),this.m_length=Zs.isFinite(t.length)?t.length:Lt.distance(e.getWorldPoint(this.m_localAnchorA),r.getWorldPoint(this.m_localAnchorB)),this.m_frequencyHz=t.frequencyHz,this.m_dampingRatio=t.dampingRatio,this.m_impulse=0,this.m_gamma=0,this.m_bias=0,this.m_u,this.m_rA,this.m_rB,this.m_localCenterA,this.m_localCenterB,this.m_invMassA,this.m_invMassB,this.m_invIA,this.m_invIB,this.m_mass}Yt.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,frequencyHz:this.m_frequencyHz,dampingRatio:this.m_dampingRatio,localAnchorA:this.m_localAnchorA,localAnchorB:this.m_localAnchorB,length:this.m_length,impulse:this.m_impulse,gamma:this.m_gamma,bias:this.m_bias}};Yt._deserialize=function(t,e,r){t=Object.assign({},t),t.bodyA=r(Gh,t.bodyA,e),t.bodyB=r(Gh,t.bodyB,e);var i=new Yt(t);return i};Yt.prototype._setAnchors=function(t){t.anchorA?this.m_localAnchorA.set(this.m_bodyA.getLocalPoint(t.anchorA)):t.localAnchorA&&this.m_localAnchorA.set(t.localAnchorA),t.anchorB?this.m_localAnchorB.set(this.m_bodyB.getLocalPoint(t.anchorB)):t.localAnchorB&&this.m_localAnchorB.set(t.localAnchorB),t.length>0?this.m_length=+t.length:t.length<0||(t.anchorA||t.anchorA||t.anchorA||t.anchorA)&&(this.m_length=Lt.distance(this.m_bodyA.getWorldPoint(this.m_localAnchorA),this.m_bodyB.getWorldPoint(this.m_localAnchorB)))};Yt.prototype.getLocalAnchorA=function(){return this.m_localAnchorA};Yt.prototype.getLocalAnchorB=function(){return this.m_localAnchorB};Yt.prototype.setLength=function(t){this.m_length=t};Yt.prototype.getLength=function(){return this.m_length};Yt.prototype.setFrequency=function(t){this.m_frequencyHz=t};Yt.prototype.getFrequency=function(){return this.m_frequencyHz};Yt.prototype.setDampingRatio=function(t){this.m_dampingRatio=t};Yt.prototype.getDampingRatio=function(){return this.m_dampingRatio};Yt.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)};Yt.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)};Yt.prototype.getReactionForce=function(t){return Lt.mul(this.m_impulse,this.m_u).mul(t)};Yt.prototype.getReactionTorque=function(t){return 0};Yt.prototype.initVelocityConstraints=function(t){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var e=this.m_bodyA.c_position.c,r=this.m_bodyA.c_position.a,i=this.m_bodyA.c_velocity.v,o=this.m_bodyA.c_velocity.w,a=this.m_bodyB.c_position.c,h=this.m_bodyB.c_position.a,c=this.m_bodyB.c_velocity.v,u=this.m_bodyB.c_velocity.w,_=ri.neo(r),f=ri.neo(h);this.m_rA=ri.mulVec2(_,Lt.sub(this.m_localAnchorA,this.m_localCenterA)),this.m_rB=ri.mulVec2(f,Lt.sub(this.m_localAnchorB,this.m_localCenterB)),this.m_u=Lt.sub(Lt.add(a,this.m_rB),Lt.add(e,this.m_rA));var m=this.m_u.length();m>Fs.linearSlop?this.m_u.mul(1/m):this.m_u.set(0,0);var p=Lt.cross(this.m_rA,this.m_u),v=Lt.cross(this.m_rB,this.m_u),g=this.m_invMassA+this.m_invIA*p*p+this.m_invMassB+this.m_invIB*v*v;if(this.m_mass=g!=0?1/g:0,this.m_frequencyHz>0){var y=m-this.m_length,w=2*Zs.PI*this.m_frequencyHz,b=2*this.m_mass*this.m_dampingRatio*w,T=this.m_mass*w*w,M=t.dt;this.m_gamma=M*(b+M*T),this.m_gamma=this.m_gamma!=0?1/this.m_gamma:0,this.m_bias=y*M*T*this.m_gamma,g+=this.m_gamma,this.m_mass=g!=0?1/g:0}else this.m_gamma=0,this.m_bias=0;if(t.warmStarting){this.m_impulse*=t.dtRatio;var I=Lt.mul(this.m_impulse,this.m_u);i.subMul(this.m_invMassA,I),o-=this.m_invIA*Lt.cross(this.m_rA,I),c.addMul(this.m_invMassB,I),u+=this.m_invIB*Lt.cross(this.m_rB,I)}else this.m_impulse=0;this.m_bodyA.c_velocity.v.set(i),this.m_bodyA.c_velocity.w=o,this.m_bodyB.c_velocity.v.set(c),this.m_bodyB.c_velocity.w=u};Yt.prototype.solveVelocityConstraints=function(t){var e=this.m_bodyA.c_velocity.v,r=this.m_bodyA.c_velocity.w,i=this.m_bodyB.c_velocity.v,o=this.m_bodyB.c_velocity.w,a=Lt.add(e,Lt.cross(r,this.m_rA)),h=Lt.add(i,Lt.cross(o,this.m_rB)),c=Lt.dot(this.m_u,h)-Lt.dot(this.m_u,a),u=-this.m_mass*(c+this.m_bias+this.m_gamma*this.m_impulse);this.m_impulse+=u;var _=Lt.mul(u,this.m_u);e.subMul(this.m_invMassA,_),r-=this.m_invIA*Lt.cross(this.m_rA,_),i.addMul(this.m_invMassB,_),o+=this.m_invIB*Lt.cross(this.m_rB,_),this.m_bodyA.c_velocity.v.set(e),this.m_bodyA.c_velocity.w=r,this.m_bodyB.c_velocity.v.set(i),this.m_bodyB.c_velocity.w=o};Yt.prototype.solvePositionConstraints=function(t){if(this.m_frequencyHz>0)return!0;var e=this.m_bodyA.c_position.c,r=this.m_bodyA.c_position.a,i=this.m_bodyB.c_position.c,o=this.m_bodyB.c_position.a,a=ri.neo(r),h=ri.neo(o),c=ri.mulSub(a,this.m_localAnchorA,this.m_localCenterA),u=ri.mulSub(h,this.m_localAnchorB,this.m_localCenterB),_=Lt.sub(Lt.add(i,u),Lt.add(e,c)),f=_.normalize(),m=f-this.m_length;m=Zs.clamp(m,-Fs.maxLinearCorrection,Fs.maxLinearCorrection);var p=-this.m_mass*m,v=Lt.mul(p,_);return e.subMul(this.m_invMassA,v),r-=this.m_invIA*Lt.cross(c,v),i.addMul(this.m_invMassB,v),o+=this.m_invIB*Lt.cross(u,v),this.m_bodyA.c_position.c.set(e),this.m_bodyA.c_position.a=r,this.m_bodyB.c_position.c.set(i),this.m_bodyB.c_position.a=o,Zs.abs(m)<Fs.linearSlop};var Jm=typeof ASSERT=="undefined"?!1:ASSERT,Zp=Kt,Um=wt,Xp=er,Vn=Rt.exports,fe=ut,Ym=Si,zs=ae,zn=Xe,Jh=Ze;Kt.TYPE="friction-joint";zn.TYPES[Kt.TYPE]=Kt;Kt._super=zn;Kt.prototype=Object.create(Kt._super.prototype);var Kp={maxForce:0,maxTorque:0};function Kt(t,e,r,i){if(!(this instanceof Kt))return new Kt(t,e,r,i);t=Xp(t,Kp),zn.call(this,t,e,r),e=this.m_bodyA,r=this.m_bodyB,this.m_type=Kt.TYPE,this.m_localAnchorA=fe.clone(i?e.getLocalPoint(i):t.localAnchorA||fe.zero()),this.m_localAnchorB=fe.clone(i?r.getLocalPoint(i):t.localAnchorB||fe.zero()),this.m_linearImpulse=fe.zero(),this.m_angularImpulse=0,this.m_maxForce=t.maxForce,this.m_maxTorque=t.maxTorque,this.m_rA,this.m_rB,this.m_localCenterA,this.m_localCenterB,this.m_invMassA,this.m_invMassB,this.m_invIA,this.m_invIB,this.m_linearMass,this.m_angularMass}Kt.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,maxForce:this.m_maxForce,maxTorque:this.m_maxTorque,localAnchorA:this.m_localAnchorA,localAnchorB:this.m_localAnchorB}};Kt._deserialize=function(t,e,r){t=Object.assign({},t),t.bodyA=r(Jh,t.bodyA,e),t.bodyB=r(Jh,t.bodyB,e);var i=new Kt(t);return i};Kt.prototype._setAnchors=function(t){t.anchorA?this.m_localAnchorA.set(this.m_bodyA.getLocalPoint(t.anchorA)):t.localAnchorA&&this.m_localAnchorA.set(t.localAnchorA),t.anchorB?this.m_localAnchorB.set(this.m_bodyB.getLocalPoint(t.anchorB)):t.localAnchorB&&this.m_localAnchorB.set(t.localAnchorB)};Kt.prototype.getLocalAnchorA=function(){return this.m_localAnchorA};Kt.prototype.getLocalAnchorB=function(){return this.m_localAnchorB};Kt.prototype.setMaxForce=function(t){Jm&&Um.assert(Vn.isFinite(t)&&t>=0),this.m_maxForce=t};Kt.prototype.getMaxForce=function(){return this.m_maxForce};Kt.prototype.setMaxTorque=function(t){Jm&&Um.assert(Vn.isFinite(t)&&t>=0),this.m_maxTorque=t};Kt.prototype.getMaxTorque=function(){return this.m_maxTorque};Kt.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)};Kt.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)};Kt.prototype.getReactionForce=function(t){return fe.mul(t,this.m_linearImpulse)};Kt.prototype.getReactionTorque=function(t){return t*this.m_angularImpulse};Kt.prototype.initVelocityConstraints=function(t){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var e=this.m_bodyA.c_position.a,r=this.m_bodyA.c_velocity.v,i=this.m_bodyA.c_velocity.w,o=this.m_bodyB.c_position.a,a=this.m_bodyB.c_velocity.v,h=this.m_bodyB.c_velocity.w,c=zs.neo(e),u=zs.neo(o);this.m_rA=zs.mulVec2(c,fe.sub(this.m_localAnchorA,this.m_localCenterA)),this.m_rB=zs.mulVec2(u,fe.sub(this.m_localAnchorB,this.m_localCenterB));var _=this.m_invMassA,f=this.m_invMassB,m=this.m_invIA,p=this.m_invIB,v=new Ym;if(v.ex.x=_+f+m*this.m_rA.y*this.m_rA.y+p*this.m_rB.y*this.m_rB.y,v.ex.y=-m*this.m_rA.x*this.m_rA.y-p*this.m_rB.x*this.m_rB.y,v.ey.x=v.ex.y,v.ey.y=_+f+m*this.m_rA.x*this.m_rA.x+p*this.m_rB.x*this.m_rB.x,this.m_linearMass=v.getInverse(),this.m_angularMass=m+p,this.m_angularMass>0&&(this.m_angularMass=1/this.m_angularMass),t.warmStarting){this.m_linearImpulse.mul(t.dtRatio),this.m_angularImpulse*=t.dtRatio;var g=fe.neo(this.m_linearImpulse.x,this.m_linearImpulse.y);r.subMul(_,g),i-=m*(fe.cross(this.m_rA,g)+this.m_angularImpulse),a.addMul(f,g),h+=p*(fe.cross(this.m_rB,g)+this.m_angularImpulse)}else this.m_linearImpulse.setZero(),this.m_angularImpulse=0;this.m_bodyA.c_velocity.v=r,this.m_bodyA.c_velocity.w=i,this.m_bodyB.c_velocity.v=a,this.m_bodyB.c_velocity.w=h};Kt.prototype.solveVelocityConstraints=function(t){var e=this.m_bodyA.c_velocity.v,r=this.m_bodyA.c_velocity.w,i=this.m_bodyB.c_velocity.v,o=this.m_bodyB.c_velocity.w,a=this.m_invMassA,h=this.m_invMassB,c=this.m_invIA,u=this.m_invIB,_=t.dt;{var f=o-r,m=-this.m_angularMass*f,p=this.m_angularImpulse,v=_*this.m_maxTorque;this.m_angularImpulse=Vn.clamp(this.m_angularImpulse+m,-v,v),m=this.m_angularImpulse-p,r-=c*m,o+=u*m}{var f=fe.sub(fe.add(i,fe.cross(o,this.m_rB)),fe.add(e,fe.cross(r,this.m_rA))),m=fe.neg(Ym.mulVec2(this.m_linearMass,f)),p=this.m_linearImpulse;this.m_linearImpulse.add(m);var v=_*this.m_maxForce;this.m_linearImpulse.lengthSquared()>v*v&&(this.m_linearImpulse.normalize(),this.m_linearImpulse.mul(v)),m=fe.sub(this.m_linearImpulse,p),e.subMul(a,m),r-=c*fe.cross(this.m_rA,m),i.addMul(h,m),o+=u*fe.cross(this.m_rB,m)}this.m_bodyA.c_velocity.v=e,this.m_bodyA.c_velocity.w=r,this.m_bodyB.c_velocity.v=i,this.m_bodyB.c_velocity.w=o};Kt.prototype.solvePositionConstraints=function(t){return!0};var Qp=typeof ASSERT=="undefined"?!1:ASSERT,Wm=yt,tf=wt,ef=er,Gr=Ae,di=Rt.exports,zt=ut,nn=Yi,rf=Si,sf=ho,ii=ae,Ln=Xe,Uh=Ze,_s=0,Xs=1,Ks=2,Qs=3;yt.TYPE="revolute-joint";Ln.TYPES[yt.TYPE]=yt;yt._super=Ln;yt.prototype=Object.create(yt._super.prototype);var of={lowerAngle:0,upperAngle:0,maxMotorTorque:0,motorSpeed:0,enableLimit:!1,enableMotor:!1};function yt(t,e,r,i){if(!(this instanceof yt))return new yt(t,e,r,i);t=ef(t,of),Ln.call(this,t,e,r),e=this.m_bodyA,r=this.m_bodyB,this.m_type=yt.TYPE,this.m_localAnchorA=zt.clone(i?e.getLocalPoint(i):t.localAnchorA||zt.zero()),this.m_localAnchorB=zt.clone(i?r.getLocalPoint(i):t.localAnchorB||zt.zero()),this.m_referenceAngle=di.isFinite(t.referenceAngle)?t.referenceAngle:r.getAngle()-e.getAngle(),this.m_impulse=nn(),this.m_motorImpulse=0,this.m_lowerAngle=t.lowerAngle,this.m_upperAngle=t.upperAngle,this.m_maxMotorTorque=t.maxMotorTorque,this.m_motorSpeed=t.motorSpeed,this.m_enableLimit=t.enableLimit,this.m_enableMotor=t.enableMotor,this.m_rA,this.m_rB,this.m_localCenterA,this.m_localCenterB,this.m_invMassA,this.m_invMassB,this.m_invIA,this.m_invIB,this.m_mass=new sf,this.m_motorMass,this.m_limitState=_s}yt.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,lowerAngle:this.m_lowerAngle,upperAngle:this.m_upperAngle,maxMotorTorque:this.m_maxMotorTorque,motorSpeed:this.m_motorSpeed,enableLimit:this.m_enableLimit,enableMotor:this.m_enableMotor,localAnchorA:this.m_localAnchorA,localAnchorB:this.m_localAnchorB,referenceAngle:this.m_referenceAngle}};yt._deserialize=function(t,e,r){t=Object.assign({},t),t.bodyA=r(Uh,t.bodyA,e),t.bodyB=r(Uh,t.bodyB,e);var i=new yt(t);return i};yt.prototype._setAnchors=function(t){t.anchorA?this.m_localAnchorA.set(this.m_bodyA.getLocalPoint(t.anchorA)):t.localAnchorA&&this.m_localAnchorA.set(t.localAnchorA),t.anchorB?this.m_localAnchorB.set(this.m_bodyB.getLocalPoint(t.anchorB)):t.localAnchorB&&this.m_localAnchorB.set(t.localAnchorB)};yt.prototype.getLocalAnchorA=function(){return this.m_localAnchorA};yt.prototype.getLocalAnchorB=function(){return this.m_localAnchorB};yt.prototype.getReferenceAngle=function(){return this.m_referenceAngle};yt.prototype.getJointAngle=function(){var t=this.m_bodyA,e=this.m_bodyB;return e.m_sweep.a-t.m_sweep.a-this.m_referenceAngle};yt.prototype.getJointSpeed=function(){var t=this.m_bodyA,e=this.m_bodyB;return e.m_angularVelocity-t.m_angularVelocity};yt.prototype.isMotorEnabled=function(){return this.m_enableMotor};yt.prototype.enableMotor=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_enableMotor=t};yt.prototype.getMotorTorque=function(t){return t*this.m_motorImpulse};yt.prototype.setMotorSpeed=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_motorSpeed=t};yt.prototype.getMotorSpeed=function(){return this.m_motorSpeed};yt.prototype.setMaxMotorTorque=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_maxMotorTorque=t};yt.prototype.getMaxMotorTorque=function(){return this.m_maxMotorTorque};yt.prototype.isLimitEnabled=function(){return this.m_enableLimit};yt.prototype.enableLimit=function(t){t!=this.m_enableLimit&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_enableLimit=t,this.m_impulse.z=0)};yt.prototype.getLowerLimit=function(){return this.m_lowerAngle};yt.prototype.getUpperLimit=function(){return this.m_upperAngle};yt.prototype.setLimits=function(t,e){Qp&&tf.assert(t<=e),(t!=this.m_lowerAngle||e!=this.m_upperAngle)&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_impulse.z=0,this.m_lowerAngle=t,this.m_upperAngle=e)};yt.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)};yt.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)};yt.prototype.getReactionForce=function(t){return zt.neo(this.m_impulse.x,this.m_impulse.y).mul(t)};yt.prototype.getReactionTorque=function(t){return t*this.m_impulse.z};yt.prototype.initVelocityConstraints=function(t){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var e=this.m_bodyA.c_position.a,r=this.m_bodyA.c_velocity.v,i=this.m_bodyA.c_velocity.w,o=this.m_bodyB.c_position.a,a=this.m_bodyB.c_velocity.v,h=this.m_bodyB.c_velocity.w,c=ii.neo(e),u=ii.neo(o);this.m_rA=ii.mulVec2(c,zt.sub(this.m_localAnchorA,this.m_localCenterA)),this.m_rB=ii.mulVec2(u,zt.sub(this.m_localAnchorB,this.m_localCenterB));var _=this.m_invMassA,f=this.m_invMassB,m=this.m_invIA,p=this.m_invIB,v=m+p===0;if(this.m_mass.ex.x=_+f+this.m_rA.y*this.m_rA.y*m+this.m_rB.y*this.m_rB.y*p,this.m_mass.ey.x=-this.m_rA.y*this.m_rA.x*m-this.m_rB.y*this.m_rB.x*p,this.m_mass.ez.x=-this.m_rA.y*m-this.m_rB.y*p,this.m_mass.ex.y=this.m_mass.ey.x,this.m_mass.ey.y=_+f+this.m_rA.x*this.m_rA.x*m+this.m_rB.x*this.m_rB.x*p,this.m_mass.ez.y=this.m_rA.x*m+this.m_rB.x*p,this.m_mass.ex.z=this.m_mass.ez.x,this.m_mass.ey.z=this.m_mass.ez.y,this.m_mass.ez.z=m+p,this.m_motorMass=m+p,this.m_motorMass>0&&(this.m_motorMass=1/this.m_motorMass),(this.m_enableMotor==!1||v)&&(this.m_motorImpulse=0),this.m_enableLimit&&v==!1){var g=o-e-this.m_referenceAngle;di.abs(this.m_upperAngle-this.m_lowerAngle)<2*Gr.angularSlop?this.m_limitState=Qs:g<=this.m_lowerAngle?(this.m_limitState!=Xs&&(this.m_impulse.z=0),this.m_limitState=Xs):g>=this.m_upperAngle?(this.m_limitState!=Ks&&(this.m_impulse.z=0),this.m_limitState=Ks):(this.m_limitState=_s,this.m_impulse.z=0)}else this.m_limitState=_s;if(t.warmStarting){this.m_impulse.mul(t.dtRatio),this.m_motorImpulse*=t.dtRatio;var y=zt.neo(this.m_impulse.x,this.m_impulse.y);r.subMul(_,y),i-=m*(zt.cross(this.m_rA,y)+this.m_motorImpulse+this.m_impulse.z),a.addMul(f,y),h+=p*(zt.cross(this.m_rB,y)+this.m_motorImpulse+this.m_impulse.z)}else this.m_impulse.setZero(),this.m_motorImpulse=0;this.m_bodyA.c_velocity.v=r,this.m_bodyA.c_velocity.w=i,this.m_bodyB.c_velocity.v=a,this.m_bodyB.c_velocity.w=h};yt.prototype.solveVelocityConstraints=function(t){var e=this.m_bodyA.c_velocity.v,r=this.m_bodyA.c_velocity.w,i=this.m_bodyB.c_velocity.v,o=this.m_bodyB.c_velocity.w,a=this.m_invMassA,h=this.m_invMassB,c=this.m_invIA,u=this.m_invIB,_=c+u===0;if(this.m_enableMotor&&this.m_limitState!=Qs&&_==!1){var f=o-r-this.m_motorSpeed,m=-this.m_motorMass*f,p=this.m_motorImpulse,v=t.dt*this.m_maxMotorTorque;this.m_motorImpulse=di.clamp(this.m_motorImpulse+m,-v,v),m=this.m_motorImpulse-p,r-=c*m,o+=u*m}if(this.m_enableLimit&&this.m_limitState!=_s&&_==!1){var g=zt.zero();g.addCombine(1,i,1,zt.cross(o,this.m_rB)),g.subCombine(1,e,1,zt.cross(r,this.m_rA));var y=o-r,f=nn(g.x,g.y,y),m=nn.neg(this.m_mass.solve33(f));if(this.m_limitState==Qs)this.m_impulse.add(m);else if(this.m_limitState==Xs){var w=this.m_impulse.z+m.z;if(w<0){var b=zt.combine(-1,g,this.m_impulse.z,zt.neo(this.m_mass.ez.x,this.m_mass.ez.y)),T=this.m_mass.solve22(b);m.x=T.x,m.y=T.y,m.z=-this.m_impulse.z,this.m_impulse.x+=T.x,this.m_impulse.y+=T.y,this.m_impulse.z=0}else this.m_impulse.add(m)}else if(this.m_limitState==Ks){var w=this.m_impulse.z+m.z;if(w>0){var b=zt.combine(-1,g,this.m_impulse.z,zt.neo(this.m_mass.ez.x,this.m_mass.ez.y)),T=this.m_mass.solve22(b);m.x=T.x,m.y=T.y,m.z=-this.m_impulse.z,this.m_impulse.x+=T.x,this.m_impulse.y+=T.y,this.m_impulse.z=0}else this.m_impulse.add(m)}var M=zt.neo(m.x,m.y);e.subMul(a,M),r-=c*(zt.cross(this.m_rA,M)+m.z),i.addMul(h,M),o+=u*(zt.cross(this.m_rB,M)+m.z)}else{var f=zt.zero();f.addCombine(1,i,1,zt.cross(o,this.m_rB)),f.subCombine(1,e,1,zt.cross(r,this.m_rA));var m=this.m_mass.solve22(zt.neg(f));this.m_impulse.x+=m.x,this.m_impulse.y+=m.y,e.subMul(a,m),r-=c*zt.cross(this.m_rA,m),i.addMul(h,m),o+=u*zt.cross(this.m_rB,m)}this.m_bodyA.c_velocity.v=e,this.m_bodyA.c_velocity.w=r,this.m_bodyB.c_velocity.v=i,this.m_bodyB.c_velocity.w=o};yt.prototype.solvePositionConstraints=function(t){var e=this.m_bodyA.c_position.c,r=this.m_bodyA.c_position.a,i=this.m_bodyB.c_position.c,o=this.m_bodyB.c_position.a,a=ii.neo(r),h=ii.neo(o),c=0,u=0,_=this.m_invIA+this.m_invIB==0;if(this.m_enableLimit&&this.m_limitState!=_s&&_==!1){var f=o-r-this.m_referenceAngle,m=0;if(this.m_limitState==Qs){var p=di.clamp(f-this.m_lowerAngle,-Gr.maxAngularCorrection,Gr.maxAngularCorrection);m=-this.m_motorMass*p,c=di.abs(p)}else if(this.m_limitState==Xs){var p=f-this.m_lowerAngle;c=-p,p=di.clamp(p+Gr.angularSlop,-Gr.maxAngularCorrection,0),m=-this.m_motorMass*p}else if(this.m_limitState==Ks){var p=f-this.m_upperAngle;c=p,p=di.clamp(p-Gr.angularSlop,0,Gr.maxAngularCorrection),m=-this.m_motorMass*p}r-=this.m_invIA*m,o+=this.m_invIB*m}{a.set(r),h.set(o);var v=ii.mulVec2(a,zt.sub(this.m_localAnchorA,this.m_localCenterA)),g=ii.mulVec2(h,zt.sub(this.m_localAnchorB,this.m_localCenterB)),p=zt.zero();p.addCombine(1,i,1,g),p.subCombine(1,e,1,v),u=p.length();var y=this.m_invMassA,w=this.m_invMassB,b=this.m_invIA,T=this.m_invIB,M=new rf;M.ex.x=y+w+b*v.y*v.y+T*g.y*g.y,M.ex.y=-b*v.x*v.y-T*g.x*g.y,M.ey.x=M.ex.y,M.ey.y=y+w+b*v.x*v.x+T*g.x*g.x;var I=zt.neg(M.solve(p));e.subMul(y,I),r-=b*zt.cross(v,I),i.addMul(w,I),o+=T*zt.cross(g,I)}return this.m_bodyA.c_position.c.set(e),this.m_bodyA.c_position.a=r,this.m_bodyB.c_position.c.set(i),this.m_bodyB.c_position.a=o,u<=Gr.linearSlop&&c<=Gr.angularSlop};var nf=typeof ASSERT=="undefined"?!1:ASSERT,jm=ct,af=wt,hf=er,rs=Ae,We=Rt.exports,Y=ut,si=Yi,mf=Si,Hm=ho,He=ae,kn=Xe,Yh=Ze,to=0,an=1,hn=2,Zm=3;ct.TYPE="prismatic-joint";kn.TYPES[ct.TYPE]=ct;ct._super=kn;ct.prototype=Object.create(ct._super.prototype);var lf={enableLimit:!1,lowerTranslation:0,upperTranslation:0,enableMotor:!1,maxMotorForce:0,motorSpeed:0};function ct(t,e,r,i,o){if(!(this instanceof ct))return new ct(t,e,r,i,o);t=hf(t,lf),kn.call(this,t,e,r),e=this.m_bodyA,r=this.m_bodyB,this.m_type=ct.TYPE,this.m_localAnchorA=Y.clone(i?e.getLocalPoint(i):t.localAnchorA||Y.zero()),this.m_localAnchorB=Y.clone(i?r.getLocalPoint(i):t.localAnchorB||Y.zero()),this.m_localXAxisA=Y.clone(o?e.getLocalVector(o):t.localAxisA||Y.neo(1,0)),this.m_localXAxisA.normalize(),this.m_localYAxisA=Y.cross(1,this.m_localXAxisA),this.m_referenceAngle=We.isFinite(t.referenceAngle)?t.referenceAngle:r.getAngle()-e.getAngle(),this.m_impulse=si(),this.m_motorMass=0,this.m_motorImpulse=0,this.m_lowerTranslation=t.lowerTranslation,this.m_upperTranslation=t.upperTranslation,this.m_maxMotorForce=t.maxMotorForce,this.m_motorSpeed=t.motorSpeed,this.m_enableLimit=t.enableLimit,this.m_enableMotor=t.enableMotor,this.m_limitState=to,this.m_axis=Y.zero(),this.m_perp=Y.zero(),this.m_localCenterA,this.m_localCenterB,this.m_invMassA,this.m_invMassB,this.m_invIA,this.m_invIB,this.m_axis,this.m_perp,this.m_s1,this.m_s2,this.m_a1,this.m_a2,this.m_K=new Hm,this.m_motorMass}ct.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,lowerTranslation:this.m_lowerTranslation,upperTranslation:this.m_upperTranslation,maxMotorForce:this.m_maxMotorForce,motorSpeed:this.m_motorSpeed,enableLimit:this.m_enableLimit,enableMotor:this.m_enableMotor,localAnchorA:this.m_localAnchorA,localAnchorB:this.m_localAnchorB,localAxisA:this.m_localXAxisA,referenceAngle:this.m_referenceAngle}};ct._deserialize=function(t,e,r){t=Object.assign({},t),t.bodyA=r(Yh,t.bodyA,e),t.bodyB=r(Yh,t.bodyB,e),t.localAxisA=Y(t.localAxisA);var i=new ct(t);return i};ct.prototype._setAnchors=function(t){t.anchorA?this.m_localAnchorA.set(this.m_bodyA.getLocalPoint(t.anchorA)):t.localAnchorA&&this.m_localAnchorA.set(t.localAnchorA),t.anchorB?this.m_localAnchorB.set(this.m_bodyB.getLocalPoint(t.anchorB)):t.localAnchorB&&this.m_localAnchorB.set(t.localAnchorB),t.localAxisA&&(this.m_localXAxisA.set(t.localAxisA),this.m_localYAxisA.set(Y.cross(1,t.localAxisA)))};ct.prototype.getLocalAnchorA=function(){return this.m_localAnchorA};ct.prototype.getLocalAnchorB=function(){return this.m_localAnchorB};ct.prototype.getLocalAxisA=function(){return this.m_localXAxisA};ct.prototype.getReferenceAngle=function(){return this.m_referenceAngle};ct.prototype.getJointTranslation=function(){var t=this.m_bodyA.getWorldPoint(this.m_localAnchorA),e=this.m_bodyB.getWorldPoint(this.m_localAnchorB),r=Y.sub(e,t),i=this.m_bodyA.getWorldVector(this.m_localXAxisA),o=Y.dot(r,i);return o};ct.prototype.getJointSpeed=function(){var t=this.m_bodyA,e=this.m_bodyB,r=He.mulVec2(t.m_xf.q,Y.sub(this.m_localAnchorA,t.m_sweep.localCenter)),i=He.mulVec2(e.m_xf.q,Y.sub(this.m_localAnchorB,e.m_sweep.localCenter)),o=Y.add(t.m_sweep.c,r),a=Y.add(e.m_sweep.c,i),h=Y.sub(a,o),c=He.mulVec2(t.m_xf.q,this.m_localXAxisA),u=t.m_linearVelocity,_=e.m_linearVelocity,f=t.m_angularVelocity,m=e.m_angularVelocity,p=Y.dot(h,Y.cross(f,c))+Y.dot(c,Y.sub(Y.addCross(_,m,i),Y.addCross(u,f,r)));return p};ct.prototype.isLimitEnabled=function(){return this.m_enableLimit};ct.prototype.enableLimit=function(t){t!=this.m_enableLimit&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_enableLimit=t,this.m_impulse.z=0)};ct.prototype.getLowerLimit=function(){return this.m_lowerTranslation};ct.prototype.getUpperLimit=function(){return this.m_upperTranslation};ct.prototype.setLimits=function(t,e){nf&&af.assert(t<=e),(t!=this.m_lowerTranslation||e!=this.m_upperTranslation)&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_lowerTranslation=t,this.m_upperTranslation=e,this.m_impulse.z=0)};ct.prototype.isMotorEnabled=function(){return this.m_enableMotor};ct.prototype.enableMotor=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_enableMotor=t};ct.prototype.setMotorSpeed=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_motorSpeed=t};ct.prototype.setMaxMotorForce=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_maxMotorForce=t};ct.prototype.getMaxMotorForce=function(){return this.m_maxMotorForce};ct.prototype.getMotorSpeed=function(){return this.m_motorSpeed};ct.prototype.getMotorForce=function(t){return t*this.m_motorImpulse};ct.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)};ct.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)};ct.prototype.getReactionForce=function(t){return Y.combine(this.m_impulse.x,this.m_perp,this.m_motorImpulse+this.m_impulse.z,this.m_axis).mul(t)};ct.prototype.getReactionTorque=function(t){return t*this.m_impulse.y};ct.prototype.initVelocityConstraints=function(t){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var e=this.m_bodyA.c_position.c,r=this.m_bodyA.c_position.a,i=this.m_bodyA.c_velocity.v,o=this.m_bodyA.c_velocity.w,a=this.m_bodyB.c_position.c,h=this.m_bodyB.c_position.a,c=this.m_bodyB.c_velocity.v,u=this.m_bodyB.c_velocity.w,_=He.neo(r),f=He.neo(h),m=He.mulVec2(_,Y.sub(this.m_localAnchorA,this.m_localCenterA)),p=He.mulVec2(f,Y.sub(this.m_localAnchorB,this.m_localCenterB)),v=Y.zero();v.addCombine(1,a,1,p),v.subCombine(1,e,1,m);var g=this.m_invMassA,y=this.m_invMassB,w=this.m_invIA,b=this.m_invIB;this.m_axis=He.mulVec2(_,this.m_localXAxisA),this.m_a1=Y.cross(Y.add(v,m),this.m_axis),this.m_a2=Y.cross(p,this.m_axis),this.m_motorMass=g+y+w*this.m_a1*this.m_a1+b*this.m_a2*this.m_a2,this.m_motorMass>0&&(this.m_motorMass=1/this.m_motorMass);{this.m_perp=He.mulVec2(_,this.m_localYAxisA),this.m_s1=Y.cross(Y.add(v,m),this.m_perp),this.m_s2=Y.cross(p,this.m_perp),Y.cross(m,this.m_perp);var T=g+y+w*this.m_s1*this.m_s1+b*this.m_s2*this.m_s2,M=w*this.m_s1+b*this.m_s2,I=w*this.m_s1*this.m_a1+b*this.m_s2*this.m_a2,z=w+b;z==0&&(z=1);var V=w*this.m_a1+b*this.m_a2,N=g+y+w*this.m_a1*this.m_a1+b*this.m_a2*this.m_a2;this.m_K.ex.set(T,M,I),this.m_K.ey.set(M,z,V),this.m_K.ez.set(I,V,N)}if(this.m_enableLimit){var L=Y.dot(this.m_axis,v);We.abs(this.m_upperTranslation-this.m_lowerTranslation)<2*rs.linearSlop?this.m_limitState=Zm:L<=this.m_lowerTranslation?this.m_limitState!=an&&(this.m_limitState=an,this.m_impulse.z=0):L>=this.m_upperTranslation?this.m_limitState!=hn&&(this.m_limitState=hn,this.m_impulse.z=0):(this.m_limitState=to,this.m_impulse.z=0)}else this.m_limitState=to,this.m_impulse.z=0;if(this.m_enableMotor==!1&&(this.m_motorImpulse=0),t.warmStarting){this.m_impulse.mul(t.dtRatio),this.m_motorImpulse*=t.dtRatio;var J=Y.combine(this.m_impulse.x,this.m_perp,this.m_motorImpulse+this.m_impulse.z,this.m_axis),D=this.m_impulse.x*this.m_s1+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a1,O=this.m_impulse.x*this.m_s2+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a2;i.subMul(g,J),o-=w*D,c.addMul(y,J),u+=b*O}else this.m_impulse.setZero(),this.m_motorImpulse=0;this.m_bodyA.c_velocity.v.set(i),this.m_bodyA.c_velocity.w=o,this.m_bodyB.c_velocity.v.set(c),this.m_bodyB.c_velocity.w=u};ct.prototype.solveVelocityConstraints=function(t){var e=this.m_bodyA.c_velocity.v,r=this.m_bodyA.c_velocity.w,i=this.m_bodyB.c_velocity.v,o=this.m_bodyB.c_velocity.w,a=this.m_invMassA,h=this.m_invMassB,c=this.m_invIA,u=this.m_invIB;if(this.m_enableMotor&&this.m_limitState!=Zm){var _=Y.dot(this.m_axis,Y.sub(i,e))+this.m_a2*o-this.m_a1*r,f=this.m_motorMass*(this.m_motorSpeed-_),m=this.m_motorImpulse,p=t.dt*this.m_maxMotorForce;this.m_motorImpulse=We.clamp(this.m_motorImpulse+f,-p,p),f=this.m_motorImpulse-m;var v=Y.mul(f,this.m_axis),g=f*this.m_a1,y=f*this.m_a2;e.subMul(a,v),r-=c*g,i.addMul(h,v),o+=u*y}var w=Y.zero();if(w.x+=Y.dot(this.m_perp,i)+this.m_s2*o,w.x-=Y.dot(this.m_perp,e)+this.m_s1*r,w.y=o-r,this.m_enableLimit&&this.m_limitState!=to){var b=0;b+=Y.dot(this.m_axis,i)+this.m_a2*o,b-=Y.dot(this.m_axis,e)+this.m_a1*r;var _=si(w.x,w.y,b),T=si(this.m_impulse),M=this.m_K.solve33(si.neg(_));this.m_impulse.add(M),this.m_limitState==an?this.m_impulse.z=We.max(this.m_impulse.z,0):this.m_limitState==hn&&(this.m_impulse.z=We.min(this.m_impulse.z,0));var I=Y.combine(-1,w,-(this.m_impulse.z-T.z),Y.neo(this.m_K.ez.x,this.m_K.ez.y)),z=Y.add(this.m_K.solve22(I),Y.neo(T.x,T.y));this.m_impulse.x=z.x,this.m_impulse.y=z.y,M=si.sub(this.m_impulse,T);var v=Y.combine(M.x,this.m_perp,M.z,this.m_axis),g=M.x*this.m_s1+M.y+M.z*this.m_a1,y=M.x*this.m_s2+M.y+M.z*this.m_a2;e.subMul(a,v),r-=c*g,i.addMul(h,v),o+=u*y}else{var M=this.m_K.solve22(Y.neg(w));this.m_impulse.x+=M.x,this.m_impulse.y+=M.y;var v=Y.mul(M.x,this.m_perp),g=M.x*this.m_s1+M.y,y=M.x*this.m_s2+M.y;e.subMul(a,v),r-=c*g,i.addMul(h,v),o+=u*y}this.m_bodyA.c_velocity.v=e,this.m_bodyA.c_velocity.w=r,this.m_bodyB.c_velocity.v=i,this.m_bodyB.c_velocity.w=o};ct.prototype.solvePositionConstraints=function(t){var e=this.m_bodyA.c_position.c,r=this.m_bodyA.c_position.a,i=this.m_bodyB.c_position.c,o=this.m_bodyB.c_position.a,a=He.neo(r),h=He.neo(o),c=this.m_invMassA,u=this.m_invMassB,_=this.m_invIA,f=this.m_invIB,m=He.mulVec2(a,Y.sub(this.m_localAnchorA,this.m_localCenterA)),p=He.mulVec2(h,Y.sub(this.m_localAnchorB,this.m_localCenterB)),v=Y.sub(Y.add(i,p),Y.add(e,m)),g=He.mulVec2(a,this.m_localXAxisA),y=Y.cross(Y.add(v,m),g),w=Y.cross(p,g),b=He.mulVec2(a,this.m_localYAxisA),T=Y.cross(Y.add(v,m),b),M=Y.cross(p,b),I=si(),z=Y.zero();z.x=Y.dot(b,v),z.y=o-r-this.m_referenceAngle;var V=We.abs(z.x),N=We.abs(z.y),L=rs.linearSlop,J=rs.maxLinearCorrection,D=!1,O=0;if(this.m_enableLimit){var q=Y.dot(g,v);We.abs(this.m_upperTranslation-this.m_lowerTranslation)<2*L?(O=We.clamp(q,-J,J),V=We.max(V,We.abs(q)),D=!0):q<=this.m_lowerTranslation?(O=We.clamp(q-this.m_lowerTranslation+L,-J,0),V=We.max(V,this.m_lowerTranslation-q),D=!0):q>=this.m_upperTranslation&&(O=We.clamp(q-this.m_upperTranslation-L,0,J),V=We.max(V,q-this.m_upperTranslation),D=!0)}if(D){var bt=c+u+_*T*T+f*M*M,Q=_*T+f*M,se=_*T*y+f*M*w,Pt=_+f;Pt==0&&(Pt=1);var dt=_*y+f*w,ot=c+u+_*y*y+f*w*w,Vt=new Hm;Vt.ex.set(bt,Q,se),Vt.ey.set(Q,Pt,dt),Vt.ez.set(se,dt,ot);var at=si();at.x=z.x,at.y=z.y,at.z=O,I=Vt.solve33(si.neg(at))}else{var bt=c+u+_*T*T+f*M*M,Q=_*T+f*M,Pt=_+f;Pt==0&&(Pt=1);var Vt=new mf;Vt.ex.set(bt,Q),Vt.ey.set(Q,Pt);var it=Vt.solve(Y.neg(z));I.x=it.x,I.y=it.y,I.z=0}var xt=Y.combine(I.x,b,I.z,g),_e=I.x*T+I.y+I.z*y,Je=I.x*M+I.y+I.z*w;return e.subMul(c,xt),r-=_*_e,i.addMul(u,xt),o+=f*Je,this.m_bodyA.c_position.c=e,this.m_bodyA.c_position.a=r,this.m_bodyB.c_position.c=i,this.m_bodyB.c_position.a=o,V<=rs.linearSlop&&N<=rs.angularSlop};var mn=typeof ASSERT=="undefined"?!1:ASSERT,cf=me,ln=wt,uf=er,_f=Ae,Xm=Rt.exports,lt=ut,ee=ae,vs=Xe,Wh=Ze,oi=Wm,jh=jm;me.TYPE="gear-joint";vs.TYPES[me.TYPE]=me;me._super=vs;me.prototype=Object.create(me._super.prototype);var vf={ratio:1};function me(t,e,r,i,o,a){if(!(this instanceof me))return new me(t,e,r,i,o,a);t=uf(t,vf),vs.call(this,t,e,r),e=this.m_bodyA,r=this.m_bodyB,this.m_type=me.TYPE,mn&&ln.assert(i.m_type===oi.TYPE||i.m_type===jh.TYPE),mn&&ln.assert(o.m_type===oi.TYPE||o.m_type===jh.TYPE),this.m_joint1=i||t.joint1,this.m_joint2=o||t.joint2,this.m_ratio=Xm.isFinite(a)?a:t.ratio,this.m_type1=this.m_joint1.getType(),this.m_type2=this.m_joint2.getType();var h,c;this.m_bodyC=this.m_joint1.getBodyA(),this.m_bodyA=this.m_joint1.getBodyB();var u=this.m_bodyA.m_xf,_=this.m_bodyA.m_sweep.a,f=this.m_bodyC.m_xf,m=this.m_bodyC.m_sweep.a;if(this.m_type1===oi.TYPE){var p=this.m_joint1;this.m_localAnchorC=p.m_localAnchorA,this.m_localAnchorA=p.m_localAnchorB,this.m_referenceAngleA=p.m_referenceAngle,this.m_localAxisC=lt.zero(),h=_-m-this.m_referenceAngleA}else{var v=this.m_joint1;this.m_localAnchorC=v.m_localAnchorA,this.m_localAnchorA=v.m_localAnchorB,this.m_referenceAngleA=v.m_referenceAngle,this.m_localAxisC=v.m_localXAxisA;var g=this.m_localAnchorC,y=ee.mulTVec2(f.q,lt.add(ee.mul(u.q,this.m_localAnchorA),lt.sub(u.p,f.p)));h=lt.dot(y,this.m_localAxisC)-lt.dot(g,this.m_localAxisC)}this.m_bodyD=this.m_joint2.getBodyA(),this.m_bodyB=this.m_joint2.getBodyB();var w=this.m_bodyB.m_xf,b=this.m_bodyB.m_sweep.a,T=this.m_bodyD.m_xf,M=this.m_bodyD.m_sweep.a;if(this.m_type2===oi.TYPE){var p=this.m_joint2;this.m_localAnchorD=p.m_localAnchorA,this.m_localAnchorB=p.m_localAnchorB,this.m_referenceAngleB=p.m_referenceAngle,this.m_localAxisD=lt.zero(),c=b-M-this.m_referenceAngleB}else{var v=this.m_joint2;this.m_localAnchorD=v.m_localAnchorA,this.m_localAnchorB=v.m_localAnchorB,this.m_referenceAngleB=v.m_referenceAngle,this.m_localAxisD=v.m_localXAxisA;var I=this.m_localAnchorD,z=ee.mulTVec2(T.q,lt.add(ee.mul(w.q,this.m_localAnchorB),lt.sub(w.p,T.p)));c=lt.dot(z,this.m_localAxisD)-lt.dot(I,this.m_localAxisD)}this.m_constant=h+this.m_ratio*c,this.m_impulse=0,this.m_lcA,this.m_lcB,this.m_lcC,this.m_lcD,this.m_mA,this.m_mB,this.m_mC,this.m_mD,this.m_iA,this.m_iB,this.m_iC,this.m_iD,this.m_JvAC,this.m_JvBD,this.m_JwA,this.m_JwB,this.m_JwC,this.m_JwD,this.m_mass}me.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,joint1:this.m_joint1,joint2:this.m_joint2,ratio:this.m_ratio}};me._deserialize=function(t,e,r){t=Object.assign({},t),t.bodyA=r(Wh,t.bodyA,e),t.bodyB=r(Wh,t.bodyB,e),t.joint1=r(vs,t.joint1,e),t.joint2=r(vs,t.joint2,e);var i=new me(t);return i};me.prototype.getJoint1=function(){return this.m_joint1};me.prototype.getJoint2=function(){return this.m_joint2};me.prototype.setRatio=function(t){mn&&ln.assert(Xm.isFinite(t)),this.m_ratio=t};me.prototype.getRatio=function(){return this.m_ratio};me.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)};me.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)};me.prototype.getReactionForce=function(t){return lt.mul(this.m_impulse,this.m_JvAC).mul(t)};me.prototype.getReactionTorque=function(t){var e=this.m_impulse*this.m_JwA;return t*e};me.prototype.initVelocityConstraints=function(t){this.m_lcA=this.m_bodyA.m_sweep.localCenter,this.m_lcB=this.m_bodyB.m_sweep.localCenter,this.m_lcC=this.m_bodyC.m_sweep.localCenter,this.m_lcD=this.m_bodyD.m_sweep.localCenter,this.m_mA=this.m_bodyA.m_invMass,this.m_mB=this.m_bodyB.m_invMass,this.m_mC=this.m_bodyC.m_invMass,this.m_mD=this.m_bodyD.m_invMass,this.m_iA=this.m_bodyA.m_invI,this.m_iB=this.m_bodyB.m_invI,this.m_iC=this.m_bodyC.m_invI,this.m_iD=this.m_bodyD.m_invI;var e=this.m_bodyA.c_position.a,r=this.m_bodyA.c_velocity.v,i=this.m_bodyA.c_velocity.w,o=this.m_bodyB.c_position.a,a=this.m_bodyB.c_velocity.v,h=this.m_bodyB.c_velocity.w,c=this.m_bodyC.c_position.a,u=this.m_bodyC.c_velocity.v,_=this.m_bodyC.c_velocity.w,f=this.m_bodyD.c_position.a,m=this.m_bodyD.c_velocity.v,p=this.m_bodyD.c_velocity.w,v=ee.neo(e),g=ee.neo(o),y=ee.neo(c),w=ee.neo(f);if(this.m_mass=0,this.m_type1==oi.TYPE)this.m_JvAC=lt.zero(),this.m_JwA=1,this.m_JwC=1,this.m_mass+=this.m_iA+this.m_iC;else{var b=ee.mulVec2(y,this.m_localAxisC),T=ee.mulSub(y,this.m_localAnchorC,this.m_lcC),M=ee.mulSub(v,this.m_localAnchorA,this.m_lcA);this.m_JvAC=b,this.m_JwC=lt.cross(T,b),this.m_JwA=lt.cross(M,b),this.m_mass+=this.m_mC+this.m_mA+this.m_iC*this.m_JwC*this.m_JwC+this.m_iA*this.m_JwA*this.m_JwA}if(this.m_type2==oi.TYPE)this.m_JvBD=lt.zero(),this.m_JwB=this.m_ratio,this.m_JwD=this.m_ratio,this.m_mass+=this.m_ratio*this.m_ratio*(this.m_iB+this.m_iD);else{var b=ee.mulVec2(w,this.m_localAxisD),I=ee.mulSub(w,this.m_localAnchorD,this.m_lcD),z=ee.mulSub(g,this.m_localAnchorB,this.m_lcB);this.m_JvBD=lt.mul(this.m_ratio,b),this.m_JwD=this.m_ratio*lt.cross(I,b),this.m_JwB=this.m_ratio*lt.cross(z,b),this.m_mass+=this.m_ratio*this.m_ratio*(this.m_mD+this.m_mB)+this.m_iD*this.m_JwD*this.m_JwD+this.m_iB*this.m_JwB*this.m_JwB}this.m_mass=this.m_mass>0?1/this.m_mass:0,t.warmStarting?(r.addMul(this.m_mA*this.m_impulse,this.m_JvAC),i+=this.m_iA*this.m_impulse*this.m_JwA,a.addMul(this.m_mB*this.m_impulse,this.m_JvBD),h+=this.m_iB*this.m_impulse*this.m_JwB,u.subMul(this.m_mC*this.m_impulse,this.m_JvAC),_-=this.m_iC*this.m_impulse*this.m_JwC,m.subMul(this.m_mD*this.m_impulse,this.m_JvBD),p-=this.m_iD*this.m_impulse*this.m_JwD):this.m_impulse=0,this.m_bodyA.c_velocity.v.set(r),this.m_bodyA.c_velocity.w=i,this.m_bodyB.c_velocity.v.set(a),this.m_bodyB.c_velocity.w=h,this.m_bodyC.c_velocity.v.set(u),this.m_bodyC.c_velocity.w=_,this.m_bodyD.c_velocity.v.set(m),this.m_bodyD.c_velocity.w=p};me.prototype.solveVelocityConstraints=function(t){var e=this.m_bodyA.c_velocity.v,r=this.m_bodyA.c_velocity.w,i=this.m_bodyB.c_velocity.v,o=this.m_bodyB.c_velocity.w,a=this.m_bodyC.c_velocity.v,h=this.m_bodyC.c_velocity.w,c=this.m_bodyD.c_velocity.v,u=this.m_bodyD.c_velocity.w,_=lt.dot(this.m_JvAC,e)-lt.dot(this.m_JvAC,a)+lt.dot(this.m_JvBD,i)-lt.dot(this.m_JvBD,c);_+=this.m_JwA*r-this.m_JwC*h+(this.m_JwB*o-this.m_JwD*u);var f=-this.m_mass*_;this.m_impulse+=f,e.addMul(this.m_mA*f,this.m_JvAC),r+=this.m_iA*f*this.m_JwA,i.addMul(this.m_mB*f,this.m_JvBD),o+=this.m_iB*f*this.m_JwB,a.subMul(this.m_mC*f,this.m_JvAC),h-=this.m_iC*f*this.m_JwC,c.subMul(this.m_mD*f,this.m_JvBD),u-=this.m_iD*f*this.m_JwD,this.m_bodyA.c_velocity.v.set(e),this.m_bodyA.c_velocity.w=r,this.m_bodyB.c_velocity.v.set(i),this.m_bodyB.c_velocity.w=o,this.m_bodyC.c_velocity.v.set(a),this.m_bodyC.c_velocity.w=h,this.m_bodyD.c_velocity.v.set(c),this.m_bodyD.c_velocity.w=u};me.prototype.solvePositionConstraints=function(t){var e=this.m_bodyA.c_position.c,r=this.m_bodyA.c_position.a,i=this.m_bodyB.c_position.c,o=this.m_bodyB.c_position.a,a=this.m_bodyC.c_position.c,h=this.m_bodyC.c_position.a,c=this.m_bodyD.c_position.c,u=this.m_bodyD.c_position.a,_=ee.neo(r),f=ee.neo(o),m=ee.neo(h),p=ee.neo(u),v=0,g,y,w,b,T,M,I,z,V=0;if(this.m_type1==oi.TYPE)w=lt.zero(),T=1,I=1,V+=this.m_iA+this.m_iC,g=r-h-this.m_referenceAngleA;else{var N=ee.mulVec2(m,this.m_localAxisC),L=ee.mulSub(m,this.m_localAnchorC,this.m_lcC),J=ee.mulSub(_,this.m_localAnchorA,this.m_lcA);w=N,I=lt.cross(L,N),T=lt.cross(J,N),V+=this.m_mC+this.m_mA+this.m_iC*I*I+this.m_iA*T*T;var D=lt.sub(this.m_localAnchorC,this.m_lcC),O=ee.mulTVec2(m,lt.add(J,lt.sub(e,a)));g=lt.dot(lt.sub(O,D),this.m_localAxisC)}if(this.m_type2==oi.TYPE)b=lt.zero(),M=this.m_ratio,z=this.m_ratio,V+=this.m_ratio*this.m_ratio*(this.m_iB+this.m_iD),y=o-u-this.m_referenceAngleB;else{var N=ee.mulVec2(p,this.m_localAxisD),q=ee.mulSub(p,this.m_localAnchorD,this.m_lcD),bt=ee.mulSub(f,this.m_localAnchorB,this.m_lcB);b=lt.mul(this.m_ratio,N),z=this.m_ratio*lt.cross(q,N),M=this.m_ratio*lt.cross(bt,N),V+=this.m_ratio*this.m_ratio*(this.m_mD+this.m_mB)+this.m_iD*z*z+this.m_iB*M*M;var Q=lt.sub(this.m_localAnchorD,this.m_lcD),se=ee.mulTVec2(p,lt.add(bt,lt.sub(i,c)));y=lt.dot(se,this.m_localAxisD)-lt.dot(Q,this.m_localAxisD)}var Pt=g+this.m_ratio*y-this.m_constant,dt=0;return V>0&&(dt=-Pt/V),e.addMul(this.m_mA*dt,w),r+=this.m_iA*dt*T,i.addMul(this.m_mB*dt,b),o+=this.m_iB*dt*M,a.subMul(this.m_mC*dt,w),h-=this.m_iC*dt*I,c.subMul(this.m_mD*dt,b),u-=this.m_iD*dt*z,this.m_bodyA.c_position.c.set(e),this.m_bodyA.c_position.a=r,this.m_bodyB.c_position.c.set(i),this.m_bodyB.c_position.a=o,this.m_bodyC.c_position.c.set(a),this.m_bodyC.c_position.a=h,this.m_bodyD.c_position.c.set(c),this.m_bodyD.c_position.a=u,v<_f.linearSlop};var Fn=typeof ASSERT=="undefined"?!1:ASSERT,pf=Ft,Rn=wt,ff=er,Ui=Rt.exports,qe=ut,Km=Si,Qi=ae,qn=Xe,Hh=Ze;Ft.TYPE="motor-joint";qn.TYPES[Ft.TYPE]=Ft;Ft._super=qn;Ft.prototype=Object.create(Ft._super.prototype);var yf={maxForce:1,maxTorque:1,correctionFactor:.3};function Ft(t,e,r){if(!(this instanceof Ft))return new Ft(t,e,r);t=ff(t,yf),qn.call(this,t,e,r),e=this.m_bodyA,r=this.m_bodyB,this.m_type=Ft.TYPE,this.m_linearOffset=Ui.isFinite(t.linearOffset)?t.linearOffset:e.getLocalPoint(r.getPosition()),this.m_angularOffset=Ui.isFinite(t.angularOffset)?t.angularOffset:r.getAngle()-e.getAngle(),this.m_linearImpulse=qe.zero(),this.m_angularImpulse=0,this.m_maxForce=t.maxForce,this.m_maxTorque=t.maxTorque,this.m_correctionFactor=t.correctionFactor,this.m_rA,this.m_rB,this.m_localCenterA,this.m_localCenterB,this.m_linearError,this.m_angularError,this.m_invMassA,this.m_invMassB,this.m_invIA,this.m_invIB,this.m_linearMass,this.m_angularMass}Ft.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,maxForce:this.m_maxForce,maxTorque:this.m_maxTorque,correctionFactor:this.m_correctionFactor,linearOffset:this.m_linearOffset,angularOffset:this.m_angularOffset}};Ft._deserialize=function(t,e,r){t=Object.assign({},t),t.bodyA=r(Hh,t.bodyA,e),t.bodyB=r(Hh,t.bodyB,e);var i=new Ft(t);return i};Ft.prototype._setAnchors=function(t){t.anchorA?this.m_localAnchorA.set(this.m_bodyA.getLocalPoint(t.anchorA)):t.localAnchorA&&this.m_localAnchorA.set(t.localAnchorA),t.anchorB?this.m_localAnchorB.set(this.m_bodyB.getLocalPoint(t.anchorB)):t.localAnchorB&&this.m_localAnchorB.set(t.localAnchorB)};Ft.prototype.setMaxForce=function(t){Fn&&Rn.assert(Ui.isFinite(t)&&t>=0),this.m_maxForce=t};Ft.prototype.getMaxForce=function(){return this.m_maxForce};Ft.prototype.setMaxTorque=function(t){Fn&&Rn.assert(Ui.isFinite(t)&&t>=0),this.m_maxTorque=t};Ft.prototype.getMaxTorque=function(){return this.m_maxTorque};Ft.prototype.setCorrectionFactor=function(t){Fn&&Rn.assert(Ui.isFinite(t)&&0<=t&&t<=1),this.m_correctionFactor=t};Ft.prototype.getCorrectionFactor=function(){return this.m_correctionFactor};Ft.prototype.setLinearOffset=function(t){(t.x!=this.m_linearOffset.x||t.y!=this.m_linearOffset.y)&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_linearOffset=t)};Ft.prototype.getLinearOffset=function(){return this.m_linearOffset};Ft.prototype.setAngularOffset=function(t){t!=this.m_angularOffset&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_angularOffset=t)};Ft.prototype.getAngularOffset=function(){return this.m_angularOffset};Ft.prototype.getAnchorA=function(){return this.m_bodyA.getPosition()};Ft.prototype.getAnchorB=function(){return this.m_bodyB.getPosition()};Ft.prototype.getReactionForce=function(t){return qe.mul(t,this.m_linearImpulse)};Ft.prototype.getReactionTorque=function(t){return t*this.m_angularImpulse};Ft.prototype.initVelocityConstraints=function(t){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var e=this.m_bodyA.c_position.c,r=this.m_bodyA.c_position.a,i=this.m_bodyA.c_velocity.v,o=this.m_bodyA.c_velocity.w,a=this.m_bodyB.c_position.c,h=this.m_bodyB.c_position.a,c=this.m_bodyB.c_velocity.v,u=this.m_bodyB.c_velocity.w,_=Qi.neo(r),f=Qi.neo(h);this.m_rA=Qi.mulVec2(_,qe.neg(this.m_localCenterA)),this.m_rB=Qi.mulVec2(f,qe.neg(this.m_localCenterB));var m=this.m_invMassA,p=this.m_invMassB,v=this.m_invIA,g=this.m_invIB,y=new Km;if(y.ex.x=m+p+v*this.m_rA.y*this.m_rA.y+g*this.m_rB.y*this.m_rB.y,y.ex.y=-v*this.m_rA.x*this.m_rA.y-g*this.m_rB.x*this.m_rB.y,y.ey.x=y.ex.y,y.ey.y=m+p+v*this.m_rA.x*this.m_rA.x+g*this.m_rB.x*this.m_rB.x,this.m_linearMass=y.getInverse(),this.m_angularMass=v+g,this.m_angularMass>0&&(this.m_angularMass=1/this.m_angularMass),this.m_linearError=qe.zero(),this.m_linearError.addCombine(1,a,1,this.m_rB),this.m_linearError.subCombine(1,e,1,this.m_rA),this.m_linearError.sub(Qi.mulVec2(_,this.m_linearOffset)),this.m_angularError=h-r-this.m_angularOffset,t.warmStarting){this.m_linearImpulse.mul(t.dtRatio),this.m_angularImpulse*=t.dtRatio;var w=qe.neo(this.m_linearImpulse.x,this.m_linearImpulse.y);i.subMul(m,w),o-=v*(qe.cross(this.m_rA,w)+this.m_angularImpulse),c.addMul(p,w),u+=g*(qe.cross(this.m_rB,w)+this.m_angularImpulse)}else this.m_linearImpulse.setZero(),this.m_angularImpulse=0;this.m_bodyA.c_velocity.v=i,this.m_bodyA.c_velocity.w=o,this.m_bodyB.c_velocity.v=c,this.m_bodyB.c_velocity.w=u};Ft.prototype.solveVelocityConstraints=function(t){var e=this.m_bodyA.c_velocity.v,r=this.m_bodyA.c_velocity.w,i=this.m_bodyB.c_velocity.v,o=this.m_bodyB.c_velocity.w,a=this.m_invMassA,h=this.m_invMassB,c=this.m_invIA,u=this.m_invIB,_=t.dt,f=t.inv_dt;{var m=o-r+f*this.m_correctionFactor*this.m_angularError,p=-this.m_angularMass*m,v=this.m_angularImpulse,g=_*this.m_maxTorque;this.m_angularImpulse=Ui.clamp(this.m_angularImpulse+p,-g,g),p=this.m_angularImpulse-v,r-=c*p,o+=u*p}{var m=qe.zero();m.addCombine(1,i,1,qe.cross(o,this.m_rB)),m.subCombine(1,e,1,qe.cross(r,this.m_rA)),m.addMul(f*this.m_correctionFactor,this.m_linearError);var p=qe.neg(Km.mulVec2(this.m_linearMass,m)),v=qe.clone(this.m_linearImpulse);this.m_linearImpulse.add(p);var g=_*this.m_maxForce;this.m_linearImpulse.clamp(g),p=qe.sub(this.m_linearImpulse,v),e.subMul(a,p),r-=c*qe.cross(this.m_rA,p),i.addMul(h,p),o+=u*qe.cross(this.m_rB,p)}this.m_bodyA.c_velocity.v=e,this.m_bodyA.c_velocity.w=r,this.m_bodyB.c_velocity.v=i,this.m_bodyB.c_velocity.w=o};Ft.prototype.solvePositionConstraints=function(t){return!0};var Rs=typeof ASSERT=="undefined"?!1:ASSERT,df=Wt,qs=wt,gf=er,ns=Rt.exports,Le=ut,Dn=Si,Zh=ae,Af=Ge,Nn=Xe,Xh=Ze;Wt.TYPE="mouse-joint";Nn.TYPES[Wt.TYPE]=Wt;Wt._super=Nn;Wt.prototype=Object.create(Wt._super.prototype);var bf={maxForce:0,frequencyHz:5,dampingRatio:.7};function Wt(t,e,r,i){if(!(this instanceof Wt))return new Wt(t,e,r,i);t=gf(t,bf),Nn.call(this,t,e,r),e=this.m_bodyA,r=this.m_bodyB,this.m_type=Wt.TYPE,Rs&&qs.assert(ns.isFinite(t.maxForce)&&t.maxForce>=0),Rs&&qs.assert(ns.isFinite(t.frequencyHz)&&t.frequencyHz>=0),Rs&&qs.assert(ns.isFinite(t.dampingRatio)&&t.dampingRatio>=0),this.m_targetA=i?Le.clone(i):t.target||Le.zero(),this.m_localAnchorB=Af.mulTVec2(r.getTransform(),this.m_targetA),this.m_maxForce=t.maxForce,this.m_impulse=Le.zero(),this.m_frequencyHz=t.frequencyHz,this.m_dampingRatio=t.dampingRatio,this.m_beta=0,this.m_gamma=0,this.m_rB=Le.zero(),this.m_localCenterB=Le.zero(),this.m_invMassB=0,this.m_invIB=0,this.mass=new Dn,this.m_C=Le.zero()}Wt.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,target:this.m_targetA,maxForce:this.m_maxForce,frequencyHz:this.m_frequencyHz,dampingRatio:this.m_dampingRatio,_localAnchorB:this.m_localAnchorB}};Wt._deserialize=function(t,e,r){t=Object.assign({},t),t.bodyA=r(Xh,t.bodyA,e),t.bodyB=r(Xh,t.bodyB,e),t.target=Le(t.target);var i=new Wt(t);return t._localAnchorB&&(i.m_localAnchorB=t._localAnchorB),i};Wt.prototype.setTarget=function(t){this.m_bodyB.isAwake()==!1&&this.m_bodyB.setAwake(!0),this.m_targetA=Le.clone(t)};Wt.prototype.getTarget=function(){return this.m_targetA};Wt.prototype.setMaxForce=function(t){this.m_maxForce=t};Wt.getMaxForce=function(){return this.m_maxForce};Wt.prototype.setFrequency=function(t){this.m_frequencyHz=t};Wt.prototype.getFrequency=function(){return this.m_frequencyHz};Wt.prototype.setDampingRatio=function(t){this.m_dampingRatio=t};Wt.prototype.getDampingRatio=function(){return this.m_dampingRatio};Wt.prototype.getAnchorA=function(){return Le.clone(this.m_targetA)};Wt.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)};Wt.prototype.getReactionForce=function(t){return Le.mul(t,this.m_impulse)};Wt.prototype.getReactionTorque=function(t){return t*0};Wt.prototype.shiftOrigin=function(t){this.m_targetA.sub(t)};Wt.prototype.initVelocityConstraints=function(t){this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIB=this.m_bodyB.m_invI;var e=this.m_bodyB.c_position,r=this.m_bodyB.c_velocity,i=e.c,o=e.a,a=r.v,h=r.w,c=Zh.neo(o),u=this.m_bodyB.getMass(),_=2*ns.PI*this.m_frequencyHz,f=2*u*this.m_dampingRatio*_,m=u*(_*_),p=t.dt;Rs&&qs.assert(f+p*m>ns.EPSILON),this.m_gamma=p*(f+p*m),this.m_gamma!=0&&(this.m_gamma=1/this.m_gamma),this.m_beta=p*m*this.m_gamma,this.m_rB=Zh.mulVec2(c,Le.sub(this.m_localAnchorB,this.m_localCenterB));var v=new Dn;v.ex.x=this.m_invMassB+this.m_invIB*this.m_rB.y*this.m_rB.y+this.m_gamma,v.ex.y=-this.m_invIB*this.m_rB.x*this.m_rB.y,v.ey.x=v.ex.y,v.ey.y=this.m_invMassB+this.m_invIB*this.m_rB.x*this.m_rB.x+this.m_gamma,this.m_mass=v.getInverse(),this.m_C.set(i),this.m_C.addCombine(1,this.m_rB,-1,this.m_targetA),this.m_C.mul(this.m_beta),h*=.98,t.warmStarting?(this.m_impulse.mul(t.dtRatio),a.addMul(this.m_invMassB,this.m_impulse),h+=this.m_invIB*Le.cross(this.m_rB,this.m_impulse)):this.m_impulse.setZero(),r.v.set(a),r.w=h};Wt.prototype.solveVelocityConstraints=function(t){var e=this.m_bodyB.c_velocity,r=Le.clone(e.v),i=e.w,o=Le.cross(i,this.m_rB);o.add(r),o.addCombine(1,this.m_C,this.m_gamma,this.m_impulse),o.neg();var a=Dn.mulVec2(this.m_mass,o),h=Le.clone(this.m_impulse);this.m_impulse.add(a);var c=t.dt*this.m_maxForce;this.m_impulse.clamp(c),a=Le.sub(this.m_impulse,h),r.addMul(this.m_invMassB,a),i+=this.m_invIB*Le.cross(this.m_rB,a),e.v.set(r),e.w=i};Wt.prototype.solvePositionConstraints=function(t){return!0};var xf=typeof ASSERT=="undefined"?!1:ASSERT,Bf=jt,wf=wt,Sf=er,as=Ae,is=Rt.exports,rt=ut,ni=ae,On=Xe,Kh=Ze;jt.TYPE="pulley-joint";jt.MIN_PULLEY_LENGTH=2;On.TYPES[jt.TYPE]=jt;jt._super=On;jt.prototype=Object.create(jt._super.prototype);var Cf={collideConnected:!0};function jt(t,e,r,i,o,a,h,c){if(!(this instanceof jt))return new jt(t,e,r,i,o,a,h,c);t=Sf(t,Cf),On.call(this,t,e,r),e=this.m_bodyA,r=this.m_bodyB,this.m_type=jt.TYPE,this.m_groundAnchorA=i||t.groundAnchorA||rt.neo(-1,1),this.m_groundAnchorB=o||t.groundAnchorB||rt.neo(1,1),this.m_localAnchorA=a?e.getLocalPoint(a):t.localAnchorA||rt.neo(-1,0),this.m_localAnchorB=h?r.getLocalPoint(h):t.localAnchorB||rt.neo(1,0),this.m_lengthA=is.isFinite(t.lengthA)?t.lengthA:rt.distance(a,i),this.m_lengthB=is.isFinite(t.lengthB)?t.lengthB:rt.distance(h,o),this.m_ratio=is.isFinite(c)?c:t.ratio,xf&&wf.assert(c>is.EPSILON),this.m_constant=this.m_lengthA+this.m_ratio*this.m_lengthB,this.m_impulse=0,this.m_uA,this.m_uB,this.m_rA,this.m_rB,this.m_localCenterA,this.m_localCenterB,this.m_invMassA,this.m_invMassB,this.m_invIA,this.m_invIB,this.m_mass}jt.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,groundAnchorA:this.m_groundAnchorA,groundAnchorB:this.m_groundAnchorB,localAnchorA:this.m_localAnchorA,localAnchorB:this.m_localAnchorB,lengthA:this.m_lengthA,lengthB:this.m_lengthB,ratio:this.m_ratio}};jt._deserialize=function(t,e,r){t=Object.assign({},t),t.bodyA=r(Kh,t.bodyA,e),t.bodyB=r(Kh,t.bodyB,e);var i=new jt(t);return i};jt.prototype.getGroundAnchorA=function(){return this.m_groundAnchorA};jt.prototype.getGroundAnchorB=function(){return this.m_groundAnchorB};jt.prototype.getLengthA=function(){return this.m_lengthA};jt.prototype.getLengthB=function(){return this.m_lengthB};jt.prototype.getRatio=function(){return this.m_ratio};jt.prototype.getCurrentLengthA=function(){var t=this.m_bodyA.getWorldPoint(this.m_localAnchorA),e=this.m_groundAnchorA;return rt.distance(t,e)};jt.prototype.getCurrentLengthB=function(){var t=this.m_bodyB.getWorldPoint(this.m_localAnchorB),e=this.m_groundAnchorB;return rt.distance(t,e)};jt.prototype.shiftOrigin=function(t){this.m_groundAnchorA.sub(t),this.m_groundAnchorB.sub(t)};jt.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)};jt.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)};jt.prototype.getReactionForce=function(t){return rt.mul(this.m_impulse,this.m_uB).mul(t)};jt.prototype.getReactionTorque=function(t){return 0};jt.prototype.initVelocityConstraints=function(t){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var e=this.m_bodyA.c_position.c,r=this.m_bodyA.c_position.a,i=this.m_bodyA.c_velocity.v,o=this.m_bodyA.c_velocity.w,a=this.m_bodyB.c_position.c,h=this.m_bodyB.c_position.a,c=this.m_bodyB.c_velocity.v,u=this.m_bodyB.c_velocity.w,_=ni.neo(r),f=ni.neo(h);this.m_rA=ni.mulVec2(_,rt.sub(this.m_localAnchorA,this.m_localCenterA)),this.m_rB=ni.mulVec2(f,rt.sub(this.m_localAnchorB,this.m_localCenterB)),this.m_uA=rt.sub(rt.add(e,this.m_rA),this.m_groundAnchorA),this.m_uB=rt.sub(rt.add(a,this.m_rB),this.m_groundAnchorB);var m=this.m_uA.length(),p=this.m_uB.length();m>10*as.linearSlop?this.m_uA.mul(1/m):this.m_uA.setZero(),p>10*as.linearSlop?this.m_uB.mul(1/p):this.m_uB.setZero();var v=rt.cross(this.m_rA,this.m_uA),g=rt.cross(this.m_rB,this.m_uB),y=this.m_invMassA+this.m_invIA*v*v,w=this.m_invMassB+this.m_invIB*g*g;if(this.m_mass=y+this.m_ratio*this.m_ratio*w,this.m_mass>0&&(this.m_mass=1/this.m_mass),t.warmStarting){this.m_impulse*=t.dtRatio;var b=rt.mul(-this.m_impulse,this.m_uA),T=rt.mul(-this.m_ratio*this.m_impulse,this.m_uB);i.addMul(this.m_invMassA,b),o+=this.m_invIA*rt.cross(this.m_rA,b),c.addMul(this.m_invMassB,T),u+=this.m_invIB*rt.cross(this.m_rB,T)}else this.m_impulse=0;this.m_bodyA.c_velocity.v=i,this.m_bodyA.c_velocity.w=o,this.m_bodyB.c_velocity.v=c,this.m_bodyB.c_velocity.w=u};jt.prototype.solveVelocityConstraints=function(t){var e=this.m_bodyA.c_velocity.v,r=this.m_bodyA.c_velocity.w,i=this.m_bodyB.c_velocity.v,o=this.m_bodyB.c_velocity.w,a=rt.add(e,rt.cross(r,this.m_rA)),h=rt.add(i,rt.cross(o,this.m_rB)),c=-rt.dot(this.m_uA,a)-this.m_ratio*rt.dot(this.m_uB,h),u=-this.m_mass*c;this.m_impulse+=u;var _=rt.mul(-u,this.m_uA),f=rt.mul(-this.m_ratio*u,this.m_uB);e.addMul(this.m_invMassA,_),r+=this.m_invIA*rt.cross(this.m_rA,_),i.addMul(this.m_invMassB,f),o+=this.m_invIB*rt.cross(this.m_rB,f),this.m_bodyA.c_velocity.v=e,this.m_bodyA.c_velocity.w=r,this.m_bodyB.c_velocity.v=i,this.m_bodyB.c_velocity.w=o};jt.prototype.solvePositionConstraints=function(t){var e=this.m_bodyA.c_position.c,r=this.m_bodyA.c_position.a,i=this.m_bodyB.c_position.c,o=this.m_bodyB.c_position.a,a=ni.neo(r),h=ni.neo(o),c=ni.mulVec2(a,rt.sub(this.m_localAnchorA,this.m_localCenterA)),u=ni.mulVec2(h,rt.sub(this.m_localAnchorB,this.m_localCenterB)),_=rt.sub(rt.add(e,this.m_rA),this.m_groundAnchorA),f=rt.sub(rt.add(i,this.m_rB),this.m_groundAnchorB),m=_.length(),p=f.length();m>10*as.linearSlop?_.mul(1/m):_.setZero(),p>10*as.linearSlop?f.mul(1/p):f.setZero();var v=rt.cross(c,_),g=rt.cross(u,f),y=this.m_invMassA+this.m_invIA*v*v,w=this.m_invMassB+this.m_invIB*g*g,b=y+this.m_ratio*this.m_ratio*w;b>0&&(b=1/b);var T=this.m_constant-m-this.m_ratio*p,M=is.abs(T),I=-b*T,z=rt.mul(-I,_),V=rt.mul(-this.m_ratio*I,f);return e.addMul(this.m_invMassA,z),r+=this.m_invIA*rt.cross(c,z),i.addMul(this.m_invMassB,V),o+=this.m_invIB*rt.cross(u,V),this.m_bodyA.c_position.c=e,this.m_bodyA.c_position.a=r,this.m_bodyB.c_position.c=i,this.m_bodyB.c_position.a=o,M<as.linearSlop};var Mf=ne,Tf=er,cn=Ae,Qm=Rt.exports,ye=ut,ai=ae,Gn=Xe,Qh=Ze,tl=0,If=2;ne.TYPE="rope-joint";Gn.TYPES[ne.TYPE]=ne;ne._super=Gn;ne.prototype=Object.create(ne._super.prototype);var $f={maxLength:0};function ne(t,e,r,i){if(!(this instanceof ne))return new ne(t,e,r,i);t=Tf(t,$f),Gn.call(this,t,e,r),e=this.m_bodyA,r=this.m_bodyB,this.m_type=ne.TYPE,this.m_localAnchorA=i?e.getLocalPoint(i):t.localAnchorA||ye.neo(-1,0),this.m_localAnchorB=i?r.getLocalPoint(i):t.localAnchorB||ye.neo(1,0),this.m_maxLength=t.maxLength,this.m_mass=0,this.m_impulse=0,this.m_length=0,this.m_state=tl,this.m_u,this.m_rA,this.m_rB,this.m_localCenterA,this.m_localCenterB,this.m_invMassA,this.m_invMassB,this.m_invIA,this.m_invIB,this.m_mass}ne.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,localAnchorA:this.m_localAnchorA,localAnchorB:this.m_localAnchorB,maxLength:this.m_maxLength}};ne._deserialize=function(t,e,r){t=Object.assign({},t),t.bodyA=r(Qh,t.bodyA,e),t.bodyB=r(Qh,t.bodyB,e);var i=new ne(t);return i};ne.prototype.getLocalAnchorA=function(){return this.m_localAnchorA};ne.prototype.getLocalAnchorB=function(){return this.m_localAnchorB};ne.prototype.setMaxLength=function(t){this.m_maxLength=t};ne.prototype.getMaxLength=function(){return this.m_maxLength};ne.prototype.getLimitState=function(){return this.m_state};ne.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)};ne.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)};ne.prototype.getReactionForce=function(t){return ye.mul(this.m_impulse,this.m_u).mul(t)};ne.prototype.getReactionTorque=function(t){return 0};ne.prototype.initVelocityConstraints=function(t){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var e=this.m_bodyA.c_position.c,r=this.m_bodyA.c_position.a,i=this.m_bodyA.c_velocity.v,o=this.m_bodyA.c_velocity.w,a=this.m_bodyB.c_position.c,h=this.m_bodyB.c_position.a,c=this.m_bodyB.c_velocity.v,u=this.m_bodyB.c_velocity.w,_=ai.neo(r),f=ai.neo(h);this.m_rA=ai.mulSub(_,this.m_localAnchorA,this.m_localCenterA),this.m_rB=ai.mulSub(f,this.m_localAnchorB,this.m_localCenterB),this.m_u=ye.zero(),this.m_u.addCombine(1,a,1,this.m_rB),this.m_u.subCombine(1,e,1,this.m_rA),this.m_length=this.m_u.length();var m=this.m_length-this.m_maxLength;if(m>0?this.m_state=If:this.m_state=tl,this.m_length>cn.linearSlop)this.m_u.mul(1/this.m_length);else{this.m_u.setZero(),this.m_mass=0,this.m_impulse=0;return}var p=ye.cross(this.m_rA,this.m_u),v=ye.cross(this.m_rB,this.m_u),g=this.m_invMassA+this.m_invIA*p*p+this.m_invMassB+this.m_invIB*v*v;if(this.m_mass=g!=0?1/g:0,t.warmStarting){this.m_impulse*=t.dtRatio;var y=ye.mul(this.m_impulse,this.m_u);i.subMul(this.m_invMassA,y),o-=this.m_invIA*ye.cross(this.m_rA,y),c.addMul(this.m_invMassB,y),u+=this.m_invIB*ye.cross(this.m_rB,y)}else this.m_impulse=0;this.m_bodyA.c_velocity.v.set(i),this.m_bodyA.c_velocity.w=o,this.m_bodyB.c_velocity.v.set(c),this.m_bodyB.c_velocity.w=u};ne.prototype.solveVelocityConstraints=function(t){var e=this.m_bodyA.c_velocity.v,r=this.m_bodyA.c_velocity.w,i=this.m_bodyB.c_velocity.v,o=this.m_bodyB.c_velocity.w,a=ye.addCross(e,r,this.m_rA),h=ye.addCross(i,o,this.m_rB),c=this.m_length-this.m_maxLength,u=ye.dot(this.m_u,ye.sub(h,a));c<0&&(u+=t.inv_dt*c);var _=-this.m_mass*u,f=this.m_impulse;this.m_impulse=Qm.min(0,this.m_impulse+_),_=this.m_impulse-f;var m=ye.mul(_,this.m_u);e.subMul(this.m_invMassA,m),r-=this.m_invIA*ye.cross(this.m_rA,m),i.addMul(this.m_invMassB,m),o+=this.m_invIB*ye.cross(this.m_rB,m),this.m_bodyA.c_velocity.v=e,this.m_bodyA.c_velocity.w=r,this.m_bodyB.c_velocity.v=i,this.m_bodyB.c_velocity.w=o};ne.prototype.solvePositionConstraints=function(t){var e=this.m_bodyA.c_position.c,r=this.m_bodyA.c_position.a,i=this.m_bodyB.c_position.c,o=this.m_bodyB.c_position.a,a=ai.neo(r),h=ai.neo(o),c=ai.mulSub(a,this.m_localAnchorA,this.m_localCenterA),u=ai.mulSub(h,this.m_localAnchorB,this.m_localCenterB),_=ye.zero();_.addCombine(1,i,1,u),_.subCombine(1,e,1,c);var f=_.normalize(),m=f-this.m_maxLength;m=Qm.clamp(m,0,cn.maxLinearCorrection);var p=-this.m_mass*m,v=ye.mul(p,_);return e.subMul(this.m_invMassA,v),r-=this.m_invIA*ye.cross(c,v),i.addMul(this.m_invMassB,v),o+=this.m_invIB*ye.cross(u,v),this.m_bodyA.c_position.c.set(e),this.m_bodyA.c_position.a=r,this.m_bodyB.c_position.c.set(i),this.m_bodyB.c_position.a=o,f-this.m_maxLength<cn.linearSlop};var Ef=Ht,Pf=er,tm=Ae,Jn=Rt.exports,Et=ut,Gi=Yi,ps=ho,hi=ae,Un=Xe,em=Ze;Ht.TYPE="weld-joint";Un.TYPES[Ht.TYPE]=Ht;Ht._super=Un;Ht.prototype=Object.create(Ht._super.prototype);var Vf={frequencyHz:0,dampingRatio:0};function Ht(t,e,r,i){if(!(this instanceof Ht))return new Ht(t,e,r,i);t=Pf(t,Vf),Un.call(this,t,e,r),e=this.m_bodyA,r=this.m_bodyB,this.m_type=Ht.TYPE,this.m_localAnchorA=Et.clone(i?e.getLocalPoint(i):t.localAnchorA||Et.zero()),this.m_localAnchorB=Et.clone(i?r.getLocalPoint(i):t.localAnchorB||Et.zero()),this.m_referenceAngle=Jn.isFinite(t.referenceAngle)?t.referenceAngle:r.getAngle()-e.getAngle(),this.m_frequencyHz=t.frequencyHz,this.m_dampingRatio=t.dampingRatio,this.m_impulse=Gi(),this.m_bias=0,this.m_gamma=0,this.m_rA,this.m_rB,this.m_localCenterA,this.m_localCenterB,this.m_invMassA,this.m_invMassB,this.m_invIA,this.m_invIB,this.m_mass=new ps}Ht.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,frequencyHz:this.m_frequencyHz,dampingRatio:this.m_dampingRatio,localAnchorA:this.m_localAnchorA,localAnchorB:this.m_localAnchorB,referenceAngle:this.m_referenceAngle}};Ht._deserialize=function(t,e,r){t=Object.assign({},t),t.bodyA=r(em,t.bodyA,e),t.bodyB=r(em,t.bodyB,e);var i=new Ht(t);return i};Ht.prototype._setAnchors=function(t){t.anchorA?this.m_localAnchorA.set(this.m_bodyA.getLocalPoint(t.anchorA)):t.localAnchorA&&this.m_localAnchorA.set(t.localAnchorA),t.anchorB?this.m_localAnchorB.set(this.m_bodyB.getLocalPoint(t.anchorB)):t.localAnchorB&&this.m_localAnchorB.set(t.localAnchorB)};Ht.prototype.getLocalAnchorA=function(){return this.m_localAnchorA};Ht.prototype.getLocalAnchorB=function(){return this.m_localAnchorB};Ht.prototype.getReferenceAngle=function(){return this.m_referenceAngle};Ht.prototype.setFrequency=function(t){this.m_frequencyHz=t};Ht.prototype.getFrequency=function(){return this.m_frequencyHz};Ht.prototype.setDampingRatio=function(t){this.m_dampingRatio=t};Ht.prototype.getDampingRatio=function(){return this.m_dampingRatio};Ht.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)};Ht.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)};Ht.prototype.getReactionForce=function(t){return Et.neo(this.m_impulse.x,this.m_impulse.y).mul(t)};Ht.prototype.getReactionTorque=function(t){return t*this.m_impulse.z};Ht.prototype.initVelocityConstraints=function(t){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var e=this.m_bodyA.c_position.a,r=this.m_bodyA.c_velocity.v,i=this.m_bodyA.c_velocity.w,o=this.m_bodyB.c_position.a,a=this.m_bodyB.c_velocity.v,h=this.m_bodyB.c_velocity.w,c=hi.neo(e),u=hi.neo(o);this.m_rA=hi.mulVec2(c,Et.sub(this.m_localAnchorA,this.m_localCenterA)),this.m_rB=hi.mulVec2(u,Et.sub(this.m_localAnchorB,this.m_localCenterB));var _=this.m_invMassA,f=this.m_invMassB,m=this.m_invIA,p=this.m_invIB,v=new ps;if(v.ex.x=_+f+this.m_rA.y*this.m_rA.y*m+this.m_rB.y*this.m_rB.y*p,v.ey.x=-this.m_rA.y*this.m_rA.x*m-this.m_rB.y*this.m_rB.x*p,v.ez.x=-this.m_rA.y*m-this.m_rB.y*p,v.ex.y=v.ey.x,v.ey.y=_+f+this.m_rA.x*this.m_rA.x*m+this.m_rB.x*this.m_rB.x*p,v.ez.y=this.m_rA.x*m+this.m_rB.x*p,v.ex.z=v.ez.x,v.ey.z=v.ez.y,v.ez.z=m+p,this.m_frequencyHz>0){v.getInverse22(this.m_mass);var g=m+p,y=g>0?1/g:0,w=o-e-this.m_referenceAngle,b=2*Jn.PI*this.m_frequencyHz,T=2*y*this.m_dampingRatio*b,M=y*b*b,I=t.dt;this.m_gamma=I*(T+I*M),this.m_gamma=this.m_gamma!=0?1/this.m_gamma:0,this.m_bias=w*I*M*this.m_gamma,g+=this.m_gamma,this.m_mass.ez.z=g!=0?1/g:0}else v.ez.z==0?(v.getInverse22(this.m_mass),this.m_gamma=0,this.m_bias=0):(v.getSymInverse33(this.m_mass),this.m_gamma=0,this.m_bias=0);if(t.warmStarting){this.m_impulse.mul(t.dtRatio);var z=Et.neo(this.m_impulse.x,this.m_impulse.y);r.subMul(_,z),i-=m*(Et.cross(this.m_rA,z)+this.m_impulse.z),a.addMul(f,z),h+=p*(Et.cross(this.m_rB,z)+this.m_impulse.z)}else this.m_impulse.setZero();this.m_bodyA.c_velocity.v=r,this.m_bodyA.c_velocity.w=i,this.m_bodyB.c_velocity.v=a,this.m_bodyB.c_velocity.w=h};Ht.prototype.solveVelocityConstraints=function(t){var e=this.m_bodyA.c_velocity.v,r=this.m_bodyA.c_velocity.w,i=this.m_bodyB.c_velocity.v,o=this.m_bodyB.c_velocity.w,a=this.m_invMassA,h=this.m_invMassB,c=this.m_invIA,u=this.m_invIB;if(this.m_frequencyHz>0){var _=o-r,f=-this.m_mass.ez.z*(_+this.m_bias+this.m_gamma*this.m_impulse.z);this.m_impulse.z+=f,r-=c*f,o+=u*f;var m=Et.zero();m.addCombine(1,i,1,Et.cross(o,this.m_rB)),m.subCombine(1,e,1,Et.cross(r,this.m_rA));var p=Et.neg(ps.mulVec2(this.m_mass,m));this.m_impulse.x+=p.x,this.m_impulse.y+=p.y;var v=Et.clone(p);e.subMul(a,v),r-=c*Et.cross(this.m_rA,v),i.addMul(h,v),o+=u*Et.cross(this.m_rB,v)}else{var m=Et.zero();m.addCombine(1,i,1,Et.cross(o,this.m_rB)),m.subCombine(1,e,1,Et.cross(r,this.m_rA));var _=o-r,g=Gi(m.x,m.y,_),y=Gi.neg(ps.mulVec3(this.m_mass,g));this.m_impulse.add(y);var v=Et.neo(y.x,y.y);e.subMul(a,v),r-=c*(Et.cross(this.m_rA,v)+y.z),i.addMul(h,v),o+=u*(Et.cross(this.m_rB,v)+y.z)}this.m_bodyA.c_velocity.v=e,this.m_bodyA.c_velocity.w=r,this.m_bodyB.c_velocity.v=i,this.m_bodyB.c_velocity.w=o};Ht.prototype.solvePositionConstraints=function(t){var e=this.m_bodyA.c_position.c,r=this.m_bodyA.c_position.a,i=this.m_bodyB.c_position.c,o=this.m_bodyB.c_position.a,a=hi.neo(r),h=hi.neo(o),c=this.m_invMassA,u=this.m_invMassB,_=this.m_invIA,f=this.m_invIB,m=hi.mulVec2(a,Et.sub(this.m_localAnchorA,this.m_localCenterA)),p=hi.mulVec2(h,Et.sub(this.m_localAnchorB,this.m_localCenterB)),v,g,y=new ps;if(y.ex.x=c+u+m.y*m.y*_+p.y*p.y*f,y.ey.x=-m.y*m.x*_-p.y*p.x*f,y.ez.x=-m.y*_-p.y*f,y.ex.y=y.ey.x,y.ey.y=c+u+m.x*m.x*_+p.x*p.x*f,y.ez.y=m.x*_+p.x*f,y.ex.z=y.ez.x,y.ey.z=y.ez.y,y.ez.z=_+f,this.m_frequencyHz>0){var w=Et.zero();w.addCombine(1,i,1,p),w.subCombine(1,e,1,m),v=w.length(),g=0;var b=Et.neg(y.solve22(w));e.subMul(c,b),r-=_*Et.cross(m,b),i.addMul(u,b),o+=f*Et.cross(p,b)}else{var w=Et.zero();w.addCombine(1,i,1,p),w.subCombine(1,e,1,m);var T=o-r-this.m_referenceAngle;v=w.length(),g=Jn.abs(T);var M=Gi(w.x,w.y,T),I=Gi();if(y.ez.z>0)I=Gi.neg(y.solve33(M));else{var z=Et.neg(y.solve22(w));I.set(z.x,z.y,0)}var b=Et.neo(I.x,I.y);e.subMul(c,b),r-=_*(Et.cross(m,b)+I.z),i.addMul(u,b),o+=f*(Et.cross(p,b)+I.z)}return this.m_bodyA.c_position.c=e,this.m_bodyA.c_position.a=r,this.m_bodyB.c_position.c=i,this.m_bodyB.c_position.a=o,v<=tm.linearSlop&&g<=tm.angularSlop};var zf=At,Lf=er,kf=Ae,Yn=Rt.exports,vt=ut,Ar=ae,Wn=Xe,rm=Ze;At.TYPE="wheel-joint";Wn.TYPES[At.TYPE]=At;At._super=Wn;At.prototype=Object.create(At._super.prototype);var Ff={enableMotor:!1,maxMotorTorque:0,motorSpeed:0,frequencyHz:2,dampingRatio:.7};function At(t,e,r,i,o){if(!(this instanceof At))return new At(t,e,r,i,o);t=Lf(t,Ff),Wn.call(this,t,e,r),e=this.m_bodyA,r=this.m_bodyB,this.m_type=At.TYPE,this.m_localAnchorA=vt.clone(i?e.getLocalPoint(i):t.localAnchorA||vt.zero()),this.m_localAnchorB=vt.clone(i?r.getLocalPoint(i):t.localAnchorB||vt.zero()),this.m_localXAxisA=vt.clone(o?e.getLocalVector(o):t.localAxisA||t.localAxis||vt.neo(1,0)),this.m_localYAxisA=vt.cross(1,this.m_localXAxisA),this.m_mass=0,this.m_impulse=0,this.m_motorMass=0,this.m_motorImpulse=0,this.m_springMass=0,this.m_springImpulse=0,this.m_maxMotorTorque=t.maxMotorTorque,this.m_motorSpeed=t.motorSpeed,this.m_enableMotor=t.enableMotor,this.m_frequencyHz=t.frequencyHz,this.m_dampingRatio=t.dampingRatio,this.m_bias=0,this.m_gamma=0,this.m_localCenterA,this.m_localCenterB,this.m_invMassA,this.m_invMassB,this.m_invIA,this.m_invIB,this.m_ax=vt.zero(),this.m_ay=vt.zero(),this.m_sAx,this.m_sBx,this.m_sAy,this.m_sBy}At.prototype._serialize=function(){return{type:this.m_type,bodyA:this.m_bodyA,bodyB:this.m_bodyB,collideConnected:this.m_collideConnected,enableMotor:this.m_enableMotor,maxMotorTorque:this.m_maxMotorTorque,motorSpeed:this.m_motorSpeed,frequencyHz:this.m_frequencyHz,dampingRatio:this.m_dampingRatio,localAnchorA:this.m_localAnchorA,localAnchorB:this.m_localAnchorB,localAxisA:this.m_localXAxisA}};At._deserialize=function(t,e,r){t=Object.assign({},t),t.bodyA=r(rm,t.bodyA,e),t.bodyB=r(rm,t.bodyB,e);var i=new At(t);return i};At.prototype._setAnchors=function(t){t.anchorA?this.m_localAnchorA.set(this.m_bodyA.getLocalPoint(t.anchorA)):t.localAnchorA&&this.m_localAnchorA.set(t.localAnchorA),t.anchorB?this.m_localAnchorB.set(this.m_bodyB.getLocalPoint(t.anchorB)):t.localAnchorB&&this.m_localAnchorB.set(t.localAnchorB),t.localAxisA&&(this.m_localXAxisA.set(t.localAxisA),this.m_localYAxisA.set(vt.cross(1,t.localAxisA)))};At.prototype.getLocalAnchorA=function(){return this.m_localAnchorA};At.prototype.getLocalAnchorB=function(){return this.m_localAnchorB};At.prototype.getLocalAxisA=function(){return this.m_localXAxisA};At.prototype.getJointTranslation=function(){var t=this.m_bodyA,e=this.m_bodyB,r=t.getWorldPoint(this.m_localAnchorA),i=e.getWorldPoint(this.m_localAnchorB),o=vt.sub(i,r),a=t.getWorldVector(this.m_localXAxisA),h=vt.dot(o,a);return h};At.prototype.getJointSpeed=function(){var t=this.m_bodyA.m_angularVelocity,e=this.m_bodyB.m_angularVelocity;return e-t};At.prototype.isMotorEnabled=function(){return this.m_enableMotor};At.prototype.enableMotor=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_enableMotor=t};At.prototype.setMotorSpeed=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_motorSpeed=t};At.prototype.getMotorSpeed=function(){return this.m_motorSpeed};At.prototype.setMaxMotorTorque=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_maxMotorTorque=t};At.prototype.getMaxMotorTorque=function(){return this.m_maxMotorTorque};At.prototype.getMotorTorque=function(t){return t*this.m_motorImpulse};At.prototype.setSpringFrequencyHz=function(t){this.m_frequencyHz=t};At.prototype.getSpringFrequencyHz=function(){return this.m_frequencyHz};At.prototype.setSpringDampingRatio=function(t){this.m_dampingRatio=t};At.prototype.getSpringDampingRatio=function(){return this.m_dampingRatio};At.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)};At.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)};At.prototype.getReactionForce=function(t){return vt.combine(this.m_impulse,this.m_ay,this.m_springImpulse,this.m_ax).mul(t)};At.prototype.getReactionTorque=function(t){return t*this.m_motorImpulse};At.prototype.initVelocityConstraints=function(t){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var e=this.m_invMassA,r=this.m_invMassB,i=this.m_invIA,o=this.m_invIB,a=this.m_bodyA.c_position.c,h=this.m_bodyA.c_position.a,c=this.m_bodyA.c_velocity.v,u=this.m_bodyA.c_velocity.w,_=this.m_bodyB.c_position.c,f=this.m_bodyB.c_position.a,m=this.m_bodyB.c_velocity.v,p=this.m_bodyB.c_velocity.w,v=Ar.neo(h),g=Ar.neo(f),y=Ar.mulVec2(v,vt.sub(this.m_localAnchorA,this.m_localCenterA)),w=Ar.mulVec2(g,vt.sub(this.m_localAnchorB,this.m_localCenterB)),b=vt.zero();if(b.addCombine(1,_,1,w),b.subCombine(1,a,1,y),this.m_ay=Ar.mulVec2(v,this.m_localYAxisA),this.m_sAy=vt.cross(vt.add(b,y),this.m_ay),this.m_sBy=vt.cross(w,this.m_ay),this.m_mass=e+r+i*this.m_sAy*this.m_sAy+o*this.m_sBy*this.m_sBy,this.m_mass>0&&(this.m_mass=1/this.m_mass),this.m_springMass=0,this.m_bias=0,this.m_gamma=0,this.m_frequencyHz>0){this.m_ax=Ar.mulVec2(v,this.m_localXAxisA),this.m_sAx=vt.cross(vt.add(b,y),this.m_ax),this.m_sBx=vt.cross(w,this.m_ax);var T=e+r+i*this.m_sAx*this.m_sAx+o*this.m_sBx*this.m_sBx;if(T>0){this.m_springMass=1/T;var M=vt.dot(b,this.m_ax),I=2*Yn.PI*this.m_frequencyHz,b=2*this.m_springMass*this.m_dampingRatio*I,z=this.m_springMass*I*I,V=t.dt;this.m_gamma=V*(b+V*z),this.m_gamma>0&&(this.m_gamma=1/this.m_gamma),this.m_bias=M*V*z*this.m_gamma,this.m_springMass=T+this.m_gamma,this.m_springMass>0&&(this.m_springMass=1/this.m_springMass)}}else this.m_springImpulse=0;if(this.m_enableMotor?(this.m_motorMass=i+o,this.m_motorMass>0&&(this.m_motorMass=1/this.m_motorMass)):(this.m_motorMass=0,this.m_motorImpulse=0),t.warmStarting){this.m_impulse*=t.dtRatio,this.m_springImpulse*=t.dtRatio,this.m_motorImpulse*=t.dtRatio;var N=vt.combine(this.m_impulse,this.m_ay,this.m_springImpulse,this.m_ax),L=this.m_impulse*this.m_sAy+this.m_springImpulse*this.m_sAx+this.m_motorImpulse,J=this.m_impulse*this.m_sBy+this.m_springImpulse*this.m_sBx+this.m_motorImpulse;c.subMul(this.m_invMassA,N),u-=this.m_invIA*L,m.addMul(this.m_invMassB,N),p+=this.m_invIB*J}else this.m_impulse=0,this.m_springImpulse=0,this.m_motorImpulse=0;this.m_bodyA.c_velocity.v.set(c),this.m_bodyA.c_velocity.w=u,this.m_bodyB.c_velocity.v.set(m),this.m_bodyB.c_velocity.w=p};At.prototype.solveVelocityConstraints=function(t){var e=this.m_invMassA,r=this.m_invMassB,i=this.m_invIA,o=this.m_invIB,a=this.m_bodyA.c_velocity.v,h=this.m_bodyA.c_velocity.w,c=this.m_bodyB.c_velocity.v,u=this.m_bodyB.c_velocity.w;{var _=vt.dot(this.m_ax,c)-vt.dot(this.m_ax,a)+this.m_sBx*u-this.m_sAx*h,f=-this.m_springMass*(_+this.m_bias+this.m_gamma*this.m_springImpulse);this.m_springImpulse+=f;var m=vt.mul(f,this.m_ax),p=f*this.m_sAx,v=f*this.m_sBx;a.subMul(e,m),h-=i*p,c.addMul(r,m),u+=o*v}{var _=u-h-this.m_motorSpeed,f=-this.m_motorMass*_,g=this.m_motorImpulse,y=t.dt*this.m_maxMotorTorque;this.m_motorImpulse=Yn.clamp(this.m_motorImpulse+f,-y,y),f=this.m_motorImpulse-g,h-=i*f,u+=o*f}{var _=vt.dot(this.m_ay,c)-vt.dot(this.m_ay,a)+this.m_sBy*u-this.m_sAy*h,f=-this.m_mass*_;this.m_impulse+=f;var m=vt.mul(f,this.m_ay),p=f*this.m_sAy,v=f*this.m_sBy;a.subMul(e,m),h-=i*p,c.addMul(r,m),u+=o*v}this.m_bodyA.c_velocity.v.set(a),this.m_bodyA.c_velocity.w=h,this.m_bodyB.c_velocity.v.set(c),this.m_bodyB.c_velocity.w=u};At.prototype.solvePositionConstraints=function(t){var e=this.m_bodyA.c_position.c,r=this.m_bodyA.c_position.a,i=this.m_bodyB.c_position.c,o=this.m_bodyB.c_position.a,a=Ar.neo(r),h=Ar.neo(o),c=Ar.mulVec2(a,vt.sub(this.m_localAnchorA,this.m_localCenterA)),u=Ar.mulVec2(h,vt.sub(this.m_localAnchorB,this.m_localCenterB)),_=vt.zero();_.addCombine(1,i,1,u),_.subCombine(1,e,1,c);var f=Ar.mulVec2(a,this.m_localYAxisA),m=vt.cross(vt.add(_,c),f),p=vt.cross(u,f),v=vt.dot(_,f),g=this.m_invMassA+this.m_invMassB+this.m_invIA*this.m_sAy*this.m_sAy+this.m_invIB*this.m_sBy*this.m_sBy,y;g!=0?y=-v/g:y=0;var w=vt.mul(y,f),b=y*m,T=y*p;return e.subMul(this.m_invMassA,w),r-=this.m_invIA*b,i.addMul(this.m_invMassB,w),o+=this.m_invIB*T,this.m_bodyA.c_position.c.set(e),this.m_bodyA.c_position.a=r,this.m_bodyB.c_position.c.set(i),this.m_bodyB.c_position.a=o,Yn.abs(v)<=kf.linearSlop};(function(t){t.internal={},t.Serializer=eo.exports,t.Math=Rt.exports,t.Vec2=ut,t.Vec3=Yi,t.Mat22=Si,t.Mat33=ho,t.Transform=Ge,t.Rot=ae,t.AABB=ro,t.Shape=wi,t.Fixture=gn,t.Body=Ze,t.Contact=ui,t.Joint=Xe,t.World=Bm,t.Circle=lo,t.Edge=co,t.Polygon=gs,t.Chain=Tn,t.Box=wp,t.internal.CollidePolygons=zp,t.DistanceJoint=Wp,t.FrictionJoint=Zp,t.GearJoint=cf,t.MotorJoint=pf,t.MouseJoint=df,t.PrismaticJoint=jm,t.PulleyJoint=Bf,t.RevoluteJoint=Wm,t.RopeJoint=Mf,t.WeldJoint=Ef,t.WheelJoint=zf,t.Settings=Ae,t.internal.Sweep=yn,t.internal.stats=ao,t.internal.Manifold=vr.exports,t.internal.Distance=Wr.exports,t.internal.TimeOfImpact=fs.exports,t.internal.DynamicTree=sm,t.internal.Settings=t.Settings})(Zo);var Rf=Object.freeze(nv({__proto__:null,[Symbol.toStringTag]:"Module",default:Zo},[Zo])),el={exports:{}};/**
 * chroma.js - JavaScript library for color conversions
 *
 * Copyright (c) 2011-2019, Gregor Aisch
 * All rights reserved.
 *
 * Redistribution and use in source and binary forms, with or without
 * modification, are permitted provided that the following conditions are met:
 *
 * 1. Redistributions of source code must retain the above copyright notice, this
 * list of conditions and the following disclaimer.
 *
 * 2. Redistributions in binary form must reproduce the above copyright notice,
 * this list of conditions and the following disclaimer in the documentation
 * and/or other materials provided with the distribution.
 *
 * 3. The name Gregor Aisch may not be used to endorse or promote products
 * derived from this software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"
 * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
 * DISCLAIMED. IN NO EVENT SHALL GREGOR AISCH OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT,
 * INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING,
 * BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 * DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY
 * OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING
 * NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE,
 * EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 *
 * -------------------------------------------------------
 *
 * chroma.js includes colors from colorbrewer2.org, which are released under
 * the following license:
 *
 * Copyright (c) 2002 Cynthia Brewer, Mark Harrower,
 * and The Pennsylvania State University.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing,
 * software distributed under the License is distributed on an
 * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,
 * either express or implied. See the License for the specific
 * language governing permissions and limitations under the License.
 *
 * ------------------------------------------------------
 *
 * Named colors are taken from X11 Color Names.
 * http://www.w3.org/TR/css3-color/#svg-color
 *
 * @preserve
 */(function(t,e){(function(r,i){t.exports=i()})(av,function(){for(var r=function(s,n,l){return n===void 0&&(n=0),l===void 0&&(l=1),s<n?n:s>l?l:s},i=r,o=function(s){s._clipped=!1,s._unclipped=s.slice(0);for(var n=0;n<=3;n++)n<3?((s[n]<0||s[n]>255)&&(s._clipped=!0),s[n]=i(s[n],0,255)):n===3&&(s[n]=i(s[n],0,1));return s},a={},h=0,c=["Boolean","Number","String","Function","Array","Date","RegExp","Undefined","Null"];h<c.length;h+=1){var u=c[h];a["[object "+u+"]"]=u.toLowerCase()}var _=function(s){return a[Object.prototype.toString.call(s)]||"object"},f=_,m=function(s,n){return n===void 0&&(n=null),s.length>=3?Array.prototype.slice.call(s):f(s[0])=="object"&&n?n.split("").filter(function(l){return s[0][l]!==void 0}).map(function(l){return s[0][l]}):s[0]},p=_,v=function(s){if(s.length<2)return null;var n=s.length-1;return p(s[n])=="string"?s[n].toLowerCase():null},g=Math.PI,y={clip_rgb:o,limit:r,type:_,unpack:m,last:v,PI:g,TWOPI:g*2,PITHIRD:g/3,DEG2RAD:g/180,RAD2DEG:180/g},w={format:{},autodetect:[]},b=y.last,T=y.clip_rgb,M=y.type,I=w,z=function(){for(var n=[],l=arguments.length;l--;)n[l]=arguments[l];var d=this;if(M(n[0])==="object"&&n[0].constructor&&n[0].constructor===this.constructor)return n[0];var x=b(n),B=!1;if(!x){B=!0,I.sorted||(I.autodetect=I.autodetect.sort(function(k,U){return U.p-k.p}),I.sorted=!0);for(var A=0,S=I.autodetect;A<S.length;A+=1){var C=S[A];if(x=C.test.apply(C,n),x)break}}if(I.format[x]){var E=I.format[x].apply(null,B?n:n.slice(0,-1));d._rgb=T(E)}else throw new Error("unknown format: "+n);d._rgb.length===3&&d._rgb.push(1)};z.prototype.toString=function(){return M(this.hex)=="function"?this.hex():"["+this._rgb.join(",")+"]"};var V=z,N=function(){for(var s=[],n=arguments.length;n--;)s[n]=arguments[n];return new(Function.prototype.bind.apply(N.Color,[null].concat(s)))};N.Color=V,N.version="2.4.2";var L=N,J=y.unpack,D=Math.max,O=function(){for(var s=[],n=arguments.length;n--;)s[n]=arguments[n];var l=J(s,"rgb"),d=l[0],x=l[1],B=l[2];d=d/255,x=x/255,B=B/255;var A=1-D(d,D(x,B)),S=A<1?1/(1-A):0,C=(1-d-A)*S,E=(1-x-A)*S,k=(1-B-A)*S;return[C,E,k,A]},q=O,bt=y.unpack,Q=function(){for(var s=[],n=arguments.length;n--;)s[n]=arguments[n];s=bt(s,"cmyk");var l=s[0],d=s[1],x=s[2],B=s[3],A=s.length>4?s[4]:1;return B===1?[0,0,0,A]:[l>=1?0:255*(1-l)*(1-B),d>=1?0:255*(1-d)*(1-B),x>=1?0:255*(1-x)*(1-B),A]},se=Q,Pt=L,dt=V,ot=w,Vt=y.unpack,at=y.type,it=q;dt.prototype.cmyk=function(){return it(this._rgb)},Pt.cmyk=function(){for(var s=[],n=arguments.length;n--;)s[n]=arguments[n];return new(Function.prototype.bind.apply(dt,[null].concat(s,["cmyk"])))},ot.format.cmyk=se,ot.autodetect.push({p:2,test:function(){for(var s=[],n=arguments.length;n--;)s[n]=arguments[n];if(s=Vt(s,"cmyk"),at(s)==="array"&&s.length===4)return"cmyk"}});var xt=y.unpack,_e=y.last,Je=function(s){return Math.round(s*100)/100},Ue=function(){for(var s=[],n=arguments.length;n--;)s[n]=arguments[n];var l=xt(s,"hsla"),d=_e(s)||"lsa";return l[0]=Je(l[0]||0),l[1]=Je(l[1]*100)+"%",l[2]=Je(l[2]*100)+"%",d==="hsla"||l.length>3&&l[3]<1?(l[3]=l.length>3?l[3]:1,d="hsla"):l.length=3,d+"("+l.join(",")+")"},nr=Ue,Ir=y.unpack,jr=function(){for(var s=[],n=arguments.length;n--;)s[n]=arguments[n];s=Ir(s,"rgba");var l=s[0],d=s[1],x=s[2];l/=255,d/=255,x/=255;var B=Math.min(l,d,x),A=Math.max(l,d,x),S=(A+B)/2,C,E;return A===B?(C=0,E=Number.NaN):C=S<.5?(A-B)/(A+B):(A-B)/(2-A-B),l==A?E=(d-x)/(A-B):d==A?E=2+(x-l)/(A-B):x==A&&(E=4+(l-d)/(A-B)),E*=60,E<0&&(E+=360),s.length>3&&s[3]!==void 0?[E,C,S,s[3]]:[E,C,S]},$e=jr,Fr=y.unpack,$r=y.last,Wi=nr,Rr=$e,vo=Math.round,rl=function(){for(var s=[],n=arguments.length;n--;)s[n]=arguments[n];var l=Fr(s,"rgba"),d=$r(s)||"rgb";return d.substr(0,3)=="hsl"?Wi(Rr(l),d):(l[0]=vo(l[0]),l[1]=vo(l[1]),l[2]=vo(l[2]),(d==="rgba"||l.length>3&&l[3]<1)&&(l[3]=l.length>3?l[3]:1,d="rgba"),d+"("+l.slice(0,d==="rgb"?3:4).join(",")+")")},il=rl,sl=y.unpack,po=Math.round,ol=function(){for(var s,n=[],l=arguments.length;l--;)n[l]=arguments[l];n=sl(n,"hsl");var d=n[0],x=n[1],B=n[2],A,S,C;if(x===0)A=S=C=B*255;else{var E=[0,0,0],k=[0,0,0],U=B<.5?B*(1+x):B+x-B*x,F=2*B-U,j=d/360;E[0]=j+1/3,E[1]=j,E[2]=j-1/3;for(var W=0;W<3;W++)E[W]<0&&(E[W]+=1),E[W]>1&&(E[W]-=1),6*E[W]<1?k[W]=F+(U-F)*6*E[W]:2*E[W]<1?k[W]=U:3*E[W]<2?k[W]=F+(U-F)*(2/3-E[W])*6:k[W]=F;s=[po(k[0]*255),po(k[1]*255),po(k[2]*255)],A=s[0],S=s[1],C=s[2]}return n.length>3?[A,S,C,n[3]]:[A,S,C,1]},jn=ol,Hn=jn,Zn=w,Xn=/^rgb\(\s*(-?\d+),\s*(-?\d+)\s*,\s*(-?\d+)\s*\)$/,Kn=/^rgba\(\s*(-?\d+),\s*(-?\d+)\s*,\s*(-?\d+)\s*,\s*([01]|[01]?\.\d+)\)$/,Qn=/^rgb\(\s*(-?\d+(?:\.\d+)?)%,\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*\)$/,ta=/^rgba\(\s*(-?\d+(?:\.\d+)?)%,\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)$/,ea=/^hsl\(\s*(-?\d+(?:\.\d+)?),\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*\)$/,ra=/^hsla\(\s*(-?\d+(?:\.\d+)?),\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)$/,ia=Math.round,sa=function(s){s=s.toLowerCase().trim();var n;if(Zn.format.named)try{return Zn.format.named(s)}catch{}if(n=s.match(Xn)){for(var l=n.slice(1,4),d=0;d<3;d++)l[d]=+l[d];return l[3]=1,l}if(n=s.match(Kn)){for(var x=n.slice(1,5),B=0;B<4;B++)x[B]=+x[B];return x}if(n=s.match(Qn)){for(var A=n.slice(1,4),S=0;S<3;S++)A[S]=ia(A[S]*2.55);return A[3]=1,A}if(n=s.match(ta)){for(var C=n.slice(1,5),E=0;E<3;E++)C[E]=ia(C[E]*2.55);return C[3]=+C[3],C}if(n=s.match(ea)){var k=n.slice(1,4);k[1]*=.01,k[2]*=.01;var U=Hn(k);return U[3]=1,U}if(n=s.match(ra)){var F=n.slice(1,4);F[1]*=.01,F[2]*=.01;var j=Hn(F);return j[3]=+n[4],j}};sa.test=function(s){return Xn.test(s)||Kn.test(s)||Qn.test(s)||ta.test(s)||ea.test(s)||ra.test(s)};var nl=sa,al=L,oa=V,na=w,hl=y.type,ml=il,aa=nl;oa.prototype.css=function(s){return ml(this._rgb,s)},al.css=function(){for(var s=[],n=arguments.length;n--;)s[n]=arguments[n];return new(Function.prototype.bind.apply(oa,[null].concat(s,["css"])))},na.format.css=aa,na.autodetect.push({p:5,test:function(s){for(var n=[],l=arguments.length-1;l-- >0;)n[l]=arguments[l+1];if(!n.length&&hl(s)==="string"&&aa.test(s))return"css"}});var ha=V,ll=L,cl=w,ul=y.unpack;cl.format.gl=function(){for(var s=[],n=arguments.length;n--;)s[n]=arguments[n];var l=ul(s,"rgba");return l[0]*=255,l[1]*=255,l[2]*=255,l},ll.gl=function(){for(var s=[],n=arguments.length;n--;)s[n]=arguments[n];return new(Function.prototype.bind.apply(ha,[null].concat(s,["gl"])))},ha.prototype.gl=function(){var s=this._rgb;return[s[0]/255,s[1]/255,s[2]/255,s[3]]};var _l=y.unpack,vl=function(){for(var s=[],n=arguments.length;n--;)s[n]=arguments[n];var l=_l(s,"rgb"),d=l[0],x=l[1],B=l[2],A=Math.min(d,x,B),S=Math.max(d,x,B),C=S-A,E=C*100/255,k=A/(255-C)*100,U;return C===0?U=Number.NaN:(d===S&&(U=(x-B)/C),x===S&&(U=2+(B-d)/C),B===S&&(U=4+(d-x)/C),U*=60,U<0&&(U+=360)),[U,E,k]},pl=vl,fl=y.unpack,yl=Math.floor,dl=function(){for(var s,n,l,d,x,B,A=[],S=arguments.length;S--;)A[S]=arguments[S];A=fl(A,"hcg");var C=A[0],E=A[1],k=A[2],U,F,j;k=k*255;var W=E*255;if(E===0)U=F=j=k;else{C===360&&(C=0),C>360&&(C-=360),C<0&&(C+=360),C/=60;var ht=yl(C),gt=C-ht,It=k*(1-E),kt=It+W*(1-gt),Ee=It+W*gt,Me=It+W;switch(ht){case 0:s=[Me,Ee,It],U=s[0],F=s[1],j=s[2];break;case 1:n=[kt,Me,It],U=n[0],F=n[1],j=n[2];break;case 2:l=[It,Me,Ee],U=l[0],F=l[1],j=l[2];break;case 3:d=[It,kt,Me],U=d[0],F=d[1],j=d[2];break;case 4:x=[Ee,It,Me],U=x[0],F=x[1],j=x[2];break;case 5:B=[Me,It,kt],U=B[0],F=B[1],j=B[2];break}}return[U,F,j,A.length>3?A[3]:1]},gl=dl,Al=y.unpack,bl=y.type,xl=L,ma=V,la=w,Bl=pl;ma.prototype.hcg=function(){return Bl(this._rgb)},xl.hcg=function(){for(var s=[],n=arguments.length;n--;)s[n]=arguments[n];return new(Function.prototype.bind.apply(ma,[null].concat(s,["hcg"])))},la.format.hcg=gl,la.autodetect.push({p:1,test:function(){for(var s=[],n=arguments.length;n--;)s[n]=arguments[n];if(s=Al(s,"hcg"),bl(s)==="array"&&s.length===3)return"hcg"}});var wl=y.unpack,Sl=y.last,As=Math.round,Cl=function(){for(var s=[],n=arguments.length;n--;)s[n]=arguments[n];var l=wl(s,"rgba"),d=l[0],x=l[1],B=l[2],A=l[3],S=Sl(s)||"auto";A===void 0&&(A=1),S==="auto"&&(S=A<1?"rgba":"rgb"),d=As(d),x=As(x),B=As(B);var C=d<<16|x<<8|B,E="000000"+C.toString(16);E=E.substr(E.length-6);var k="0"+As(A*255).toString(16);switch(k=k.substr(k.length-2),S.toLowerCase()){case"rgba":return"#"+E+k;case"argb":return"#"+k+E;default:return"#"+E}},ca=Cl,Ml=/^#?([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/,Tl=/^#?([A-Fa-f0-9]{8}|[A-Fa-f0-9]{4})$/,Il=function(s){if(s.match(Ml)){(s.length===4||s.length===7)&&(s=s.substr(1)),s.length===3&&(s=s.split(""),s=s[0]+s[0]+s[1]+s[1]+s[2]+s[2]);var n=parseInt(s,16),l=n>>16,d=n>>8&255,x=n&255;return[l,d,x,1]}if(s.match(Tl)){(s.length===5||s.length===9)&&(s=s.substr(1)),s.length===4&&(s=s.split(""),s=s[0]+s[0]+s[1]+s[1]+s[2]+s[2]+s[3]+s[3]);var B=parseInt(s,16),A=B>>24&255,S=B>>16&255,C=B>>8&255,E=Math.round((B&255)/255*100)/100;return[A,S,C,E]}throw new Error("unknown hex color: "+s)},ua=Il,$l=L,_a=V,El=y.type,va=w,Pl=ca;_a.prototype.hex=function(s){return Pl(this._rgb,s)},$l.hex=function(){for(var s=[],n=arguments.length;n--;)s[n]=arguments[n];return new(Function.prototype.bind.apply(_a,[null].concat(s,["hex"])))},va.format.hex=ua,va.autodetect.push({p:4,test:function(s){for(var n=[],l=arguments.length-1;l-- >0;)n[l]=arguments[l+1];if(!n.length&&El(s)==="string"&&[3,4,5,6,7,8,9].indexOf(s.length)>=0)return"hex"}});var Vl=y.unpack,pa=y.TWOPI,zl=Math.min,Ll=Math.sqrt,kl=Math.acos,Fl=function(){for(var s=[],n=arguments.length;n--;)s[n]=arguments[n];var l=Vl(s,"rgb"),d=l[0],x=l[1],B=l[2];d/=255,x/=255,B/=255;var A,S=zl(d,x,B),C=(d+x+B)/3,E=C>0?1-S/C:0;return E===0?A=NaN:(A=(d-x+(d-B))/2,A/=Ll((d-x)*(d-x)+(d-B)*(x-B)),A=kl(A),B>x&&(A=pa-A),A/=pa),[A*360,E,C]},Rl=Fl,ql=y.unpack,fo=y.limit,Ci=y.TWOPI,yo=y.PITHIRD,Mi=Math.cos,Dl=function(){for(var s=[],n=arguments.length;n--;)s[n]=arguments[n];s=ql(s,"hsi");var l=s[0],d=s[1],x=s[2],B,A,S;return isNaN(l)&&(l=0),isNaN(d)&&(d=0),l>360&&(l-=360),l<0&&(l+=360),l/=360,l<1/3?(S=(1-d)/3,B=(1+d*Mi(Ci*l)/Mi(yo-Ci*l))/3,A=1-(S+B)):l<2/3?(l-=1/3,B=(1-d)/3,A=(1+d*Mi(Ci*l)/Mi(yo-Ci*l))/3,S=1-(B+A)):(l-=2/3,A=(1-d)/3,S=(1+d*Mi(Ci*l)/Mi(yo-Ci*l))/3,B=1-(A+S)),B=fo(x*B*3),A=fo(x*A*3),S=fo(x*S*3),[B*255,A*255,S*255,s.length>3?s[3]:1]},Nl=Dl,Ol=y.unpack,Gl=y.type,Jl=L,fa=V,ya=w,Ul=Rl;fa.prototype.hsi=function(){return Ul(this._rgb)},Jl.hsi=function(){for(var s=[],n=arguments.length;n--;)s[n]=arguments[n];return new(Function.prototype.bind.apply(fa,[null].concat(s,["hsi"])))},ya.format.hsi=Nl,ya.autodetect.push({p:2,test:function(){for(var s=[],n=arguments.length;n--;)s[n]=arguments[n];if(s=Ol(s,"hsi"),Gl(s)==="array"&&s.length===3)return"hsi"}});var Yl=y.unpack,Wl=y.type,jl=L,da=V,ga=w,Hl=$e;da.prototype.hsl=function(){return Hl(this._rgb)},jl.hsl=function(){for(var s=[],n=arguments.length;n--;)s[n]=arguments[n];return new(Function.prototype.bind.apply(da,[null].concat(s,["hsl"])))},ga.format.hsl=jn,ga.autodetect.push({p:2,test:function(){for(var s=[],n=arguments.length;n--;)s[n]=arguments[n];if(s=Yl(s,"hsl"),Wl(s)==="array"&&s.length===3)return"hsl"}});var Zl=y.unpack,Xl=Math.min,Kl=Math.max,Ql=function(){for(var s=[],n=arguments.length;n--;)s[n]=arguments[n];s=Zl(s,"rgb");var l=s[0],d=s[1],x=s[2],B=Xl(l,d,x),A=Kl(l,d,x),S=A-B,C,E,k;return k=A/255,A===0?(C=Number.NaN,E=0):(E=S/A,l===A&&(C=(d-x)/S),d===A&&(C=2+(x-l)/S),x===A&&(C=4+(l-d)/S),C*=60,C<0&&(C+=360)),[C,E,k]},tc=Ql,ec=y.unpack,rc=Math.floor,ic=function(){for(var s,n,l,d,x,B,A=[],S=arguments.length;S--;)A[S]=arguments[S];A=ec(A,"hsv");var C=A[0],E=A[1],k=A[2],U,F,j;if(k*=255,E===0)U=F=j=k;else{C===360&&(C=0),C>360&&(C-=360),C<0&&(C+=360),C/=60;var W=rc(C),ht=C-W,gt=k*(1-E),It=k*(1-E*ht),kt=k*(1-E*(1-ht));switch(W){case 0:s=[k,kt,gt],U=s[0],F=s[1],j=s[2];break;case 1:n=[It,k,gt],U=n[0],F=n[1],j=n[2];break;case 2:l=[gt,k,kt],U=l[0],F=l[1],j=l[2];break;case 3:d=[gt,It,k],U=d[0],F=d[1],j=d[2];break;case 4:x=[kt,gt,k],U=x[0],F=x[1],j=x[2];break;case 5:B=[k,gt,It],U=B[0],F=B[1],j=B[2];break}}return[U,F,j,A.length>3?A[3]:1]},sc=ic,oc=y.unpack,nc=y.type,ac=L,Aa=V,ba=w,hc=tc;Aa.prototype.hsv=function(){return hc(this._rgb)},ac.hsv=function(){for(var s=[],n=arguments.length;n--;)s[n]=arguments[n];return new(Function.prototype.bind.apply(Aa,[null].concat(s,["hsv"])))},ba.format.hsv=sc,ba.autodetect.push({p:2,test:function(){for(var s=[],n=arguments.length;n--;)s[n]=arguments[n];if(s=oc(s,"hsv"),nc(s)==="array"&&s.length===3)return"hsv"}});var bs={Kn:18,Xn:.95047,Yn:1,Zn:1.08883,t0:.137931034,t1:.206896552,t2:.12841855,t3:.008856452},Ti=bs,mc=y.unpack,xa=Math.pow,lc=function(){for(var s=[],n=arguments.length;n--;)s[n]=arguments[n];var l=mc(s,"rgb"),d=l[0],x=l[1],B=l[2],A=cc(d,x,B),S=A[0],C=A[1],E=A[2],k=116*C-16;return[k<0?0:k,500*(S-C),200*(C-E)]},go=function(s){return(s/=255)<=.04045?s/12.92:xa((s+.055)/1.055,2.4)},Ao=function(s){return s>Ti.t3?xa(s,1/3):s/Ti.t2+Ti.t0},cc=function(s,n,l){s=go(s),n=go(n),l=go(l);var d=Ao((.4124564*s+.3575761*n+.1804375*l)/Ti.Xn),x=Ao((.2126729*s+.7151522*n+.072175*l)/Ti.Yn),B=Ao((.0193339*s+.119192*n+.9503041*l)/Ti.Zn);return[d,x,B]},Ba=lc,Ii=bs,uc=y.unpack,_c=Math.pow,vc=function(){for(var s=[],n=arguments.length;n--;)s[n]=arguments[n];s=uc(s,"lab");var l=s[0],d=s[1],x=s[2],B,A,S,C,E,k;return A=(l+16)/116,B=isNaN(d)?A:A+d/500,S=isNaN(x)?A:A-x/200,A=Ii.Yn*xo(A),B=Ii.Xn*xo(B),S=Ii.Zn*xo(S),C=bo(3.2404542*B-1.5371385*A-.4985314*S),E=bo(-.969266*B+1.8760108*A+.041556*S),k=bo(.0556434*B-.2040259*A+1.0572252*S),[C,E,k,s.length>3?s[3]:1]},bo=function(s){return 255*(s<=.00304?12.92*s:1.055*_c(s,1/2.4)-.055)},xo=function(s){return s>Ii.t1?s*s*s:Ii.t2*(s-Ii.t0)},wa=vc,pc=y.unpack,fc=y.type,yc=L,Sa=V,Ca=w,dc=Ba;Sa.prototype.lab=function(){return dc(this._rgb)},yc.lab=function(){for(var s=[],n=arguments.length;n--;)s[n]=arguments[n];return new(Function.prototype.bind.apply(Sa,[null].concat(s,["lab"])))},Ca.format.lab=wa,Ca.autodetect.push({p:2,test:function(){for(var s=[],n=arguments.length;n--;)s[n]=arguments[n];if(s=pc(s,"lab"),fc(s)==="array"&&s.length===3)return"lab"}});var gc=y.unpack,Ac=y.RAD2DEG,bc=Math.sqrt,xc=Math.atan2,Bc=Math.round,wc=function(){for(var s=[],n=arguments.length;n--;)s[n]=arguments[n];var l=gc(s,"lab"),d=l[0],x=l[1],B=l[2],A=bc(x*x+B*B),S=(xc(B,x)*Ac+360)%360;return Bc(A*1e4)===0&&(S=Number.NaN),[d,A,S]},Ma=wc,Sc=y.unpack,Cc=Ba,Mc=Ma,Tc=function(){for(var s=[],n=arguments.length;n--;)s[n]=arguments[n];var l=Sc(s,"rgb"),d=l[0],x=l[1],B=l[2],A=Cc(d,x,B),S=A[0],C=A[1],E=A[2];return Mc(S,C,E)},Ic=Tc,$c=y.unpack,Ec=y.DEG2RAD,Pc=Math.sin,Vc=Math.cos,zc=function(){for(var s=[],n=arguments.length;n--;)s[n]=arguments[n];var l=$c(s,"lch"),d=l[0],x=l[1],B=l[2];return isNaN(B)&&(B=0),B=B*Ec,[d,Vc(B)*x,Pc(B)*x]},Ta=zc,Lc=y.unpack,kc=Ta,Fc=wa,Rc=function(){for(var s=[],n=arguments.length;n--;)s[n]=arguments[n];s=Lc(s,"lch");var l=s[0],d=s[1],x=s[2],B=kc(l,d,x),A=B[0],S=B[1],C=B[2],E=Fc(A,S,C),k=E[0],U=E[1],F=E[2];return[k,U,F,s.length>3?s[3]:1]},Ia=Rc,qc=y.unpack,Dc=Ia,Nc=function(){for(var s=[],n=arguments.length;n--;)s[n]=arguments[n];var l=qc(s,"hcl").reverse();return Dc.apply(void 0,l)},Oc=Nc,Gc=y.unpack,Jc=y.type,$a=L,xs=V,Bo=w,Ea=Ic;xs.prototype.lch=function(){return Ea(this._rgb)},xs.prototype.hcl=function(){return Ea(this._rgb).reverse()},$a.lch=function(){for(var s=[],n=arguments.length;n--;)s[n]=arguments[n];return new(Function.prototype.bind.apply(xs,[null].concat(s,["lch"])))},$a.hcl=function(){for(var s=[],n=arguments.length;n--;)s[n]=arguments[n];return new(Function.prototype.bind.apply(xs,[null].concat(s,["hcl"])))},Bo.format.lch=Ia,Bo.format.hcl=Oc,["lch","hcl"].forEach(function(s){return Bo.autodetect.push({p:2,test:function(){for(var n=[],l=arguments.length;l--;)n[l]=arguments[l];if(n=Gc(n,s),Jc(n)==="array"&&n.length===3)return s}})});var Uc={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflower:"#6495ed",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",laserlemon:"#ffff54",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrod:"#fafad2",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",maroon2:"#7f0000",maroon3:"#b03060",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",purple2:"#7f007f",purple3:"#a020f0",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},Pa=Uc,Yc=V,Va=w,Wc=y.type,ji=Pa,jc=ua,Hc=ca;Yc.prototype.name=function(){for(var s=Hc(this._rgb,"rgb"),n=0,l=Object.keys(ji);n<l.length;n+=1){var d=l[n];if(ji[d]===s)return d.toLowerCase()}return s},Va.format.named=function(s){if(s=s.toLowerCase(),ji[s])return jc(ji[s]);throw new Error("unknown color name: "+s)},Va.autodetect.push({p:5,test:function(s){for(var n=[],l=arguments.length-1;l-- >0;)n[l]=arguments[l+1];if(!n.length&&Wc(s)==="string"&&ji[s.toLowerCase()])return"named"}});var Zc=y.unpack,Xc=function(){for(var s=[],n=arguments.length;n--;)s[n]=arguments[n];var l=Zc(s,"rgb"),d=l[0],x=l[1],B=l[2];return(d<<16)+(x<<8)+B},Kc=Xc,Qc=y.type,tu=function(s){if(Qc(s)=="number"&&s>=0&&s<=16777215){var n=s>>16,l=s>>8&255,d=s&255;return[n,l,d,1]}throw new Error("unknown num color: "+s)},eu=tu,ru=L,za=V,La=w,iu=y.type,su=Kc;za.prototype.num=function(){return su(this._rgb)},ru.num=function(){for(var s=[],n=arguments.length;n--;)s[n]=arguments[n];return new(Function.prototype.bind.apply(za,[null].concat(s,["num"])))},La.format.num=eu,La.autodetect.push({p:5,test:function(){for(var s=[],n=arguments.length;n--;)s[n]=arguments[n];if(s.length===1&&iu(s[0])==="number"&&s[0]>=0&&s[0]<=16777215)return"num"}});var ou=L,wo=V,ka=w,Fa=y.unpack,Ra=y.type,qa=Math.round;wo.prototype.rgb=function(s){return s===void 0&&(s=!0),s===!1?this._rgb.slice(0,3):this._rgb.slice(0,3).map(qa)},wo.prototype.rgba=function(s){return s===void 0&&(s=!0),this._rgb.slice(0,4).map(function(n,l){return l<3?s===!1?n:qa(n):n})},ou.rgb=function(){for(var s=[],n=arguments.length;n--;)s[n]=arguments[n];return new(Function.prototype.bind.apply(wo,[null].concat(s,["rgb"])))},ka.format.rgb=function(){for(var s=[],n=arguments.length;n--;)s[n]=arguments[n];var l=Fa(s,"rgba");return l[3]===void 0&&(l[3]=1),l},ka.autodetect.push({p:3,test:function(){for(var s=[],n=arguments.length;n--;)s[n]=arguments[n];if(s=Fa(s,"rgba"),Ra(s)==="array"&&(s.length===3||s.length===4&&Ra(s[3])=="number"&&s[3]>=0&&s[3]<=1))return"rgb"}});var Bs=Math.log,nu=function(s){var n=s/100,l,d,x;return n<66?(l=255,d=n<6?0:-155.25485562709179-.44596950469579133*(d=n-2)+104.49216199393888*Bs(d),x=n<20?0:-254.76935184120902+.8274096064007395*(x=n-10)+115.67994401066147*Bs(x)):(l=351.97690566805693+.114206453784165*(l=n-55)-40.25366309332127*Bs(l),d=325.4494125711974+.07943456536662342*(d=n-50)-28.0852963507957*Bs(d),x=255),[l,d,x,1]},Da=nu,au=Da,hu=y.unpack,mu=Math.round,lu=function(){for(var s=[],n=arguments.length;n--;)s[n]=arguments[n];for(var l=hu(s,"rgb"),d=l[0],x=l[2],B=1e3,A=4e4,S=.4,C;A-B>S;){C=(A+B)*.5;var E=au(C);E[2]/E[0]>=x/d?A=C:B=C}return mu(C)},cu=lu,So=L,ws=V,Co=w,uu=cu;ws.prototype.temp=ws.prototype.kelvin=ws.prototype.temperature=function(){return uu(this._rgb)},So.temp=So.kelvin=So.temperature=function(){for(var s=[],n=arguments.length;n--;)s[n]=arguments[n];return new(Function.prototype.bind.apply(ws,[null].concat(s,["temp"])))},Co.format.temp=Co.format.kelvin=Co.format.temperature=Da;var _u=y.unpack,Mo=Math.cbrt,vu=Math.pow,pu=Math.sign,fu=function(){for(var s=[],n=arguments.length;n--;)s[n]=arguments[n];var l=_u(s,"rgb"),d=l[0],x=l[1],B=l[2],A=[To(d/255),To(x/255),To(B/255)],S=A[0],C=A[1],E=A[2],k=Mo(.4122214708*S+.5363325363*C+.0514459929*E),U=Mo(.2119034982*S+.6806995451*C+.1073969566*E),F=Mo(.0883024619*S+.2817188376*C+.6299787005*E);return[.2104542553*k+.793617785*U-.0040720468*F,1.9779984951*k-2.428592205*U+.4505937099*F,.0259040371*k+.7827717662*U-.808675766*F]},Na=fu;function To(s){var n=Math.abs(s);return n<.04045?s/12.92:(pu(s)||1)*vu((n+.055)/1.055,2.4)}var yu=y.unpack,Ss=Math.pow,du=Math.sign,gu=function(){for(var s=[],n=arguments.length;n--;)s[n]=arguments[n];s=yu(s,"lab");var l=s[0],d=s[1],x=s[2],B=Ss(l+.3963377774*d+.2158037573*x,3),A=Ss(l-.1055613458*d-.0638541728*x,3),S=Ss(l-.0894841775*d-1.291485548*x,3);return[255*Io(4.0767416621*B-3.3077115913*A+.2309699292*S),255*Io(-1.2684380046*B+2.6097574011*A-.3413193965*S),255*Io(-.0041960863*B-.7034186147*A+1.707614701*S),s.length>3?s[3]:1]},Oa=gu;function Io(s){var n=Math.abs(s);return n>.0031308?(du(s)||1)*(1.055*Ss(n,1/2.4)-.055):s*12.92}var Au=y.unpack,bu=y.type,xu=L,Ga=V,Ja=w,Bu=Na;Ga.prototype.oklab=function(){return Bu(this._rgb)},xu.oklab=function(){for(var s=[],n=arguments.length;n--;)s[n]=arguments[n];return new(Function.prototype.bind.apply(Ga,[null].concat(s,["oklab"])))},Ja.format.oklab=Oa,Ja.autodetect.push({p:3,test:function(){for(var s=[],n=arguments.length;n--;)s[n]=arguments[n];if(s=Au(s,"oklab"),bu(s)==="array"&&s.length===3)return"oklab"}});var wu=y.unpack,Su=Na,Cu=Ma,Mu=function(){for(var s=[],n=arguments.length;n--;)s[n]=arguments[n];var l=wu(s,"rgb"),d=l[0],x=l[1],B=l[2],A=Su(d,x,B),S=A[0],C=A[1],E=A[2];return Cu(S,C,E)},Tu=Mu,Iu=y.unpack,$u=Ta,Eu=Oa,Pu=function(){for(var s=[],n=arguments.length;n--;)s[n]=arguments[n];s=Iu(s,"lch");var l=s[0],d=s[1],x=s[2],B=$u(l,d,x),A=B[0],S=B[1],C=B[2],E=Eu(A,S,C),k=E[0],U=E[1],F=E[2];return[k,U,F,s.length>3?s[3]:1]},Vu=Pu,zu=y.unpack,Lu=y.type,ku=L,Ua=V,Ya=w,Fu=Tu;Ua.prototype.oklch=function(){return Fu(this._rgb)},ku.oklch=function(){for(var s=[],n=arguments.length;n--;)s[n]=arguments[n];return new(Function.prototype.bind.apply(Ua,[null].concat(s,["oklch"])))},Ya.format.oklch=Vu,Ya.autodetect.push({p:3,test:function(){for(var s=[],n=arguments.length;n--;)s[n]=arguments[n];if(s=zu(s,"oklch"),Lu(s)==="array"&&s.length===3)return"oklch"}});var Wa=V,Ru=y.type;Wa.prototype.alpha=function(s,n){return n===void 0&&(n=!1),s!==void 0&&Ru(s)==="number"?n?(this._rgb[3]=s,this):new Wa([this._rgb[0],this._rgb[1],this._rgb[2],s],"rgb"):this._rgb[3]};var qu=V;qu.prototype.clipped=function(){return this._rgb._clipped||!1};var _i=V,Du=bs;_i.prototype.darken=function(s){s===void 0&&(s=1);var n=this,l=n.lab();return l[0]-=Du.Kn*s,new _i(l,"lab").alpha(n.alpha(),!0)},_i.prototype.brighten=function(s){return s===void 0&&(s=1),this.darken(-s)},_i.prototype.darker=_i.prototype.darken,_i.prototype.brighter=_i.prototype.brighten;var Nu=V;Nu.prototype.get=function(s){var n=s.split("."),l=n[0],d=n[1],x=this[l]();if(d){var B=l.indexOf(d)-(l.substr(0,2)==="ok"?2:0);if(B>-1)return x[B];throw new Error("unknown channel "+d+" in mode "+l)}else return x};var $i=V,Ou=y.type,Gu=Math.pow,Ju=1e-7,Uu=20;$i.prototype.luminance=function(s){if(s!==void 0&&Ou(s)==="number"){if(s===0)return new $i([0,0,0,this._rgb[3]],"rgb");if(s===1)return new $i([255,255,255,this._rgb[3]],"rgb");var n=this.luminance(),l="rgb",d=Uu,x=function(A,S){var C=A.interpolate(S,.5,l),E=C.luminance();return Math.abs(s-E)<Ju||!d--?C:E>s?x(A,C):x(C,S)},B=(n>s?x(new $i([0,0,0]),this):x(this,new $i([255,255,255]))).rgb();return new $i(B.concat([this._rgb[3]]))}return Yu.apply(void 0,this._rgb.slice(0,3))};var Yu=function(s,n,l){return s=$o(s),n=$o(n),l=$o(l),.2126*s+.7152*n+.0722*l},$o=function(s){return s/=255,s<=.03928?s/12.92:Gu((s+.055)/1.055,2.4)},rr={},ja=V,Ha=y.type,Cs=rr,Za=function(s,n,l){l===void 0&&(l=.5);for(var d=[],x=arguments.length-3;x-- >0;)d[x]=arguments[x+3];var B=d[0]||"lrgb";if(!Cs[B]&&!d.length&&(B=Object.keys(Cs)[0]),!Cs[B])throw new Error("interpolation mode "+B+" is not defined");return Ha(s)!=="object"&&(s=new ja(s)),Ha(n)!=="object"&&(n=new ja(n)),Cs[B](s,n,l).alpha(s.alpha()+l*(n.alpha()-s.alpha()))},Xa=V,Wu=Za;Xa.prototype.mix=Xa.prototype.interpolate=function(s,n){n===void 0&&(n=.5);for(var l=[],d=arguments.length-2;d-- >0;)l[d]=arguments[d+2];return Wu.apply(void 0,[this,s,n].concat(l))};var Ka=V;Ka.prototype.premultiply=function(s){s===void 0&&(s=!1);var n=this._rgb,l=n[3];return s?(this._rgb=[n[0]*l,n[1]*l,n[2]*l,l],this):new Ka([n[0]*l,n[1]*l,n[2]*l,l],"rgb")};var Eo=V,ju=bs;Eo.prototype.saturate=function(s){s===void 0&&(s=1);var n=this,l=n.lch();return l[1]+=ju.Kn*s,l[1]<0&&(l[1]=0),new Eo(l,"lch").alpha(n.alpha(),!0)},Eo.prototype.desaturate=function(s){return s===void 0&&(s=1),this.saturate(-s)};var Qa=V,th=y.type;Qa.prototype.set=function(s,n,l){l===void 0&&(l=!1);var d=s.split("."),x=d[0],B=d[1],A=this[x]();if(B){var S=x.indexOf(B)-(x.substr(0,2)==="ok"?2:0);if(S>-1){if(th(n)=="string")switch(n.charAt(0)){case"+":A[S]+=+n;break;case"-":A[S]+=+n;break;case"*":A[S]*=+n.substr(1);break;case"/":A[S]/=+n.substr(1);break;default:A[S]=+n}else if(th(n)==="number")A[S]=n;else throw new Error("unsupported value for Color.set");var C=new Qa(A,x);return l?(this._rgb=C._rgb,this):C}throw new Error("unknown channel "+B+" in mode "+x)}else return A};var Hu=V,Zu=function(s,n,l){var d=s._rgb,x=n._rgb;return new Hu(d[0]+l*(x[0]-d[0]),d[1]+l*(x[1]-d[1]),d[2]+l*(x[2]-d[2]),"rgb")};rr.rgb=Zu;var Xu=V,Po=Math.sqrt,Ei=Math.pow,Ku=function(s,n,l){var d=s._rgb,x=d[0],B=d[1],A=d[2],S=n._rgb,C=S[0],E=S[1],k=S[2];return new Xu(Po(Ei(x,2)*(1-l)+Ei(C,2)*l),Po(Ei(B,2)*(1-l)+Ei(E,2)*l),Po(Ei(A,2)*(1-l)+Ei(k,2)*l),"rgb")};rr.lrgb=Ku;var Qu=V,t_=function(s,n,l){var d=s.lab(),x=n.lab();return new Qu(d[0]+l*(x[0]-d[0]),d[1]+l*(x[1]-d[1]),d[2]+l*(x[2]-d[2]),"lab")};rr.lab=t_;var eh=V,Pi=function(s,n,l,d){var x,B,A,S;d==="hsl"?(A=s.hsl(),S=n.hsl()):d==="hsv"?(A=s.hsv(),S=n.hsv()):d==="hcg"?(A=s.hcg(),S=n.hcg()):d==="hsi"?(A=s.hsi(),S=n.hsi()):d==="lch"||d==="hcl"?(d="hcl",A=s.hcl(),S=n.hcl()):d==="oklch"&&(A=s.oklch().reverse(),S=n.oklch().reverse());var C,E,k,U,F,j;(d.substr(0,1)==="h"||d==="oklch")&&(x=A,C=x[0],k=x[1],F=x[2],B=S,E=B[0],U=B[1],j=B[2]);var W,ht,gt,It;return!isNaN(C)&&!isNaN(E)?(E>C&&E-C>180?It=E-(C+360):E<C&&C-E>180?It=E+360-C:It=E-C,ht=C+l*It):isNaN(C)?isNaN(E)?ht=Number.NaN:(ht=E,(F==1||F==0)&&d!="hsv"&&(W=U)):(ht=C,(j==1||j==0)&&d!="hsv"&&(W=k)),W===void 0&&(W=k+l*(U-k)),gt=F+l*(j-F),d==="oklch"?new eh([gt,W,ht],d):new eh([ht,W,gt],d)},e_=Pi,rh=function(s,n,l){return e_(s,n,l,"lch")};rr.lch=rh,rr.hcl=rh;var r_=V,i_=function(s,n,l){var d=s.num(),x=n.num();return new r_(d+l*(x-d),"num")};rr.num=i_;var s_=Pi,o_=function(s,n,l){return s_(s,n,l,"hcg")};rr.hcg=o_;var n_=Pi,a_=function(s,n,l){return n_(s,n,l,"hsi")};rr.hsi=a_;var h_=Pi,m_=function(s,n,l){return h_(s,n,l,"hsl")};rr.hsl=m_;var l_=Pi,c_=function(s,n,l){return l_(s,n,l,"hsv")};rr.hsv=c_;var u_=V,__=function(s,n,l){var d=s.oklab(),x=n.oklab();return new u_(d[0]+l*(x[0]-d[0]),d[1]+l*(x[1]-d[1]),d[2]+l*(x[2]-d[2]),"oklab")};rr.oklab=__;var v_=Pi,p_=function(s,n,l){return v_(s,n,l,"oklch")};rr.oklch=p_;var Vo=V,f_=y.clip_rgb,zo=Math.pow,Lo=Math.sqrt,ko=Math.PI,ih=Math.cos,sh=Math.sin,y_=Math.atan2,d_=function(s,n,l){n===void 0&&(n="lrgb"),l===void 0&&(l=null);var d=s.length;l||(l=Array.from(new Array(d)).map(function(){return 1}));var x=d/l.reduce(function(ht,gt){return ht+gt});if(l.forEach(function(ht,gt){l[gt]*=x}),s=s.map(function(ht){return new Vo(ht)}),n==="lrgb")return g_(s,l);for(var B=s.shift(),A=B.get(n),S=[],C=0,E=0,k=0;k<A.length;k++)if(A[k]=(A[k]||0)*l[0],S.push(isNaN(A[k])?0:l[0]),n.charAt(k)==="h"&&!isNaN(A[k])){var U=A[k]/180*ko;C+=ih(U)*l[0],E+=sh(U)*l[0]}var F=B.alpha()*l[0];s.forEach(function(ht,gt){var It=ht.get(n);F+=ht.alpha()*l[gt+1];for(var kt=0;kt<A.length;kt++)if(!isNaN(It[kt]))if(S[kt]+=l[gt+1],n.charAt(kt)==="h"){var Ee=It[kt]/180*ko;C+=ih(Ee)*l[gt+1],E+=sh(Ee)*l[gt+1]}else A[kt]+=It[kt]*l[gt+1]});for(var j=0;j<A.length;j++)if(n.charAt(j)==="h"){for(var W=y_(E/S[j],C/S[j])/ko*180;W<0;)W+=360;for(;W>=360;)W-=360;A[j]=W}else A[j]=A[j]/S[j];return F/=d,new Vo(A,n).alpha(F>.99999?1:F,!0)},g_=function(s,n){for(var l=s.length,d=[0,0,0,0],x=0;x<s.length;x++){var B=s[x],A=n[x]/l,S=B._rgb;d[0]+=zo(S[0],2)*A,d[1]+=zo(S[1],2)*A,d[2]+=zo(S[2],2)*A,d[3]+=S[3]*A}return d[0]=Lo(d[0]),d[1]=Lo(d[1]),d[2]=Lo(d[2]),d[3]>.9999999&&(d[3]=1),new Vo(f_(d))},pr=L,Vi=y.type,A_=Math.pow,Fo=function(s){var n="rgb",l=pr("#ccc"),d=0,x=[0,1],B=[],A=[0,0],S=!1,C=[],E=!1,k=0,U=1,F=!1,j={},W=!0,ht=1,gt=function(R){if(R=R||["#fff","#000"],R&&Vi(R)==="string"&&pr.brewer&&pr.brewer[R.toLowerCase()]&&(R=pr.brewer[R.toLowerCase()]),Vi(R)==="array"){R.length===1&&(R=[R[0],R[0]]),R=R.slice(0);for(var X=0;X<R.length;X++)R[X]=pr(R[X]);B.length=0;for(var _t=0;_t<R.length;_t++)B.push(_t/(R.length-1))}return Ke(),C=R},It=function(R){if(S!=null){for(var X=S.length-1,_t=0;_t<X&&R>=S[_t];)_t++;return _t-1}return 0},kt=function(R){return R},Ee=function(R){return R},Me=function(R,X){var _t,mt;if(X==null&&(X=!1),isNaN(R)||R===null)return l;if(X)mt=R;else if(S&&S.length>2){var Pe=It(R);mt=Pe/(S.length-2)}else U!==k?mt=(R-k)/(U-k):mt=1;mt=Ee(mt),X||(mt=kt(mt)),ht!==1&&(mt=A_(mt,ht)),mt=A[0]+mt*(1-A[0]-A[1]),mt=Math.min(1,Math.max(0,mt));var Qt=Math.floor(mt*1e4);if(W&&j[Qt])_t=j[Qt];else{if(Vi(C)==="array")for(var $t=0;$t<B.length;$t++){var qt=B[$t];if(mt<=qt){_t=C[$t];break}if(mt>=qt&&$t===B.length-1){_t=C[$t];break}if(mt>qt&&mt<B[$t+1]){mt=(mt-qt)/(B[$t+1]-qt),_t=pr.interpolate(C[$t],C[$t+1],mt,n);break}}else Vi(C)==="function"&&(_t=C(mt));W&&(j[Qt]=_t)}return _t},Ke=function(){return j={}};gt(s);var St=function(R){var X=pr(Me(R));return E&&X[E]?X[E]():X};return St.classes=function(R){if(R!=null){if(Vi(R)==="array")S=R,x=[R[0],R[R.length-1]];else{var X=pr.analyze(x);R===0?S=[X.min,X.max]:S=pr.limits(X,"e",R)}return St}return S},St.domain=function(R){if(!arguments.length)return x;k=R[0],U=R[R.length-1],B=[];var X=C.length;if(R.length===X&&k!==U)for(var _t=0,mt=Array.from(R);_t<mt.length;_t+=1){var Pe=mt[_t];B.push((Pe-k)/(U-k))}else{for(var Qt=0;Qt<X;Qt++)B.push(Qt/(X-1));if(R.length>2){var $t=R.map(function(Dt,Ot){return Ot/(R.length-1)}),qt=R.map(function(Dt){return(Dt-k)/(U-k)});qt.every(function(Dt,Ot){return $t[Ot]===Dt})||(Ee=function(Dt){if(Dt<=0||Dt>=1)return Dt;for(var Ot=0;Dt>=qt[Ot+1];)Ot++;var yr=(Dt-qt[Ot])/(qt[Ot+1]-qt[Ot]),Xr=$t[Ot]+yr*($t[Ot+1]-$t[Ot]);return Xr})}}return x=[k,U],St},St.mode=function(R){return arguments.length?(n=R,Ke(),St):n},St.range=function(R,X){return gt(R),St},St.out=function(R){return E=R,St},St.spread=function(R){return arguments.length?(d=R,St):d},St.correctLightness=function(R){return R==null&&(R=!0),F=R,Ke(),F?kt=function(X){for(var _t=Me(0,!0).lab()[0],mt=Me(1,!0).lab()[0],Pe=_t>mt,Qt=Me(X,!0).lab()[0],$t=_t+(mt-_t)*X,qt=Qt-$t,Dt=0,Ot=1,yr=20;Math.abs(qt)>.01&&yr-- >0;)(function(){return Pe&&(qt*=-1),qt<0?(Dt=X,X+=(Ot-X)*.5):(Ot=X,X+=(Dt-X)*.5),Qt=Me(X,!0).lab()[0],qt=Qt-$t})();return X}:kt=function(X){return X},St},St.padding=function(R){return R!=null?(Vi(R)==="number"&&(R=[R,R]),A=R,St):A},St.colors=function(R,X){arguments.length<2&&(X="hex");var _t=[];if(arguments.length===0)_t=C.slice(0);else if(R===1)_t=[St(.5)];else if(R>1){var mt=x[0],Pe=x[1]-mt;_t=b_(0,R,!1).map(function(Ot){return St(mt+Ot/(R-1)*Pe)})}else{s=[];var Qt=[];if(S&&S.length>2)for(var $t=1,qt=S.length,Dt=1<=qt;Dt?$t<qt:$t>qt;Dt?$t++:$t--)Qt.push((S[$t-1]+S[$t])*.5);else Qt=x;_t=Qt.map(function(Ot){return St(Ot)})}return pr[X]&&(_t=_t.map(function(Ot){return Ot[X]()})),_t},St.cache=function(R){return R!=null?(W=R,St):W},St.gamma=function(R){return R!=null?(ht=R,St):ht},St.nodata=function(R){return R!=null?(l=pr(R),St):l},St};function b_(s,n,l){for(var d=[],x=s<n,B=l?x?n+1:n-1:n,A=s;x?A<B:A>B;x?A++:A--)d.push(A);return d}var Hi=V,x_=Fo,B_=function(s){for(var n=[1,1],l=1;l<s;l++){for(var d=[1],x=1;x<=n.length;x++)d[x]=(n[x]||0)+n[x-1];n=d}return n},w_=function(s){var n,l,d,x,B,A,S;if(s=s.map(function(F){return new Hi(F)}),s.length===2)n=s.map(function(F){return F.lab()}),B=n[0],A=n[1],x=function(F){var j=[0,1,2].map(function(W){return B[W]+F*(A[W]-B[W])});return new Hi(j,"lab")};else if(s.length===3)l=s.map(function(F){return F.lab()}),B=l[0],A=l[1],S=l[2],x=function(F){var j=[0,1,2].map(function(W){return(1-F)*(1-F)*B[W]+2*(1-F)*F*A[W]+F*F*S[W]});return new Hi(j,"lab")};else if(s.length===4){var C;d=s.map(function(F){return F.lab()}),B=d[0],A=d[1],S=d[2],C=d[3],x=function(F){var j=[0,1,2].map(function(W){return(1-F)*(1-F)*(1-F)*B[W]+3*(1-F)*(1-F)*F*A[W]+3*(1-F)*F*F*S[W]+F*F*F*C[W]});return new Hi(j,"lab")}}else if(s.length>=5){var E,k,U;E=s.map(function(F){return F.lab()}),U=s.length-1,k=B_(U),x=function(F){var j=1-F,W=[0,1,2].map(function(ht){return E.reduce(function(gt,It,kt){return gt+k[kt]*Math.pow(j,U-kt)*Math.pow(F,kt)*It[ht]},0)});return new Hi(W,"lab")}}else throw new RangeError("No point in running bezier with only one color.");return x},S_=function(s){var n=w_(s);return n.scale=function(){return x_(n)},n},Ro=L,fr=function(s,n,l){if(!fr[l])throw new Error("unknown blend mode "+l);return fr[l](s,n)},Hr=function(s){return function(n,l){var d=Ro(l).rgb(),x=Ro(n).rgb();return Ro.rgb(s(d,x))}},Zr=function(s){return function(n,l){var d=[];return d[0]=s(n[0],l[0]),d[1]=s(n[1],l[1]),d[2]=s(n[2],l[2]),d}},C_=function(s){return s},M_=function(s,n){return s*n/255},T_=function(s,n){return s>n?n:s},I_=function(s,n){return s>n?s:n},$_=function(s,n){return 255*(1-(1-s/255)*(1-n/255))},E_=function(s,n){return n<128?2*s*n/255:255*(1-2*(1-s/255)*(1-n/255))},P_=function(s,n){return 255*(1-(1-n/255)/(s/255))},V_=function(s,n){return s===255?255:(s=255*(n/255)/(1-s/255),s>255?255:s)};fr.normal=Hr(Zr(C_)),fr.multiply=Hr(Zr(M_)),fr.screen=Hr(Zr($_)),fr.overlay=Hr(Zr(E_)),fr.darken=Hr(Zr(T_)),fr.lighten=Hr(Zr(I_)),fr.dodge=Hr(Zr(V_)),fr.burn=Hr(Zr(P_));for(var z_=fr,qo=y.type,L_=y.clip_rgb,k_=y.TWOPI,F_=Math.pow,R_=Math.sin,q_=Math.cos,oh=L,D_=function(s,n,l,d,x){s===void 0&&(s=300),n===void 0&&(n=-1.5),l===void 0&&(l=1),d===void 0&&(d=1),x===void 0&&(x=[0,1]);var B=0,A;qo(x)==="array"?A=x[1]-x[0]:(A=0,x=[x,x]);var S=function(C){var E=k_*((s+120)/360+n*C),k=F_(x[0]+A*C,d),U=B!==0?l[0]+C*B:l,F=U*k*(1-k)/2,j=q_(E),W=R_(E),ht=k+F*(-.14861*j+1.78277*W),gt=k+F*(-.29227*j-.90649*W),It=k+F*(1.97294*j);return oh(L_([ht*255,gt*255,It*255,1]))};return S.start=function(C){return C==null?s:(s=C,S)},S.rotations=function(C){return C==null?n:(n=C,S)},S.gamma=function(C){return C==null?d:(d=C,S)},S.hue=function(C){return C==null?l:(l=C,qo(l)==="array"?(B=l[1]-l[0],B===0&&(l=l[1])):B=0,S)},S.lightness=function(C){return C==null?x:(qo(C)==="array"?(x=C,A=C[1]-C[0]):(x=[C,C],A=0),S)},S.scale=function(){return oh.scale(S)},S.hue(l),S},N_=V,O_="0123456789abcdef",G_=Math.floor,J_=Math.random,U_=function(){for(var s="#",n=0;n<6;n++)s+=O_.charAt(G_(J_()*16));return new N_(s,"hex")},Do=_,nh=Math.log,Y_=Math.pow,W_=Math.floor,j_=Math.abs,ah=function(s,n){n===void 0&&(n=null);var l={min:Number.MAX_VALUE,max:Number.MAX_VALUE*-1,sum:0,values:[],count:0};return Do(s)==="object"&&(s=Object.values(s)),s.forEach(function(d){n&&Do(d)==="object"&&(d=d[n]),d!=null&&!isNaN(d)&&(l.values.push(d),l.sum+=d,d<l.min&&(l.min=d),d>l.max&&(l.max=d),l.count+=1)}),l.domain=[l.min,l.max],l.limits=function(d,x){return hh(l,d,x)},l},hh=function(s,n,l){n===void 0&&(n="equal"),l===void 0&&(l=7),Do(s)=="array"&&(s=ah(s));var d=s.min,x=s.max,B=s.values.sort(function(Oo,Go){return Oo-Go});if(l===1)return[d,x];var A=[];if(n.substr(0,1)==="c"&&(A.push(d),A.push(x)),n.substr(0,1)==="e"){A.push(d);for(var S=1;S<l;S++)A.push(d+S/l*(x-d));A.push(x)}else if(n.substr(0,1)==="l"){if(d<=0)throw new Error("Logarithmic scales are only possible for values > 0");var C=Math.LOG10E*nh(d),E=Math.LOG10E*nh(x);A.push(d);for(var k=1;k<l;k++)A.push(Y_(10,C+k/l*(E-C)));A.push(x)}else if(n.substr(0,1)==="q"){A.push(d);for(var U=1;U<l;U++){var F=(B.length-1)*U/l,j=W_(F);if(j===F)A.push(B[j]);else{var W=F-j;A.push(B[j]*(1-W)+B[j+1]*W)}}A.push(x)}else if(n.substr(0,1)==="k"){var ht,gt=B.length,It=new Array(gt),kt=new Array(l),Ee=!0,Me=0,Ke=null;Ke=[],Ke.push(d);for(var St=1;St<l;St++)Ke.push(d+St/l*(x-d));for(Ke.push(x);Ee;){for(var R=0;R<l;R++)kt[R]=0;for(var X=0;X<gt;X++)for(var _t=B[X],mt=Number.MAX_VALUE,Pe=void 0,Qt=0;Qt<l;Qt++){var $t=j_(Ke[Qt]-_t);$t<mt&&(mt=$t,Pe=Qt),kt[Pe]++,It[X]=Pe}for(var qt=new Array(l),Dt=0;Dt<l;Dt++)qt[Dt]=null;for(var Ot=0;Ot<gt;Ot++)ht=It[Ot],qt[ht]===null?qt[ht]=B[Ot]:qt[ht]+=B[Ot];for(var yr=0;yr<l;yr++)qt[yr]*=1/kt[yr];Ee=!1;for(var Xr=0;Xr<l;Xr++)if(qt[Xr]!==Ke[Xr]){Ee=!0;break}Ke=qt,Me++,Me>200&&(Ee=!1)}for(var Kr={},zi=0;zi<l;zi++)Kr[zi]=[];for(var Li=0;Li<gt;Li++)ht=It[Li],Kr[ht].push(B[Li]);for(var Dr=[],vi=0;vi<l;vi++)Dr.push(Kr[vi][0]),Dr.push(Kr[vi][Kr[vi].length-1]);Dr=Dr.sort(function(Oo,Go){return Oo-Go}),A.push(Dr[0]);for(var Zi=1;Zi<Dr.length;Zi+=2){var pi=Dr[Zi];!isNaN(pi)&&A.indexOf(pi)===-1&&A.push(pi)}}return A},mh={analyze:ah,limits:hh},lh=V,H_=function(s,n){s=new lh(s),n=new lh(n);var l=s.luminance(),d=n.luminance();return l>d?(l+.05)/(d+.05):(d+.05)/(l+.05)},ch=V,qr=Math.sqrt,ve=Math.pow,Z_=Math.min,X_=Math.max,uh=Math.atan2,_h=Math.abs,Ms=Math.cos,vh=Math.sin,K_=Math.exp,ph=Math.PI,Q_=function(s,n,l,d,x){l===void 0&&(l=1),d===void 0&&(d=1),x===void 0&&(x=1);var B=function(pi){return 360*pi/(2*ph)},A=function(pi){return 2*ph*pi/360};s=new ch(s),n=new ch(n);var S=Array.from(s.lab()),C=S[0],E=S[1],k=S[2],U=Array.from(n.lab()),F=U[0],j=U[1],W=U[2],ht=(C+F)/2,gt=qr(ve(E,2)+ve(k,2)),It=qr(ve(j,2)+ve(W,2)),kt=(gt+It)/2,Ee=.5*(1-qr(ve(kt,7)/(ve(kt,7)+ve(25,7)))),Me=E*(1+Ee),Ke=j*(1+Ee),St=qr(ve(Me,2)+ve(k,2)),R=qr(ve(Ke,2)+ve(W,2)),X=(St+R)/2,_t=B(uh(k,Me)),mt=B(uh(W,Ke)),Pe=_t>=0?_t:_t+360,Qt=mt>=0?mt:mt+360,$t=_h(Pe-Qt)>180?(Pe+Qt+360)/2:(Pe+Qt)/2,qt=1-.17*Ms(A($t-30))+.24*Ms(A(2*$t))+.32*Ms(A(3*$t+6))-.2*Ms(A(4*$t-63)),Dt=Qt-Pe;Dt=_h(Dt)<=180?Dt:Qt<=Pe?Dt+360:Dt-360,Dt=2*qr(St*R)*vh(A(Dt)/2);var Ot=F-C,yr=R-St,Xr=1+.015*ve(ht-50,2)/qr(20+ve(ht-50,2)),Kr=1+.045*X,zi=1+.015*X*qt,Li=30*K_(-ve(($t-275)/25,2)),Dr=2*qr(ve(X,7)/(ve(X,7)+ve(25,7))),vi=-Dr*vh(2*A(Li)),Zi=qr(ve(Ot/(l*Xr),2)+ve(yr/(d*Kr),2)+ve(Dt/(x*zi),2)+vi*(yr/(d*Kr))*(Dt/(x*zi)));return X_(0,Z_(100,Zi))},fh=V,tv=function(s,n,l){l===void 0&&(l="lab"),s=new fh(s),n=new fh(n);var d=s.get(l),x=n.get(l),B=0;for(var A in d){var S=(d[A]||0)-(x[A]||0);B+=S*S}return Math.sqrt(B)},ev=V,rv=function(){for(var s=[],n=arguments.length;n--;)s[n]=arguments[n];try{return new(Function.prototype.bind.apply(ev,[null].concat(s))),!0}catch{return!1}},yh=L,dh=Fo,iv={cool:function(){return dh([yh.hsl(180,1,.9),yh.hsl(250,.7,.4)])},hot:function(){return dh(["#000","#f00","#ff0","#fff"]).mode("rgb")}},Ts={OrRd:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#b30000","#7f0000"],PuBu:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#045a8d","#023858"],BuPu:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#810f7c","#4d004b"],Oranges:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#a63603","#7f2704"],BuGn:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#006d2c","#00441b"],YlOrBr:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#993404","#662506"],YlGn:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#006837","#004529"],Reds:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#a50f15","#67000d"],RdPu:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177","#49006a"],Greens:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#006d2c","#00441b"],YlGnBu:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"],Purples:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#54278f","#3f007d"],GnBu:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#0868ac","#084081"],Greys:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525","#000000"],YlOrRd:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#bd0026","#800026"],PuRd:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#980043","#67001f"],Blues:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#08519c","#08306b"],PuBuGn:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016c59","#014636"],Viridis:["#440154","#482777","#3f4a8a","#31678e","#26838f","#1f9d8a","#6cce5a","#b6de2b","#fee825"],Spectral:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"],RdYlGn:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"],RdBu:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"],PiYG:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"],PRGn:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"],RdYlBu:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],BrBG:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"],RdGy:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"],PuOr:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"],Set2:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"],Accent:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17","#666666"],Set1:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999"],Set3:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f"],Dark2:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d","#666666"],Paired:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"],Pastel2:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc","#cccccc"],Pastel1:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec","#f2f2f2"]},No=0,gh=Object.keys(Ts);No<gh.length;No+=1){var Ah=gh[No];Ts[Ah.toLowerCase()]=Ts[Ah]}var sv=Ts,Ce=L;Ce.average=d_,Ce.bezier=S_,Ce.blend=z_,Ce.cubehelix=D_,Ce.mix=Ce.interpolate=Za,Ce.random=U_,Ce.scale=Fo,Ce.analyze=mh.analyze,Ce.contrast=H_,Ce.deltaE=Q_,Ce.distance=tv,Ce.limits=mh.limits,Ce.valid=rv,Ce.scales=iv,Ce.colors=Pa,Ce.brewer=sv;var ov=Ce;return ov})})(el);var qf=el.exports;export{qf as c,Rf as p};
