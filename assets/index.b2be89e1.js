var Se=Object.defineProperty,Te=Object.defineProperties;var _e=Object.getOwnPropertyDescriptors;var se=Object.getOwnPropertySymbols;var Ce=Object.prototype.hasOwnProperty,Oe=Object.prototype.propertyIsEnumerable;var jt=(a,r,e)=>r in a?Se(a,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[r]=e,ie=(a,r)=>{for(var e in r||(r={}))Ce.call(r,e)&&jt(a,e,r[e]);if(se)for(var e of se(r))Oe.call(r,e)&&jt(a,e,r[e]);return a},he=(a,r)=>Te(a,_e(r));var K=(a,r,e)=>(jt(a,typeof r!="symbol"?r+"":r,e),e);import{c as At,l as C,r as H,R as w,B as wt,T as ke,P as Ie,a as Fe,b as Le,d as le,e as Jt,f as Ve,D as ge,g as de,h as fe,i as ce,j as ue,k as Ut,G as te,S as He,U as Ge,m as Ne,n as Je,o as Ue,p as ze}from"./vendor.630eea4b.js";const Ye=function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const t of n)if(t.type==="childList")for(const m of t.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&o(m)}).observe(document,{childList:!0,subtree:!0});function e(n){const t={};return n.integrity&&(t.integrity=n.integrity),n.referrerpolicy&&(t.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?t.credentials="include":n.crossorigin==="anonymous"?t.credentials="omit":t.credentials="same-origin",t}function o(n){if(n.ep)return;n.ep=!0;const t=e(n);fetch(n.href,t)}};Ye();const tt={WHITE:"#EBE8E7",WHITISH:"#E2E0D8",WHITER:"#FFFEFD",BLACK:"#393538",HUES:["#68BAC8","#E35362","#E5CC5C"]},qe=tt.HUES.map(a=>{let r=At(a).rgb(!1),e=At(tt.WHITE).rgb(!1);return At.rgb(Math.min(r[0]/e[0],1)*255,Math.min(r[1]/e[1],1)*255,Math.min(r[2]/e[2],1)*255).hex()});function ee(a){var r=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;a=a.replace(r,function(o,n,t,m){return n+n+t+t+m+m});var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null}function pe(a){var r=ee(a).r,e=ee(a).g,o=ee(a).b,n=["244 67 54","255 235 238","255 205 210","239 154 154","229 115 115","239 83 80","229 57 53","211 47 47","198 40 40","183 28 28","255 138 128","255 82 82","255 23 68","213 0 0","233 30 99","252 228 236","248 187 208","244 143 177","240 98 146","236 64 122","216 27 96","194 24 91","173 20 87","136 14 79","255 128 171","255 64 129","245 0 87","197 17 98","156 39 176","243 229 245","225 190 231","206 147 216","186 104 200","171 71 188","142 36 170","123 31 162","106 27 154","74 20 140","234 128 252","224 64 251","213 0 249","170 0 255","103 58 183","237 231 246","209 196 233","179 157 219","149 117 205","126 87 194","94 53 177","81 45 168","69 39 160","49 27 146","179 136 255","124 77 255","101 31 255","98 0 234","63 81 181","232 234 246","197 202 233","159 168 218","121 134 203","92 107 192","57 73 171","48 63 159","40 53 147","26 35 126","140 158 255","83 109 254","61 90 254","48 79 254","33 150 243","227 242 253","187 222 251","144 202 249","100 181 246","66 165 245","30 136 229","25 118 210","21 101 192","13 71 161","130 177 255","68 138 255","41 121 255","41 98 255","3 169 244","225 245 254","179 229 252","129 212 250","79 195 247","41 182 246","3 155 229","2 136 209","2 119 189","1 87 155","128 216 255","64 196 255","0 176 255","0 145 234","0 188 212","224 247 250","178 235 242","128 222 234","77 208 225","38 198 218","0 172 193","0 151 167","0 131 143","0 96 100","132 255 255","24 255 255","0 229 255","0 184 212","0 150 136","224 242 241","178 223 219","128 203 196","77 182 172","38 166 154","0 137 123","0 121 107","0 105 92","0 77 64","167 255 235","100 255 218","29 233 182","0 191 165","76 175 80","232 245 233","200 230 201","165 214 167","129 199 132","102 187 106","67 160 71","56 142 60","46 125 50","27 94 32","185 246 202","105 240 174","0 230 118","0 200 83","139 195 74","241 248 233","220 237 200","197 225 165","174 213 129","156 204 101","124 179 66","104 159 56","85 139 47","51 105 30","204 255 144","178 255 89","118 255 3","100 221 23","205 220 57","249 251 231","240 244 195","230 238 156","220 231 117","212 225 87","192 202 51","175 180 43","158 157 36","130 119 23","244 255 129","238 255 65","198 255 0","174 234 0","255 235 59","255 253 231","255 249 196","255 245 157","255 241 118","255 238 88","253 216 53","251 192 45","249 168 37","245 127 23","255 255 141","255 255 0","255 234 0","255 214 0","255 193 7","255 248 225","255 236 179","255 224 130","255 213 79","255 202 40","255 179 0","255 160 0","255 143 0","255 111 0","255 229 127","255 215 64","255 196 0","255 171 0","255 152 0","255 243 224","255 224 178","255 204 128","255 183 77","255 167 38","251 140 0","245 124 0","239 108 0","230 81 0","255 209 128","255 171 64","255 145 0","255 109 0","255 87 34","251 233 231","255 204 188","255 171 145","255 138 101","255 112 67","244 81 30","230 74 25","216 67 21","191 54 12","255 158 128","255 110 64","255 61 0","221 44 0","121 85 72","239 235 233","215 204 200","188 170 164","161 136 127","141 110 99","109 76 65","93 64 55","78 52 46","62 39 35","158 158 158","250 250 250","245 245 245","238 238 238","224 224 224","189 189 189","117 117 117","97 97 97","66 66 66","33 33 33","96 125 139","236 239 241","207 216 220","176 190 197","144 164 174","120 144 156","84 110 122","69 90 100","55 71 79","38 50 56","0 0 0","255 255 255"],t=["#f44336","#ffebee","#ffcdd2","#ef9a9a","#e57373","#ef5350","#e53935","#d32f2f","#c62828","#b71c1c","#ff8a80","#ff5252","#ff1744","#d50000","#e91e63","#fce4ec","#f8bbd0","#f48fb1","#f06292","#ec407a","#d81b60","#c2185b","#ad1457","#880e4f","#ff80ab","#ff4081","#f50057","#c51162","#9c27b0","#f3e5f5","#e1bee7","#ce93d8","#ba68c8","#ab47bc","#8e24aa","#7b1fa2","#6a1b9a","#4a148c","#ea80fc","#e040fb","#d500f9","#aa00ff","#673ab7","#ede7f6","#d1c4e9","#b39ddb","#9575cd","#7e57c2","#5e35b1","#512da8","#4527a0","#311b92","#b388ff","#7c4dff","#651fff","#6200ea","#3f51b5","#e8eaf6","#c5cae9","#9fa8da","#7986cb","#5c6bc0","#3949ab","#303f9f","#283593","#1a237e","#8c9eff","#536dfe","#3d5afe","#304ffe","#2196f3","#e3f2fd","#bbdefb","#90caf9","#64b5f6","#42a5f5","#1e88e5","#1976d2","#1565c0","#0d47a1","#82b1ff","#448aff","#2979ff","#2962ff","#03a9f4","#e1f5fe","#b3e5fc","#81d4fa","#4fc3f7","#29b6f6","#039be5","#0288d1","#0277bd","#01579b","#80d8ff","#40c4ff","#00b0ff","#0091ea","#00bcd4","#e0f7fa","#b2ebf2","#80deea","#4dd0e1","#26c6da","#00acc1","#0097a7","#00838f","#006064","#84ffff","#18ffff","#00e5ff","#00b8d4","#009688","#e0f2f1","#b2dfdb","#80cbc4","#4db6ac","#26a69a","#00897b","#00796b","#00695c","#004d40","#a7ffeb","#64ffda","#1de9b6","#00bfa5","#4caf50","#e8f5e9","#c8e6c9","#a5d6a7","#81c784","#66bb6a","#43a047","#388e3c","#2e7d32","#1b5e20","#b9f6ca","#69f0ae","#00e676","#00c853","#8bc34a","#f1f8e9","#dcedc8","#c5e1a5","#aed581","#9ccc65","#7cb342","#689f38","#558b2f","#33691e","#ccff90","#b2ff59","#76ff03","#64dd17","#cddc39","#f9fbe7","#f0f4c3","#e6ee9c","#dce775","#d4e157","#c0ca33","#afb42b","#9e9d24","#827717","#f4ff81","#eeff41","#c6ff00","#aeea00","#ffeb3b","#fffde7","#fff9c4","#fff59d","#fff176","#ffee58","#fdd835","#fbc02d","#f9a825","#f57f17","#ffff8d","#ffff00","#ffea00","#ffd600","#ffc107","#fff8e1","#ffecb3","#ffe082","#ffd54f","#ffca28","#ffb300","#ffa000","#ff8f00","#ff6f00","#ffe57f","#ffd740","#ffc400","#ffab00","#ff9800","#fff3e0","#ffe0b2","#ffcc80","#ffb74d","#ffa726","#fb8c00","#f57c00","#ef6c00","#e65100","#ffd180","#ffab40","#ff9100","#ff6d00","#ff5722","#fbe9e7","#ffccbc","#ffab91","#ff8a65","#ff7043","#f4511e","#e64a19","#d84315","#bf360c","#ff9e80","#ff6e40","#ff3d00","#dd2c00","#795548","#efebe9","#d7ccc8","#bcaaa4","#a1887f","#8d6e63","#6d4c41","#5d4037","#4e342e","#3e2723","#9e9e9e","#fafafa","#f5f5f5","#eeeeee","#e0e0e0","#bdbdbd","#757575","#616161","#424242","#212121","#607d8b","#eceff1","#cfd8dc","#b0bec5","#90a4ae","#78909c","#546e7a","#455a64","#37474f","#263238","#000000","#ffffff"],m=["rgb(244,67,54)","rgb(255,235,238)","rgb(255,205,210)","rgb(239,154,154)","rgb(229,115,115)","rgb(239,83,80)","rgb(229,57,53)","rgb(211,47,47)","rgb(198,40,40)","rgb(183,28,28)","rgb(255,138,128)","rgb(255,82,82)","rgb(255,23,68)","rgb(213,0,0)","rgb(233,30,99)","rgb(252,228,236)","rgb(248,187,208)","rgb(244,143,177)","rgb(240,98,146)","rgb(236,64,122)","rgb(216,27,96)","rgb(194,24,91)","rgb(173,20,87)","rgb(136,14,79)","rgb(255,128,171)","rgb(255,64,129)","rgb(245,0,87)","rgb(197,17,98)","rgb(156,39,176)","rgb(243,229,245)","rgb(225,190,231)","rgb(206,147,216)","rgb(186,104,200)","rgb(171,71,188)","rgb(142,36,170)","rgb(123,31,162)","rgb(106,27,154)","rgb(74,20,140)","rgb(234,128,252)","rgb(224,64,251)","rgb(213,0,249)","rgb(170,0,255)","rgb(103,58,183)","rgb(237,231,246)","rgb(209,196,233)","rgb(179,157,219)","rgb(149,117,205)","rgb(126,87,194)","rgb(94,53,177)","rgb(81,45,168)","rgb(69,39,160)","rgb(49,27,146)","rgb(179,136,255)","rgb(124,77,255)","rgb(101,31,255)","rgb(98,0,234)","rgb(63,81,181)","rgb(232,234,246)","rgb(197,202,233)","rgb(159,168,218)","rgb(121,134,203)","rgb(92,107,192)","rgb(57,73,171)","rgb(48,63,159)","rgb(40,53,147)","rgb(26,35,126)","rgb(140,158,255)","rgb(83,109,254)","rgb(61,90,254)","rgb(48,79,254)","rgb(33,150,243)","rgb(227,242,253)","rgb(187,222,251)","rgb(144,202,249)","rgb(100,181,246)","rgb(66,165,245)","rgb(30,136,229)","rgb(25,118,210)","rgb(21,101,192)","rgb(13,71,161)","rgb(130,177,255)","rgb(68,138,255)","rgb(41,121,255)","rgb(41,98,255)","rgb(3,169,244)","rgb(225,245,254)","rgb(179,229,252)","rgb(129,212,250)","rgb(79,195,247)","rgb(41,182,246)","rgb(3,155,229)","rgb(2,136,209)","rgb(2,119,189)","rgb(1,87,155)","rgb(128,216,255)","rgb(64,196,255)","rgb(0,176,255)","rgb(0,145,234)","rgb(0,188,212)","rgb(224,247,250)","rgb(178,235,242)","rgb(128,222,234)","rgb(77,208,225)","rgb(38,198,218)","rgb(0,172,193)","rgb(0,151,167)","rgb(0,131,143)","rgb(0,96,100)","rgb(132,255,255)","rgb(24,255,255)","rgb(0,229,255)","rgb(0,184,212)","rgb(0,150,136)","rgb(224,242,241)","rgb(178,223,219)","rgb(128,203,196)","rgb(77,182,172)","rgb(38,166,154)","rgb(0,137,123)","rgb(0,121,107)","rgb(0,105,92)","rgb(0,77,64)","rgb(167,255,235)","rgb(100,255,218)","rgb(29,233,182)","rgb(0,191,165)","rgb(76,175,80)","rgb(232,245,233)","rgb(200,230,201)","rgb(165,214,167)","rgb(129,199,132)","rgb(102,187,106)","rgb(67,160,71)","rgb(56,142,60)","rgb(46,125,50)","rgb(27,94,32)","rgb(185,246,202)","rgb(105,240,174)","rgb(0,230,118)","rgb(0,200,83)","rgb(139,195,74)","rgb(241,248,233)","rgb(220,237,200)","rgb(197,225,165)","rgb(174,213,129)","rgb(156,204,101)","rgb(124,179,66)","rgb(104,159,56)","rgb(85,139,47)","rgb(51,105,30)","rgb(204,255,144)","rgb(178,255,89)","rgb(118,255,3)","rgb(100,221,23)","rgb(205,220,57)","rgb(249,251,231)","rgb(240,244,195)","rgb(230,238,156)","rgb(220,231,117)","rgb(212,225,87)","rgb(192,202,51)","rgb(175,180,43)","rgb(158,157,36)","rgb(130,119,23)","rgb(244,255,129)","rgb(238,255,65)","rgb(198,255,0)","rgb(174,234,0)","rgb(255,235,59)","rgb(255,253,231)","rgb(255,249,196)","rgb(255,245,157)","rgb(255,241,118)","rgb(255,238,88)","rgb(253,216,53)","rgb(251,192,45)","rgb(249,168,37)","rgb(245,127,23)","rgb(255,255,141)","rgb(255,255,0)","rgb(255,234,0)","rgb(255,214,0)","rgb(255,193,7)","rgb(255,248,225)","rgb(255,236,179)","rgb(255,224,130)","rgb(255,213,79)","rgb(255,202,40)","rgb(255,179,0)","rgb(255,160,0)","rgb(255,143,0)","rgb(255,111,0)","rgb(255,229,127)","rgb(255,215,64)","rgb(255,196,0)","rgb(255,171,0)","rgb(255,152,0)","rgb(255,243,224)","rgb(255,224,178)","rgb(255,204,128)","rgb(255,183,77)","rgb(255,167,38)","rgb(251,140,0)","rgb(245,124,0)","rgb(239,108,0)","rgb(230,81,0)","rgb(255,209,128)","rgb(255,171,64)","rgb(255,145,0)","rgb(255,109,0)","rgb(255,87,34)","rgb(251,233,231)","rgb(255,204,188)","rgb(255,171,145)","rgb(255,138,101)","rgb(255,112,67)","rgb(244,81,30)","rgb(230,74,25)","rgb(216,67,21)","rgb(191,54,12)","rgb(255,158,128)","rgb(255,110,64)","rgb(255,61,0)","rgb(221,44,0)","rgb(121,85,72)","rgb(239,235,233)","rgb(215,204,200)","rgb(188,170,164)","rgb(161,136,127)","rgb(141,110,99)","rgb(109,76,65)","rgb(93,64,55)","rgb(78,52,46)","rgb(62,39,35)","rgb(158,158,158)","rgb(250,250,250)","rgb(245,245,245)","rgb(238,238,238)","rgb(224,224,224)","rgb(189,189,189)","rgb(117,117,117)","rgb(97,97,97)","rgb(66,66,66)","rgb(33,33,33)","rgb(96,125,139)","rgb(236,239,241)","rgb(207,216,220)","rgb(176,190,197)","rgb(144,164,174)","rgb(120,144,156)","rgb(84,110,122)","rgb(69,90,100)","rgb(55,71,79)","rgb(38,50,56)","rgb(0,0,0)","rgb(255,255,255)"],f=[],l="#F44336,#E91E63,#673AB7,#3F51B5,#FFEB3B,#FF5722".toLowerCase().split(",");for(let P=0;P<n.length;P++){var i=/^(.*)\s(.*)\s(.*)$/.exec(n[P]),h=Number(i[1]),g=Number(i[2]),u=Number(i[3]);f[P]=Math.abs(h-r)+Math.abs(g-e)+Math.abs(u-o),l.indexOf(t[P].toLowerCase())<0&&(f[P]=255*3)}let c=Math.min.apply(Math,f),M=f.indexOf(c),p=t[M],E=m[M];return p.replace("#",""),(p+"ff").replace("#",""),E.replace("rgb(","").replace(")",""),(E.replace("rgb(","rgba(").replace(")","")+",1)").replace("rgba(","").replace(")",""),t[M]}function Ke(a){return parseInt(pe((a||0).toString(16).padStart(6,"0")).substring(1),16)}function be(a){return(Math.floor(a.r)*256+Math.floor(a.g))*256+Math.floor(a.b)}function ct(a){return{r:Math.floor(a/256/256)%256,g:Math.floor(a/256)%256,b:Math.floor(a)%256}}class st{constructor(r,e,o){K(this,"bodyParts",8);K(this,"maxWheels",4);K(this,"wheelProb",.5);K(this,"maxLength",10);K(this,"maxRadius",5);K(this,"minRadius",1);K(this,"minAngleWeight",.32);K(this,"maxAngleWeight",6.4);K(this,"score",0);K(this,"data",{lengths:[],angleWeights:[],wheels:[],colors:[]});K(this,"importCar",function(r){var e=new st;try{var o=r;r.split(",").length<3?o=De(r):o=r.split(",");for(var n={lengths:[],angleWeights:[],wheels:[],colors:[]},t=0;t<8;t++)n.lengths.push(this.maxLength*parseFloat(o[t*2+1])/3),n.angleWeights.push(parseFloat(o[t*2]));for(var m=parseInt(o[o.length-1]),t=0;t<m;t++)n.wheels.push({index:parseInt(o[16+t*3]),r:this.maxRadius*parseFloat(o[16+t*3+2])/1.5,o:parseInt(o[16+t*3])>-1,axelAngle:parseFloat(o[16+t*3+1])});for(var t=0;t<16;t++)n.colors.push(parseInt(o[40+t]));e=new st(n)}catch(f){return console.log("E",f),e}return e.materialize(),e});this.maxWheels;var n=this.wheelProb;if(o&&(n=o),r)this.data=r;else{this.data={lengths:[],angleWeights:[],wheels:[],colors:[]};for(var t=0;t<this.bodyParts;t++)this.data.lengths.push(this.maxLength*(Math.random()/4*3+.25)),this.data.angleWeights.push(.5+Math.random());for(var t=0;t<this.bodyParts*2;t++)this.data.colors.push((Math.floor(Math.random()*256)*256+Math.floor(Math.random()*256))*256+Math.floor(Math.random()*256));for(var t=0;t<2;t++)this.data.wheels.push({index:Math.floor(Math.random()*this.bodyParts),r:(this.maxRadius-this.minRadius)*Math.random()+this.minRadius,o:!0,axelAngle:t/this.bodyParts*Math.PI*2});for(var t=0;t<this.wheelMax-2;t++)this.data.wheels.push({index:Math.floor(Math.random()*this.bodyParts),r:(this.maxRadius-this.minRadius)*Math.random()+this.minRadius,o:Math.random()<n,axelAngle:t/this.bodyParts*Math.PI*2})}this.materialize()}fixAngleWeights(){for(var r=0,e=0;e<this.bodyParts;e++)r+=this.data.angleWeights[e];for(var e=0;e<this.bodyParts;e++)this.data.angleWeights[e]=Math.min(Math.max(this.data.angleWeights[e]/r*this.bodyParts,this.minAngleWeight),this.maxAngleWeight)}materialize(){for(var r=0;r<this.data.colors.length;r++)this.data.colors[r]=Ke(this.data.colors[r])}totalAngleWeights(){for(var r=0,e=0;e<this.bodyParts;e++)r+=this.data.angleWeights[e];return r}compareWheels(r,e){return 0}wheelsAt(r){for(var e=[],o=0;o<this.data.wheels.length;o++)this.data.wheels[o].index==r&&e.push(this.data.wheels[o]);return e.sort(this.compareWheels),e}sectionSimiliarity(r,e,o){return this.data.lengths[e]/this.maxLength,this.data.angleWeights[e]/this.totalAngleWeights(),this.wheelsAt(e),r.data.lengths[o]/r.maxLength,r.data.angleWeights[o]/r.totalAngleWeights(),r.wheelsAt(o),0}bestMap(r){for(var e=0;e<this.bodyParts;e++);}getAreaOfPiece(r){r=(r%this.bodyParts+this.bodyParts)%this.bodyParts;for(var e=0,o=0;o<this.bodyParts;o++)e+=this.data.angleWeights[o];var n=Math.PI*2*this.data.angleWeights[(r+1)%this.bodyParts]/e,t=Math.sin(n)*this.data.lengths[r]*this.data.lengths[(r+1)%this.bodyParts]/2;return t}exportCar(){for(var r=[],e=0,o=0,n=0;n<this.bodyParts;n++)o+=this.data.angleWeights[n];for(var n=0;n<this.bodyParts;n++)r.push(this.data.angleWeights[n]),r.push(this.data.lengths[n]/this.maxLength*3),e+=Math.PI*2*this.data.angleWeights[n]/o;for(var t=0,n=0;n<this.data.wheels.length;n++)this.data.wheels[n].o&&(r.push(this.data.wheels[n].index),r.push(this.data.wheels[n].axelAngle),r.push(this.data.wheels[n].r/this.maxRadius*1.5),t++);for(var n=0;n<this.bodyParts-t;n++)r.push("NaN"),r.push(.1),r.push(.1);for(var n=0;n<this.bodyParts*2;n++)r.push(this.data.colors[n]);r.push(t);for(var n=0;n<r.length;n++);return r.join(",")}breed(r,e,o){var n=Math.max(1,this.score)/(Math.max(1,this.score)+Math.max(1,r.score));n=Math.sign(n-.5)*.6+.5;var t=.9;this.maxWheels;var m=this.wheelProb,m=this.wheelProb;o&&(m=o);var f=.001,l=.025;this.fixAngleWeights(),r.fixAngleWeights(),this.data.wheels.sort(this.compareWheels),r.data.wheels.sort(this.compareWheels);var i=new st;i.score=this.score*n+r.score*(1-n);for(var h=0;h<this.bodyParts;h++)if(Math.random()>l){var g=(Math.random()-.5)/10+.5;g=.5+(g-.5)*(1-t)+(n-.5)*t,i.data.lengths[h]=Math.min(Math.max((this.data.lengths[h]*g+r.data.lengths[h]*(1-g))*(1-f)+f*Math.random()*this.maxLength,0),this.maxLength),i.data.angleWeights[h]=Math.max((this.data.angleWeights[h]/this.totalAngleWeights()*g+r.data.angleWeights[h]/r.totalAngleWeights()*(1-g))*(1-f)+f*(Math.random()*(this.maxAngleWeight-this.minAngleWeight)+this.minAngleWeight),0)}for(var h=0;h<this.bodyParts*2;h++)if(Math.random()>l){var g=(Math.random()-.5)/10+.5;g=.5+(g-.5)*(1-t)+(n-.5)*t;var u=ct(this.data.colors[h]),c=ct(r.data.colors[h]),M=ct(0);M.r=Math.min(Math.max((u.r*g+c.r*(1-g))*(1-f)+f*Math.random()*256,0),255),M.g=Math.min(Math.max((u.g*g+c.g*(1-g))*(1-f)+f*Math.random()*256,0),255),M.b=Math.min(Math.max((u.b*g+c.b*(1-g))*(1-f)+f*Math.random()*256,0),255),i.data.colors[h]=be(M)}i.data.wheels=[];for(var h=0;h<Math.min(Math.max(this.data.wheels.length,r.data.wheels.length),this.maxWheels);h++){var p=h<this.data.wheels.length,E=h<r.data.wheels.length,b=p?this.data.wheels[h]:r.data.wheels[h],A=p&&E?r.data.wheels[h]:b,g=(Math.random()-.5)/10+.5;g=.5+(g-.5)*(1-t)+(n-.5)*t,b.o&&b.r,A.o&&A.r;var P=Math.min(Math.max((b.r*g+A.r*(1-g))*(1-f)+f*Math.random()*this.maxRadius,this.minRadius),this.maxRadius),g=(Math.random()-.5)/10+.5;g=.5+(g-.5)*(1-t)+(n-.5)*t;var x=((b.o?1:0)*g+(A.o?1:0)*(1-g))*(1-f)+f*Math.random()>.5,k={x:Math.cos(b.index*Math.PI*2/this.bodyParts),y:Math.sin(b.index*Math.PI*2/this.bodyParts)},I={x:Math.cos(A.index*Math.PI*2/this.bodyParts),y:Math.sin(A.index*Math.PI*2/this.bodyParts)},g=(Math.random()-.5)/10+.5;g=.5+(g-.5)*(1-t)+(n-.5)*t;var T={x:k.x*g+I.x*(1-g),y:k.y*g+I.y*(1-g)},S=Math.floor(Math.atan2(T.y,T.x)/Math.PI/2*this.bodyParts+.05),W=Math.floor(Math.random()*this.bodyParts),k={x:Math.cos(W*Math.PI*2/this.bodyParts),y:Math.sin(W*Math.PI*2/this.bodyParts)},I={x:Math.cos(S*Math.PI*2/this.bodyParts),y:Math.sin(S*Math.PI*2/this.bodyParts)};g=f,T={x:k.x*g+I.x*(1-g),y:k.y*g+I.y*(1-g)},S=(Math.floor(Math.atan2(T.y,T.x)/Math.PI/2*this.bodyParts+.05)%this.bodyParts+this.bodyParts)%this.bodyParts,Math.random()<l&&(S=Math.floor(Math.random()*this.bodyParts)),P<=this.minRadius&&(x=!1),Math.random()<l&&(x=Math.random()>.1,P=(this.maxRadius-this.minRadius)*Math.random()+this.minRadius);var et={index:S,r:P,o:x,axelAngle:S/this.bodyParts*Math.PI*2};i.data.wheels.push(et)}var z=e-i.data.wheels.length;if(z>0)for(var B=0;B<z;B++){var U=Math.floor(Math.random()*this.bodyParts);i.data.wheels.push({index:U+0,r:(this.maxRadius-this.minRadius)*Math.random()+this.minRadius,o:Math.random()<m,axelAngle:U/this.bodyParts*Math.PI*2})}if(z<0)for(var B=0;B<-z;B++)i.data.wheels.splice(Math.floor(Math.random()*i.data.wheels.length),1);for(var it=0,h=0;h<i.data.wheels.length;h++)i.data.wheels[h].o&&it++;var ht=i.data.wheels.length*m-it;if(ht>0)for(var B=0;B<ht;B++){var rt=Math.floor(Math.random()*i.data.wheels.length);i.data.wheels[rt].o=Math.random()<.5||i.data.wheels[rt].o}if(Math.random()<l)if(i.data.wheels.length<this.maxWheels&&Math.random()<.5){var U=Math.floor(Math.random()*this.bodyParts);i.data.wheels.push({index:U,r:(this.maxRadius-this.minRadius)*Math.random()+this.minRadius,o:Math.random()<.1,axelAngle:U/this.bodyParts*Math.PI*2})}else i.data.wheels.splice(Math.floor(Math.random()*i.data.wheels.length),1);return i.materialize(),i.fixAngleWeights(),i}breed2(r,e,o){var n=Math.max(1,this.score)/(Math.max(1,this.score)+Math.max(1,r.score)),t=2;this.maxWheels;var m=this.wheelProb,m=this.wheelProb;o&&(m=o);var f=.05;this.fixAngleWeights(),r.fixAngleWeights(),this.data.wheels.sort(this.compareWheels),r.data.wheels.sort(this.compareWheels);var l=new st;l.score=this.score*n+r.score*(1-n);for(var i=0;i<this.bodyParts;i++)if(Math.random()>f){var h=(Math.random()-.5)/10+.5;h=.5+(h-.5)*(1-t)+(n-.5)*t;var g=g>Math.random()?1:0;l.data.lengths[i]=Math.min(Math.max((this.data.lengths[i]*h+r.data.lengths[i]*(1-h))*(1-g)+g*Math.random()*this.maxLength,0),this.maxLength);var g=g>Math.random()?1:0;l.data.angleWeights[i]=Math.max((this.data.angleWeights[i]/this.totalAngleWeights()*h+r.data.angleWeights[i]/r.totalAngleWeights()*(1-h))*(1-g)+g*Math.random()*1/this.bodyParts,0)}for(var i=0;i<this.bodyParts*2;i++)if(Math.random()>f){var h=(Math.random()-.5)/10+.5;h=.5+(h-.5)*(1-t)+(n-.5)*t;var u=ct(this.data.colors[i]),c=ct(r.data.colors[i]),M=ct(0),g=g>Math.random()?1:0;M.r=Math.min(Math.max((u.r*h+c.r*(1-h))*(1-g)+g*Math.random()*256,0),255);var g=g>Math.random()?1:0;M.g=Math.min(Math.max((u.g*h+c.g*(1-h))*(1-g)+g*Math.random()*256,0),255);var g=g>Math.random()?1:0;M.b=Math.min(Math.max((u.b*h+c.b*(1-h))*(1-g)+g*Math.random()*256,0),255),l.data.colors[i]=be(M)}l.data.wheels=[];for(var i=0;i<Math.min(Math.max(this.data.wheels.length,r.data.wheels.length),this.maxWheels);i++){var p=i<this.data.wheels.length,E=i<r.data.wheels.length,b=p?this.data.wheels[i]:r.data.wheels[i],A=p&&E?r.data.wheels[i]:b,h=(Math.random()-.5)/10+.5;h=.5+(h-.5)*(1-t)+(n-.5)*t,b.o&&b.r,A.o&&A.r;var g=g>Math.random()?1:0,P=Math.min(Math.max((b.r*h+A.r*(1-h))*(1-g)+g*Math.random()*this.maxRadius,this.minRadius),this.maxRadius),h=(Math.random()-.5)/10+.5;h=.5+(h-.5)*(1-t)+(n-.5)*t;var g=g>Math.random()?1:0,x=((b.o?1:0)*h+(A.o?1:0)*(1-h))*(1-g)+g*Math.random()>.5,k={x:Math.cos(b.index*Math.PI*2/this.bodyParts),y:Math.sin(b.index*Math.PI*2/this.bodyParts)},I={x:Math.cos(A.index*Math.PI*2/this.bodyParts),y:Math.sin(A.index*Math.PI*2/this.bodyParts)},h=(Math.random()-.5)/10+.5;h=.5+(h-.5)*(1-t)+(n-.5)*t;var T={x:k.x*h+I.x*(1-h),y:k.y*h+I.y*(1-h)},S=Math.floor(Math.atan2(T.y,T.x)/Math.PI/2*this.bodyParts),W=Math.floor(Math.random()*this.bodyParts),k={x:Math.cos(W*Math.PI*2/this.bodyParts),y:Math.sin(W*Math.PI*2/this.bodyParts)},I={x:Math.cos(S*Math.PI*2/this.bodyParts),y:Math.sin(S*Math.PI*2/this.bodyParts)};h=g,T={x:k.x*h+I.x*(1-h),y:k.y*h+I.y*(1-h)};var g=g>Math.random()?1:0;S=(Math.floor(Math.atan2(T.y,T.x)/Math.PI/2*this.bodyParts)+this.bodyParts+this.bodyParts)%this.bodyParts,Math.random()<f&&(S=Math.floor(Math.random()*this.bodyParts)),P<=this.minRadius&&(x=!1),Math.random()<f&&(x=Math.random()>.1,P=(this.maxRadius-this.minRadius)*Math.random()+this.minRadius);var et={index:S,r:P,o:x,axelAngle:S/this.bodyParts*Math.PI*2};l.data.wheels.push(et)}var z=e-l.data.wheels.length;if(z>0)for(var B=0;B<z;B++){var U=Math.floor(Math.random()*this.bodyParts);l.data.wheels.push({index:U+0,r:(this.maxRadius-this.minRadius)*Math.random()+this.minRadius,o:Math.random()<m,axelAngle:U/this.bodyParts*Math.PI*2})}if(z<0)for(var B=0;B<-z;B++)l.data.wheels.splice(Math.floor(Math.random()*l.data.wheels.length),1);for(var it=0,i=0;i<l.data.wheels.length;i++)l.data.wheels[i].o&&it++;var ht=l.data.wheels.length*m-it;if(ht>0)for(var B=0;B<ht;B++){var rt=Math.floor(Math.random()*l.data.wheels.length);l.data.wheels[rt].o=Math.random()<.5||l.data.wheels[rt].o}if(Math.random()<f)if(l.data.wheels.length<this.maxWheels&&Math.random()<.5){var U=Math.floor(Math.random()*this.bodyParts);l.data.wheels.push({index:U,r:(this.maxRadius-this.minRadius)*Math.random()+this.minRadius,o:Math.random()<.1,axelAngle:U/this.bodyParts*Math.PI*2})}else l.data.wheels.splice(Math.floor(Math.random()*l.data.wheels.length),1);return l.materialize(),l.fixAngleWeights(),l}clone(){this.data.wheels.sort(this.compareWheels);for(var r=new st,e=0;e<this.bodyParts;e++)r.data.lengths[e]=this.data.lengths[e]+0,r.data.angleWeights[e]=this.data.angleWeights[e]+0;r.data.wheels=[];for(var e=0;e<this.data.wheels.length;e++){var o=this.data.wheels[e],n={index:o.index+0,r:o.r+0,o:o.o&&!0,axelAngle:o.axelAngle+0};r.data.wheels.push(n)}return r.materialize(),r}}function De(a){for(var r=Re(a),e=new JXG.Util.Unzip(JXG.Util.Base64.decodeAsArray(a)).unzip()[0][0],o=[],n=0;n<16;n++)o.push(r.getFloat64(n*8));for(var n=0;n<8;n++){var t=r.getInt32(n*8*2.5+128);Math.abs(t)<10||(t=NaN),o.push(t),o.push(r.getFloat64(n*8*2.5+16*8+.5*8)),Math.abs(o[o.length-1])<Math.pow(2,-100)&&(o[o.length-1]=0),o.push(r.getFloat64(n*8*2.5+16*8+1.5*8)),Math.abs(o[o.length-1])<Math.pow(2,-100)&&(o[o.length-1]=0)}for(var m=(r.getUint8(44*8+3)%8+7)%8+1,n=0;n<16;n++){var f=n*4+288;f<e.length-1&&o.push(r.getUint32(f))}return o.push(m),o}function Re(a){for(var r=new JXG.Util.Unzip(JXG.Util.Base64.decodeAsArray(a)).unzip()[0][0],e=new ArrayBuffer(r.length),o=new DataView(e),n=0;n<r.length;n++)o.setUint8(n,r.charCodeAt(n),!1);return o}class X{constructor(r,e,o){K(this,"x");K(this,"y");K(this,"z");this.x=r,this.y=e,this.z=o}dot2(r,e){return this.x*r+this.y*e}dot3(r,e,o){return this.x*r+this.y*e+this.z*o}}var $e=[new X(1,1,0),new X(-1,1,0),new X(1,-1,0),new X(-1,-1,0),new X(1,0,1),new X(-1,0,1),new X(1,0,-1),new X(-1,0,-1),new X(0,1,1),new X(0,-1,1),new X(0,1,-1),new X(0,-1,-1)],me=[151,160,137,91,90,15,131,13,201,95,96,53,194,233,7,225,140,36,103,30,69,142,8,99,37,240,21,10,23,190,6,148,247,120,234,75,0,26,197,62,94,252,219,203,117,35,11,32,57,177,33,88,237,149,56,87,174,20,125,136,171,168,68,175,74,165,71,134,139,48,27,166,77,146,158,231,83,111,229,122,60,211,133,230,220,105,92,41,55,46,245,40,244,102,143,54,65,25,63,161,1,216,80,73,209,76,132,187,208,89,18,169,200,196,135,130,116,188,159,86,164,100,109,198,173,186,3,64,52,217,226,250,124,123,5,202,38,147,118,126,255,82,85,212,207,206,59,227,47,16,58,17,182,189,28,42,223,183,170,213,119,248,152,2,44,154,163,70,221,153,101,155,167,43,172,9,129,22,39,253,19,98,108,110,79,113,224,232,178,185,112,104,218,246,97,228,251,34,242,193,238,210,144,12,191,179,162,241,81,51,145,235,249,14,239,107,49,192,214,31,181,199,106,157,184,84,204,176,115,121,50,45,127,4,150,254,138,236,205,93,222,114,67,29,24,72,243,141,128,195,78,66,215,61,156,180],O=new Array(512),N=new Array(512);const ye=function(a){a>0&&a<1&&(a*=65536),a=Math.floor(a),a<256&&(a|=a<<8);for(var r=0;r<256;r++){var e;r&1?e=me[r]^a&255:e=me[r]^a>>8&255,O[r]=O[r+256]=e,N[r]=N[r+256]=$e[e%12]}};ye(0);var Xe=.5*(Math.sqrt(3)-1),Ot=(3-Math.sqrt(3))/6,Ze=1/3,nt=1/6;const Qe=function(a,r){var e,o,n,t=(a+r)*Xe,m=Math.floor(a+t),f=Math.floor(r+t),l=(m+f)*Ot,i=a-m+l,h=r-f+l,g,u;i>h?(g=1,u=0):(g=0,u=1);var c=i-g+Ot,M=h-u+Ot,p=i-1+2*Ot,E=h-1+2*Ot;m&=255,f&=255;var b=N[m+O[f]],A=N[m+g+O[f+u]],P=N[m+1+O[f+1]],x=.5-i*i-h*h;x<0?e=0:(x*=x,e=x*x*b.dot2(i,h));var T=.5-c*c-M*M;T<0?o=0:(T*=T,o=T*T*A.dot2(c,M));var S=.5-p*p-E*E;return S<0?n=0:(S*=S,n=S*S*P.dot2(p,E)),70*(e+o+n)},je=function(a,r,e){var o,n,t,m,f=(a+r+e)*Ze,l=Math.floor(a+f),i=Math.floor(r+f),h=Math.floor(e+f),g=(l+i+h)*nt,u=a-l+g,c=r-i+g,M=e-h+g,p,E,b,A,P,x;u>=c?c>=M?(p=1,E=0,b=0,A=1,P=1,x=0):u>=M?(p=1,E=0,b=0,A=1,P=0,x=1):(p=0,E=0,b=1,A=1,P=0,x=1):c<M?(p=0,E=0,b=1,A=0,P=1,x=1):u<M?(p=0,E=1,b=0,A=0,P=1,x=1):(p=0,E=1,b=0,A=1,P=1,x=0);var T=u-p+nt,S=c-E+nt,W=M-b+nt,k=u-A+2*nt,I=c-P+2*nt,et=M-x+2*nt,z=u-1+3*nt,B=c-1+3*nt,U=M-1+3*nt;l&=255,i&=255,h&=255;var it=N[l+O[i+O[h]]],ht=N[l+p+O[i+E+O[h+b]]],rt=N[l+A+O[i+P+O[h+x]]],It=N[l+1+O[i+1+O[h+1]]],bt=.6-u*u-c*c-M*M;bt<0?o=0:(bt*=bt,o=bt*bt*it.dot3(u,c,M));var lt=.6-T*T-S*S-W*W;lt<0?n=0:(lt*=lt,n=lt*lt*ht.dot3(T,S,W));var Z=.6-k*k-I*I-et*et;Z<0?t=0:(Z*=Z,t=Z*Z*rt.dot3(k,I,et));var R=.6-z*z-B*B-U*U;return R<0?m=0:(R*=R,m=R*R*It.dot3(z,B,U)),32*(o+n+t+m)};function kt(a){return a*a*a*(a*(a*6-15)+10)}function ot(a,r,e){return(1-e)*a+e*r}const tr=function(a,r){var e=Math.floor(a),o=Math.floor(r);a=a-e,r=r-o,e=e&255,o=o&255;var n=N[e+O[o]].dot2(a,r),t=N[e+O[o+1]].dot2(a,r-1),m=N[e+1+O[o]].dot2(a-1,r),f=N[e+1+O[o+1]].dot2(a-1,r-1),l=kt(a);return ot(ot(n,m,l),ot(t,f,l),kt(r))},er=function(a,r,e){var o=Math.floor(a),n=Math.floor(r),t=Math.floor(e);a=a-o,r=r-n,e=e-t,o=o&255,n=n&255,t=t&255;var m=N[o+O[n+O[t]]].dot3(a,r,e),f=N[o+O[n+O[t+1]]].dot3(a,r,e-1),l=N[o+O[n+1+O[t]]].dot3(a,r-1,e),i=N[o+O[n+1+O[t+1]]].dot3(a,r-1,e-1),h=N[o+1+O[n+O[t]]].dot3(a-1,r,e),g=N[o+1+O[n+O[t+1]]].dot3(a-1,r,e-1),u=N[o+1+O[n+1+O[t]]].dot3(a-1,r-1,e),c=N[o+1+O[n+1+O[t+1]]].dot3(a-1,r-1,e-1),M=kt(a),p=kt(r),E=kt(e);return ot(ot(ot(m,h,M),ot(f,g,M),E),ot(ot(l,u,M),ot(i,c,M),E),p)},Wt={seed:ye,simplex2:Qe,simplex3:je,perlin2:tr,perlin3:er};var G=25,ft=(a=>(a[a.Sisyphus=0]="Sisyphus",a[a.Hills=1]="Hills",a[a.Crescendo=2]="Crescendo",a[a.Rocky=3]="Rocky",a))(ft||{});function rr(a){return a<G?0:Wt.perlin2((a-G)/20,0)*10+Wt.perlin2((a-G)/10,(a-G)/10)*10-Math.pow(Math.max(a-G,0)/10,1.2)/4*10}function ar(a){return a<G?0:Wt.perlin2((a-G)/15,0)*(12-2/((a-G+10)/7))+Wt.perlin2((a-G)/7,(a-G)/7)}function nr(a){if(a<G)return 0;var r=250-25;return r-Math.sqrt(1-Math.pow(Math.max(a-G,0)/r,2))*r?(r-Math.sqrt(1-Math.pow(Math.max(a-G,0)/r,2))*r)*1.75:Wt.perlin2((a-G)/15,0)*(12-2/((a-G+10)/7))+Wt.perlin2((a-G)/7,(a-G)/7)}function or(a){if(a<G)return 0;var r=1;return a<G+100&&(r=Math.max(a-G,0)/100),-Math.sin(Math.max(a-G,0)/20+Math.pow(Math.max(a-G,0)/20,1.75)/20)*10*r}const re=2,Yt=4,sr=65535,ir=65535^re^Yt,xe=65535^Yt^re,Et={};Et.filterCategoryBits=Yt;Et.filterMaskBits=xe;Et.density=.5;Et.friction=10;Et.restitution=.1;const ut={};ut.filterCategoryBits=re;ut.filterMaskBits=sr;ut.density=2;ut.friction=10;ut.restitution=.05;const hr=he(ie({},ut),{density:-ut.density}),xt={};xt.filterCategoryBits=Yt;xt.filterMaskBits=xe;xt.density=15;xt.friction=10;xt.restitution=.05;const qt={};qt.filterMaskBits=ir;qt.density=2;qt.restitution=.05;const lr={density:0,friction:2},gr=10,dr=1.5;var ve=6*Math.PI;const fr=(a,{terrainXSRef:r,cameraRef:e,world:o,ground:n,carScoreRef:t,restartCurrentRef:m,distTicksRef:f,currentTicksRef:l,boxCarRef:i,scaleRef:h,genXRef:g,terrain:u,setLeaderboard:c,setScore:M,restartTicksRef:p,handleImportCarRef:E,GRAVITY:b})=>{let A=1;function P(s){t.current<s-3&&(m.current=0,t.current=s+0,i.current.score=s+0,f.current=l.current+0)}var x=[];r.current=[];function T(){for(;n.m_fixtureList;)n.destroyFixture(n.m_fixtureList);r.current=[],x=[]}function S(){for(;g.current<e.current.x+Math.max(a.width/h.current/2,100);){var s=.5,d=g.current,y=g.current+(u===ft.Hills||u===ft.Sisyphus?2:7);g.current=y;var v=u===ft.Hills?or:u===ft.Sisyphus?nr:u===ft.Crescendo?rr:ar,_=C.Vec2(d,v(d)),L=C.Vec2(y,v(y)),Y=Math.atan2(L.y-_.y,L.x-_.x);let at=C.Vec2(L.y-_.y,_.x-L.x);at.normalize();var q=C.Box(Math.sqrt(Math.pow(L.x-_.x,2)+Math.pow(L.y-_.y,2))/2,s,C.Vec2(_.x/2+L.x/2,_.y/2+L.y/2).add(at.mul(s/2)),Y),F=n.createFixture(q,lr);x.push(F),r.current.push(L),F.render={special:"ground",fill:tt.BLACK,stroke:tt.BLACK,layer:0}}}S();var W=[],k=[],I=[],et=6,z=16,B=new st;function U(){for(var s=[],d=0;d<W.length;d++)s.push(W[W.length-d-1].car);for(var d=0;d<k.length;d++)s.push(k[k.length-d-1].car);for(var d=0;d<I.length;d++)s.push(I[I.length-d-1].car);var y=2;return s[Math.floor(Math.pow(Math.random(),y)*s.length)].breed(s[Math.floor(Math.pow(Math.random(),y)*s.length)])}function it(){if(W.length<1)return 0;for(var s=W[0].score,d=0;d<W.length;d++)s=Math.min(s,W[d].score);return s}function ht(s,d,y){W.push({score:d,ticks:y,car:s}),W.sort(function(v,_){return v.score-_.score}),W.length>et&&W.splice(0,W.length-et)}function rt(){W.sort(function(s,d){return d.score-s.score}),c(W),W.length>0&&document.querySelectorAll("#score-best")[0].setAttribute("value",W[0].car.exportCar())}function It(s){t.current=Math.max(i.current.getPosition().x,t.current);var d=t.current+0,y=f.current+0;s?(W=[],k=[],I=[],B=new st,Ht(B)):(d>0&&(I.push({score:d,ticks:f.current,car:B.clone()}),ht(B.clone(),d,y)),I.length>=z&&(I.sort(function(v,_){return v.score-_.score}),I.splice(0,I.length-4),k=I,I=[]),k.length===0?(W.length>0?B=U():B=new st,Ht(B)):(B=U(),Ht(B))),rt()}function bt(s){t.current+0,W=[],k=[],I=[],B=new st().importCar(s),Ht(B)}E.current=bt;var lt,Z,R=C.Vec2(0,10);i.current=o.createDynamicBody({position:R.clone()});var ae=Et;ae.friction=1;var Kt=!1,Pt=[],J=[],Bt=[],Ft=[],mt=[],Lt=[],Q=[],vt=[],j=[],gt=[],Dt=[],$=[],St=[],Tt=[],Mt=[],pt=[],Rt=R.clone();function Pe(){for(var s=0;s<J.length;s++)o.destroyBody(J[s].m_body);for(var s=0;s<mt.length;s++)o.destroyBody(mt[s].m_body);for(var s=0;s<Q.length;s++)Q[s]&&o.destroyBody(Q[s]);for(var s=0;s<pt.length;s++)pt[s]&&o.destroyBody(pt[s]);for(var s=0;s<gt.length;s++)gt[s]&&o.destroyBody(gt[s]);for(var s=0;s<Mt.length;s++)Mt[s]&&o.destroyBody(Mt[s]);o.destroyBody(i.current),i.current=o.createBody({position:R.clone()}),Pt=[],J=[],Bt=[],Ft=[],mt=[],Lt=[],Q=[],vt=[],j=[],St=[],pt=[],gt=[],$=[],Tt=[],Mt=[],Rt=R.clone()}var V=1;let Vt=qe;function Ht(s){m.current=0,B=s,Pe(),i.current=o.createDynamicBody({position:R.clone()}),J=[],Bt=[],Ft=[],mt=[],Lt=[],Q=[],vt=[],j=[],St=[],pt=[],gt=[],$=[],Tt=[],Mt=[],Rt=R.clone();var d=R.y+0,y=Math.abs(s.data.angleWeights[0]/s.totalAngleWeights()*Math.PI*2%(Math.PI*2));(y+Math.PI)%(Math.PI*2)-Math.PI<0&&(y=Math.PI-1-((y+Math.PI)%(Math.PI*2)-Math.PI));for(var v=0;v<s.bodyParts;v++){Ft.push(s.getAreaOfPiece(v));var _=y+s.data.angleWeights[(v+1)%s.data.angleWeights.length]/s.totalAngleWeights()*Math.PI*2,L=C.Polygon([C.Vec2(0,0),C.Vec2(Math.cos(y+0)*s.data.lengths[v]*V,Math.sin(y+0)*s.data.lengths[v]*V),C.Vec2(Math.cos(_+0)*s.data.lengths[(v+1)%s.data.lengths.length]*V,Math.sin(_+0)*s.data.lengths[(v+1)%s.data.lengths.length]*V)]),Y=ut;(((_-y+0)/Math.PI*180+360)%360+360)%360>180&&(Y=hr,console.log("neg"));var q=i.current.createFixture(L,Y);d=Math.min(d,q.getAABB(0).lowerBound.y),ct(parseInt(pe((s.data.colors[v]||0).toString(16).padStart(6,"0")).substring(1),16));let Be=s.data.colors[v]||0;var F=Vt[Be%Vt.length];q.render={fill:F,stroke:F,layer:6},J.push(q),Bt.push(v),Lt.push(L);for(var at=s.wheelsAt(v),Gt=[],yt=[],_t=0;_t<at.length;_t++){var D=at[_t];if(D.o){ct(s.data.colors[(s.data.wheels.indexOf(D)+8)%s.data.colors.length]);var Nt=C.Vec2(Math.cos(y)*s.data.lengths[v]*V,Math.sin(y)*s.data.lengths[v]*V).add(Rt).sub(C.Vec2(Math.cos(D.axelAngle)*s.maxRadius*V/3,Math.sin(D.axelAngle)*s.maxRadius*V/3)),$t=C.Vec2(Math.cos(D.axelAngle)*.2*V*s.maxRadius/3,Math.sin(D.axelAngle)*.2*V*s.maxRadius/3).add(Nt),Xt=o.createDynamicBody($t),Zt=Xt.createFixture(C.Box(.2*V*s.maxRadius/1.5,.05*V*s.maxRadius/1.5,C.Vec2(0,0),D.axelAngle),xt),Ee=q.getBody().createFixture(C.Box(.2*V*s.maxRadius/1.5,.1*V*s.maxRadius/1.5,C.Vec2(Math.cos(y)*s.data.lengths[v]*V,Math.sin(y)*s.data.lengths[v]*V),D.axelAngle),xt),Ct=o.createDynamicBody(Nt),Qt=Ct.createFixture(C.Circle(D.r*V*.89),ae);Qt.render={fill:tt.BLACK,layer:7};let dt=s.data.colors[(s.data.wheels.indexOf(D)+8)%s.data.colors.length]||0;var F=Vt[dt%Vt.length];Ee.render={fill:F,stroke:F,layer:9},Zt.render={fill:F,stroke:F,layer:8};var ne=o.createJoint(C.PrismaticJoint({enableMotor:!0,lowerTranslation:-s.maxRadius*V/3,upperTranslation:s.maxRadius*V/3*.075,enableLimit:!0},q.getBody(),Xt,Ct.getWorldCenter(),C.Vec2(-Math.cos(D.axelAngle)/1,-Math.sin(D.axelAngle)/1))),oe=o.createJoint(C.RevoluteJoint({motorSpeed:-ve,maxMotorTorque:42/2,enableMotor:!0},Zt.getBody(),Ct,Ct.getWorldCenter()));j.push(oe),Gt.push(oe),Q.push(Ct),vt.push(Qt),$.push(ne),yt.push(ne),gt.push(Xt),Dt.push(Zt),d=Math.min(d,Qt.getAABB(0).lowerBound.y),q.getBody().resetMassData()}}St.push([Gt]),Tt.push([yt]),y=_}d=d-.5,i.current.resetMassData(),i.current.setPosition(C.Vec2(i.current.getPosition().x,i.current.getPosition().y-d));for(var v=0;v<Dt.length;v++){let dt=Dt[v].m_body;dt.setPosition(C.Vec2(dt.getPosition().x,dt.getPosition().y-d))}for(var v=0;v<vt.length;v++){let dt=vt[v].m_body;dt.setPosition(C.Vec2(dt.getPosition().x,dt.getPosition().y-d))}t.current=0,e.current.x=0,m.current=0,f.current=0,l.current=0,g.current=-200,T(),S(),rt()}It(!0),o.on("post-solve",function(s,d){for(var y=s;y;){for(var v=0;v<J.length;v++){var _=J[v],L=50*J[v].m_body.m_mass/2;if(y.getFixtureA()==_&&mt.indexOf(y.getFixtureB())<0&&vt.indexOf(y.getFixtureB())<0||y.getFixtureB()==_&&mt.indexOf(y.getFixtureA())<0&&vt.indexOf(y.getFixtureA())<0){for(var Y=!1,q=0;q<y.v_points.length;q++)y.v_points[q].normalImpulse>L&&(Y=!0);Y&&Pt.push(_)}}y=y.m_next}});function we(s){if(J.indexOf(s)>=0){J.indexOf(s);var d=Lt.splice(J.indexOf(s),1)[0];Ft.splice(J.indexOf(s),1)[0];var y=Bt.splice(J.indexOf(s),1)[0],v=St.splice(J.indexOf(s),1)[0],_=Tt.splice(J.indexOf(s),1)[0];J.splice(J.indexOf(s),1);var L=i.current.m_fixtureList;if(!(L==null?void 0:L.m_shape)||!(L==null?void 0:L.getBody()))return;J.indexOf(L);var Y=L.getBody(),q=Y.getWorldCenter();if(v[1])for(var F=0;F<v[1].length;F++)Mt.push(gt.splice(gt.indexOf(_[1][F].m_bodyB),1)[0]),pt.push(Q.splice(Q.indexOf(v[1][F].m_bodyB),1)[0]),o.destroyJoint(v[1][F]),o.destroyJoint(_[1][F]);var at=Bt.indexOf((y+B.bodyParts-1)%B.bodyParts);if(at>=0&&doubleWheelParent){St[at][1]=v[0],Tt[at][1]=_[0];for(var F=0;F<_[0].length;F++)_[0][F].m_bodyA=J[at].m_body}else for(var F=0;F<v[0].length;F++)pt.push(Q.splice(Q.indexOf(v[0][F].m_bodyB),1)[0]),o.destroyJoint(v[0][F]),Mt.push(Q.splice(gt.indexOf(_[0][F].m_bodyB),1)[0]),o.destroyJoint(_[0][F]);var Gt=s.render;i.current.destroyFixture(s),s=null;var yt=o.createBody({type:"dynamic",position:Y.getPosition(),angle:Y.getAngle()});s=yt.createFixture(d,qt),s.render=Gt,s.render.layer=2,mt.push(s);var _t=Y.getWorldCenter(),D=yt.getWorldCenter(),Nt=C.Vec2.add(lt,C.Vec2.cross(Z,C.Vec2.sub(_t,q))),$t=C.Vec2.add(lt,C.Vec2.cross(Z,C.Vec2.sub(D,q)));Y.setAngularVelocity(Z),Y.setLinearVelocity(Nt),yt.setAngularVelocity(Z),yt.setLinearVelocity($t),i.current.resetMassData()}}function Ae(){S();var s=i.current.m_mass;try{for(var d=0;d<j.length;d++)j[d].m_bodyB&&j[d].m_bodyB.m_mass&&(s+=j[d].m_bodyB.m_mass),$[d].m_bodyB&&(s+=$[d].m_bodyB.m_mass)}catch{}s=s/V/V;for(var y=dr*b/j.length*s,v=7.5*s/6,d=0;d<j.length;d++)j[d].m_bodyB&&j[d].setMaxMotorTorque(y*2),$[d].setMotorSpeed(ve),$[d].enableMotor(!0),$[d].m_bodyB&&($[d].setMaxMotorForce(v+40/40*v*Math.pow(5*$[d].getJointTranslation()/V/(B.maxRadius*V/3),2)),$[d].setMotorSpeed(-20/20*5*$[d].getJointTranslation()/V/(B.maxRadius*V/3)));m.current++,l.current++;var _=i.current.getPosition();if(e.current.x=_.x,e.current.y=-_.y,P(_.x),(m.current>=p.current||J.length<3)&&It(),Pt.length>0){for(var L=0;L<Pt.length;L++)we(Pt[L]);Pt=[]}lt=i.current.getLinearVelocity(),Z=i.current.getAngularVelocity()}function We(){for(var s=0;s<A;s++){let y={af:!0,simSpeed:100};Kt!==y.af&&(A=10),Kt=y.af,Kt?t.current>it()?A=10:A=100:A=y.simSpeed,M(Math.max(i.current.getPosition().x,t.current)),o.step(1/75);var d=new Date().getTime();Ae(),new Date().getTime()-d}}return()=>{We()}},zt=()=>{var a;return(a=window.devicePixelRatio)!=null?a:1},cr=(a,{cameraRef:r,scaleRef:e,world:o,terrainXSRef:n})=>{var t=a.getContext("2d");a.width=window.innerWidth*zt(),a.height=window.innerHeight*zt();function m(l,i){t.lineCap="round",t.save(),new Path2D().arc(l.m_p.x*e.current,l.m_p.y*e.current,l.m_radius*e.current,0,2*Math.PI),t.beginPath(),t.shadowBlur=0,t.shadowColor="rgba(0,0,0,0)",t.shadowOffsetY=0,t.shadowOffsetX=0,t.strokeStyle=tt.BLACK,t.lineWidth=e.current/4,t.globalCompositeOperation,t.strokeStyle=tt.BLACK,t.fillStyle=tt.WHITER,t.arc(l.m_p.x*e.current,l.m_p.y*e.current,l.m_radius*e.current,0,2*Math.PI),t.beginPath(),t.arc(l.m_p.x*e.current,l.m_p.y*e.current,l.m_radius*e.current,0,2*Math.PI),t.stroke(),t.beginPath(),t.strokeStyle=tt.BLACK,t.lineWidth=e.current/4,t.moveTo(l.m_p.x*e.current,l.m_p.y*e.current),t.lineTo(l.m_p.x*e.current+l.m_radius*e.current,l.m_p.y*e.current),t.stroke(),t.globalCompositeOperation="orig",t.restore()}function f(l,i,h){var p,E;t.save();let g=new Path2D;g.moveTo(l.m_vertices[0].x*e.current,l.m_vertices[0].y*e.current);for(var u=1;u<l.m_vertices.length;u++)g.lineTo(l.m_vertices[u].x*e.current,l.m_vertices[u].y*e.current);t.lineJoin="round",t.lineCap="round",t.beginPath();let c=t.globalCompositeOperation;if(h){t.globalCompositeOperation="source-over",t.strokeStyle="#8B9B56",t.fillStyle=At("#8B9B56").brighten(1).hex(),t.moveTo(l.m_vertices[1].x*e.current,l.m_vertices[1].y*e.current),t.lineTo(l.m_vertices[2].x*e.current,l.m_vertices[2].y*e.current);let b=t.getTransform().transformPoint(new DOMPoint(l.m_vertices[1].x*e.current,l.m_vertices[1].y*e.current)),A=t.getTransform().transformPoint(new DOMPoint(l.m_vertices[2].x*e.current,l.m_vertices[2].y*e.current)),P=t.getTransform().inverse().transformPoint(new DOMPoint(A.x,a.height));t.lineTo(P.x,P.y);let x=t.getTransform().inverse().transformPoint(new DOMPoint(b.x,a.height));t.lineTo(x.x,x.y),t.save(),t.clip(),t.moveTo(l.m_vertices[1].x*e.current,l.m_vertices[1].y*e.current),t.lineTo(l.m_vertices[2].x*e.current,l.m_vertices[2].y*e.current),t.lineTo(P.x,P.y),t.lineTo(x.x,x.y),t.fill(),t.beginPath(),t.lineWidth=e.current/2,t.moveTo(l.m_vertices[1].x*e.current,l.m_vertices[1].y*e.current),t.lineTo(l.m_vertices[2].x*e.current,l.m_vertices[2].y*e.current),t.stroke(),t.restore()}else{t.moveTo(l.m_vertices[0].x*e.current,l.m_vertices[0].y*e.current);for(var u=1;u<l.m_vertices.length;u++)t.lineTo(l.m_vertices[u].x*e.current,l.m_vertices[u].y*e.current)}t.shadowBlur=0,t.shadowColor="rgba(0,0,0,0)",t.shadowOffsetY=0,t.shadowOffsetX=0,t.fillStyle=At((E=(p=i.render)==null?void 0:p.stroke)!=null?E:t.strokeStyle).brighten(2);let M=t.strokeStyle+"";if(t.strokeStyle=t.fillStyle,t.lineWidth=8,t.closePath(),!h){if(t.fill(),t.globalCompositeOperation="multiply",t.lineWidth=1e-4,t.stroke(),t.strokeStyle=M,l.m_vertices.length===3&&!1)for(var u;u<3;u++);else t.stroke();if(t.lineWidth=e.current/4,l.m_vertices.length===3&&!1)for(var u;u<3;u++);else t.stroke()}t.globalCompositeOperation=c,t.restore()}return()=>{var A;let l=Math.ceil(window.innerWidth*zt()),i=Math.ceil(window.innerHeight*zt());(a.width!==l||a.height!==i)&&(a.width=l,a.height=i),e.current=Math.min(a.width/40,a.height/40),t.setTransform(1,0,0,1,0,0),t.clearRect(0,0,a.width,a.height),t.fillStyle=tt.WHITE,t.fillRect(0,0,a.width,a.height),t.translate(-r.current.x*e.current,-r.current.y*e.current),t.globalAlpha=1,t.globalCompositeOperation="multiply",t.globalCompositeOperation="source-over",t.globalAlpha=1,t.translate(r.current.x*e.current,r.current.y*e.current),t.translate(a.width/2,a.height/2),t.scale(1,-1),t.translate(-r.current.x*e.current,r.current.y*e.current);var h=[];function g(P,x,T){for(var S=!1,W=0;W<h.length;W++)h[W].index==P&&(S=!0,h[W].pairs.push({f:x,b:T}));S||h.push({index:P,pairs:[{f:x,b:T}]})}for(var u=o.getBodyList();u;u=u.getNext())for(var c=u.getFixtureList();c;c=c.getNext()){var M=0;c.render&&c.render.layer&&(M=c.render.layer),g(M,c,u)}h.sort(function(P,x){return P.index-x.index});let p=n.current;if(p.length>=2){t.beginPath();let P=t.getTransform().transformPoint(new DOMPoint(p[0].x*e.current,p[0].y*e.current)),x=t.getTransform().transformPoint(new DOMPoint(p[p.length-1].x*e.current,p[p.length-1].y*e.current)),T=t.getTransform().inverse().transformPoint(new DOMPoint(x.x,a.height)),S=t.getTransform().inverse().transformPoint(new DOMPoint(P.x,a.height));t.moveTo(S.x,S.y);for(let W=0;W<p.length;W++){let k=p[W];t.lineTo(k.x*e.current,k.y*e.current)}t.lineTo(T.x,T.y),t.globalCompositeOperation="source-over",t.strokeStyle="#8B9B56",t.fillStyle=At("#8B9B56").brighten(1).hex(),t.lineWidth=e.current*(.5-.5*.5),t.fill(),t.stroke()}for(var E=0;E<h.length;E++)for(var b=0;b<h[E].pairs.length;b++){var c=h[E].pairs[b].f,u=h[E].pairs[b].b;if(t.strokeStyle=c.render&&c.render.stroke?c.render.stroke:"#000000",t.fillStyle=c.render&&c.render.fill?c.render.fill:"rgba(0,0,0,0)",t.lineWidth=1,t.save(),t.globalCompositeOperation="multiply",t.translate(c.m_body.m_xf.p.x*e.current,c.m_body.m_xf.p.y*e.current),t.rotate(Math.atan2(c.m_body.m_xf.q.s,c.m_body.m_xf.q.c)),c.m_shape.getType()=="polygon"){let T=((A=c.render)==null?void 0:A.special)==="ground";T||f(c.m_shape,c,T)}c.m_shape.getType()=="circle"&&m(c.m_shape),t.restore(),t.globalCompositeOperation="source-over",t.globalAlpha=1}}},ur=({setScore:a,setLeaderboard:r,handleImportCarRef:e,terrain:o})=>{const[n,t]=H.exports.useState(null),m=H.exports.useRef(C.Vec2(0,0)),[f,l]=H.exports.useState(gr),i=H.exports.useMemo(()=>C.World({gravity:C.Vec2(0,-f)}),[f]),h=H.exports.useRef([]),g=H.exports.useMemo(()=>i.createBody(),[i]),u=H.exports.useRef(-200),c=H.exports.useRef(Math.min(window.innerWidth/40,window.innerHeight/40)),M=H.exports.useRef(null),p=H.exports.useRef(0),E=H.exports.useRef(0),b=H.exports.useRef(400),A=H.exports.useRef(0),P=H.exports.useRef(0);return H.exports.useEffect(()=>{if(n){const x={cameraRef:m,world:i,ground:g,setScore:a,setLeaderboard:r,terrain:o,genXRef:u,GRAVITY:f,currentTicksRef:p,distTicksRef:E,restartTicksRef:b,restartCurrentRef:A,carScoreRef:P,boxCarRef:M,scaleRef:c,terrainXSRef:h,handleImportCarRef:e};console.log("REGO");const T=setInterval(fr(n,x),1e3/75),S=setInterval(cr(n,x),1e3/75);return()=>{clearInterval(S),clearInterval(T)}}},[n]),w.createElement("canvas",{ref:x=>t(x)})};function Me(a,r=100){let e;return(...o)=>{e||(a.apply(this,o),e=setTimeout(()=>{e=void 0},r))}}const br=()=>{const[a,r]=H.exports.useState(0),[e,o]=H.exports.useState([]),n=H.exports.useRef(b=>{}),[t,m]=H.exports.useState([ft.Rocky,ft.Hills,ft.Sisyphus][Math.floor(Math.random()*3)]),[f,l]=H.exports.useState(!1),[i,h]=H.exports.useState(""),[g,u]=H.exports.useState(""),[c,M]=H.exports.useState(!1),p=()=>{M(!1)},E=()=>{l(!1)};return w.createElement(wt,null,w.createElement(ur,{handleImportCarRef:n,setScore:Me(b=>r(b)),setLeaderboard:Me(b=>o(b)),terrain:t}),w.createElement(wt,{sx:{top:0,position:"absolute",padding:1}},w.createElement(ke,{component:Ie,elevation:0,sx:{bgcolor:tt.WHITISH}},w.createElement(Fe,{sx:{minWidth:104},"aria-label":"simple table"},w.createElement(Le,null,w.createElement(le,null,w.createElement(Jt,{align:"right"},"Score"),w.createElement(Jt,{align:"right"},"Time"))),w.createElement(Ve,null,e.map((b,A)=>w.createElement(le,{key:b.score+"_"+b.ticks,sx:{"&:last-child td, &:last-child th":{border:0}}},w.createElement(Jt,{align:"right"},b.score.toFixed(2)),w.createElement(Jt,{align:"right"},(b.ticks/75).toFixed(2)))))))),w.createElement(wt,{sx:{bottom:0,position:"absolute",width:1,padding:1,boxSizing:"border-box"}},w.createElement(ge,{onClose:E,open:f},w.createElement(de,null,"Import Car"),w.createElement(fe,null,w.createElement(ce,{label:"Car Data",variant:"outlined",value:i,onChange:b=>h(b.target.value)})),w.createElement(ue,null,w.createElement(Ut,{onClick:()=>{E(),n.current(i)}},"Import"))),w.createElement(ge,{onClose:p,open:c},w.createElement(de,null,"Export Car"),w.createElement(fe,null,w.createElement(ce,{label:"Copyable Car Data",variant:"outlined",value:g})),w.createElement(ue,null,w.createElement(Ut,{onClick:p},"Done"))),w.createElement(te,{container:!0,sx:{width:1},gap:1},w.createElement(te,{item:!0,container:!0,flex:"1",alignItems:"end"},w.createElement(wt,{sx:{typography:"h4",color:"primary"}},"Score: ",a.toFixed(2))),w.createElement(te,{item:!0,flex:"1"},w.createElement(He,{gap:1,alignItems:"end"},w.createElement(Ut,{disableElevation:!0,size:"large",onClick:()=>{l(!0),h("")},sx:{padding:0,":hover div":{paddingRight:3,transition:"padding-right 0.25s"}}},w.createElement(Ge,{sx:{fontSize:"48px",marginRight:1,marginLeft:1}}),w.createElement(wt,{component:"div",sx:{letterSpacing:"-0.05em",bgcolor:"warning.main",padding:1,color:"warning.contrastText",fontSize:"48px",lineHeight:1,transition:"padding-right 0.25s"}},"Import Car")),w.createElement(Ut,{disableElevation:!0,size:"large",onClick:()=>{if(e.length>0){let b=e[0].car;u(b.exportCar()),M(!0)}},sx:{padding:0,":hover div":{paddingRight:3,transition:"padding-right 0.25s"}}},w.createElement(Ne,{sx:{fontSize:"48px",marginRight:1,marginLeft:1}}),w.createElement(wt,{sx:{letterSpacing:"-0.05em",bgcolor:"error.main",padding:1,color:"error.contrastText",fontSize:"48px",lineHeight:1,transition:"padding-right 0.25s"}},"Export Best")))))))},mr=Je({palette:{primary:{main:"#312D32",contrastText:"#EAE8E5"},warning:{main:"#D6BC5C",contrastText:"#EAE8E5"},error:{main:"#DD424E",contrastText:"#EAE8E5"},divider:"#44372f"},typography:{button:{textTransform:"capitalize"}},shape:{borderRadius:0}});Ue.exports.render(w.createElement(ze,{theme:mr},w.createElement(br,null)),document.getElementById("root"));
